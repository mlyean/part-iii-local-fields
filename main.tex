\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{array}
\usepackage{chngcntr}
\usepackage{commath}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{stmaryrd}
\usepackage{thmtools}
\usepackage{tikz}
\usepackage{tikz-cd}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[subsection]
\newtheorem*{example}{Example}
\newtheorem*{warning}{Warning}

\theoremstyle{plain}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{corollary}[definition]{Corollary}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\renewcommand{\qedsymbol}{$\blacksquare$}

\DeclareMathOperator{\Frac}{\mathrm{Frac}}

\newcommand{\bF}{\mathbb{F}}
\newcommand{\bN}{\mathbb{N}}
\newcommand{\bZ}{\mathbb{Z}}
\newcommand{\bQ}{\mathbb{Q}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\bC}{\mathbb{C}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\fm}{\mathfrak{m}}

\renewcommand\thesection{\Roman{section}}
\counterwithout{subsection}{section}

\setlist[enumerate,1]{label=(\roman*), noitemsep}

\title{Local Fields}
\author{Ming Yean Lim}

\begin{document}

\maketitle

\section{Basic Theory}

\subsection{Absolute Value}

\let\svthefootnote\thefootnote
\let\thefootnote\relax\footnotetext{These lecture notes were based on the Part III course Local Fields taught during Michaelmas 2022 by Dr. Rong Zhou.}
\let\thefootnote\svthefootnote

\begin{definition}
    Let $K$ be a field. An \emph{absolute value} on $K$ is a function $\abs{\cdot} : K \to \bR_{\ge 0}$ such that
    \begin{enumerate}
        \item (Definiteness) $\forall x \in K,\, \abs{x} = 0 \iff x = 0$
        \item (Multiplicativity) $\forall x, y \in K,\, \abs{x y} = \abs{x} \abs{y}$
        \item (Triangle inequality) $\forall x, y \in K,\, \abs{x + y} \le \abs{x} + \abs{y}$
    \end{enumerate}
    $(K, \abs{\cdot})$ is said to be a \emph{valued field}.
\end{definition}

\begin{example}\phantom{}
    \begin{itemize}
        \item $K = \bQ, \bR, \bC$ with the usual absolute value, denoted $\abs{\cdot}_\infty$.
        \item Let $K$ be any field, then there is a \emph{trivial absolute value} given by
            \begin{equation*}
                \abs{x} =
                \begin{cases}
                    0 & \text{if } x = 0 \\
                    1 & \text{if } x \neq 0
                \end{cases}
            \end{equation*}
        \item The only absolute value on a finite field is trivial. This follows from the easy fact that for $n \ge 1$, $x^n = 1$ implies that $\abs{x} = 1$.
        \item Let $K = \bQ$, and let $p$ be a prime. The \emph{$p$-adic absolute value} is defined to be
            \begin{equation*}
                \abs{x}_p =
                \begin{cases}
                    0 & \text{if } x = 0 \\
                    p^{-n} & \text{if } x = p^n \frac{a}{b}\text{, where } p \nmid a, b.
                \end{cases}
            \end{equation*}
            In fact, $\abs{\cdot}_p$ satisfies the stronger inequality $\abs{x + y}_p \le \max\{\abs{x}_p, \abs{y}_p\}$.
    \end{itemize}
\end{example}

\noindent An absolute value $\abs{\cdot}$ on $K$ induces a metric $d(x, y) = \abs{x - y}$, which in turn induces a topology on $K$.

\begin{definition}
    Let $\abs{\cdot}, \abs{\cdot}'$ be absolute values on $K$. We say $\abs{\cdot}$ and $\abs{\cdot}'$ are \emph{equivalent} if they define the same topology.
\end{definition}

\begin{proposition}\label{prop:1_3}
    Let $\abs{\cdot}, \abs{\cdot}'$ be non-trivial absolute values on $K$. The following are equivalent:
    \begin{enumerate}
        \item $\abs{\cdot}$ and $\abs{\cdot}'$ are \emph{equivalent}
        \item $\forall x \in K, \abs{x} < 1 \iff \abs{x}' < 1$
        \item $\exists c \in \bR_{> 0}, \forall x \in K, \abs{x}' = \abs{x}^c$
    \end{enumerate}
\end{proposition}
\begin{proof}
    (i) $\Rightarrow$ (ii):
    \begin{align*}
        \abs{x} < 1
        &\iff x^n \rightarrow 0 \text{ wrt } \abs{\cdot}\\
        &\iff x^n \rightarrow 0 \text{ wrt } \abs{\cdot}'\\
        &\iff \abs{x}' < 1
    \end{align*}

    \noindent(ii) $\Rightarrow$ (iii): Let $a \in K^\times$ be such that $\abs{a} < 1$ (which exists since $\abs{\cdot}$ is non-trivial). It suffices to show that $\forall x \in K^\times$,
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} = \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Fix $x \in K^\times$ and suppose that the equality does not hold. WLOG we may assume that
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} < \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Pick a rational number $m/n$ (with $n > 0$) such that
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} < \frac{m}{n} < \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Then
    \begin{align*}
        n \log{\abs{x}} &> m \log{\abs{a}} \\
        n \log{\abs{x}'} &< m \log{\abs{a}'}
    \end{align*}
    By exponentiating, we find that
    \begin{equation*}
        \abs{\frac{x^n}{a^m}}' < 1 < \abs{\frac{x^n}{a^m}}
    \end{equation*}
    contradiction.

    \noindent (iii) $\Rightarrow$ (i): (iii) implies that the topologies have the same open balls.
\end{proof}

\begin{definition}
    An absolute value $\abs{\cdot}$ on $K$ is \emph{non-archimedean} if it satisfies the \emph{ultrametric inequality}
    \begin{equation*}
        \abs{x + y} \le \max\{\abs{x}, \abs{y}\} \qquad \forall x, y \in K
    \end{equation*}
    $\abs{\cdot}$ is \emph{archimedean} if it is not non-archimedean.
\end{definition}

\begin{example}
    $\abs{\cdot}_\infty$ is archimedean, while $\abs{\cdot}_p$ on $\bQ$ is non-archimedean.
\end{example}

\begin{lemma}[All triangles are isoceles]\label{lem:1_5}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $x, y \in K$. If $\abs{x} < \abs{y}$, then $\abs{x - y} = \abs{y}$.
\end{lemma}
\begin{proof}
    \begin{align*}
        \abs{x - y}
        &\le \max\{\abs{x}, \abs{y}\}\\
        &= \abs{y}\\
        &= \abs{x + (y - x)}\\
        &\le \max\{\abs{x}, \abs{x - y}\} \\
        &= \abs{x - y} \qquad(\text{since } \abs{y} \not\le \abs{x}) \qedhere
    \end{align*}
\end{proof}

\begin{proposition}\label{prop:1_6}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $(x_n)_{n=1}^\infty$ be a sequence in $K$. If $\abs{x_n - x_{n+1}} \to 0$, then $(x_n)_{n=1}^\infty$ is Cauchy.

    In particular, if in addition $K$ is complete, then $(x_n)$ converges.
\end{proposition}
\begin{proof}
    Fix $\varepsilon > 0$. Choose $N$ such that $\forall n \ge N, \abs{x_n - x_{n+1}} < \varepsilon$. Then for $m \ge n \ge N$, we have
    \begin{align*}
        \abs{x_n - x_m}
        &= \abs{(x_n - x_{n+1}) + \ldots + (x_{m-1} - x_m)}\\
        &\le \max\{\abs{x_n - x_{n+1}}, \ldots, \abs{x_{m-1} - x_m} \}\\
        &< \varepsilon \qedhere
    \end{align*}
\end{proof}

\begin{example}
    We construct a sequence $(x_n)$ in $\bZ$ such that
    \begin{enumerate}
        \item $x_n^2 + 1 \equiv 0 \pmod{5^n}$
        \item $x_{n + 1} \equiv x_n \pmod{5^n}$
    \end{enumerate}

    Set $x_1 = 2$. Suppose we have constructed the sequence up to $x_n$, where $n \ge 1$. We have $x_n^2 + 1 = 5^n a$. It suffices to find $b$ such that $x_{n+1} = x_n + 5^n b$. We have
    \begin{align*}
        x_{n+1}^2 + 1
        &= x_n^2 + 2 \cdot 5^n b x_n + 5^{2n} b^2 + 1\\
        &= 5^n a + 2 \cdot 5^n b x_n + 5^{2n} b^2\\
        &\equiv 5^n (a + 2 b x_n) \pmod{5^{n+1}}
    \end{align*}
    Thus we just take any $b$ with $a + 2b x_n \equiv 0 \pmod{5}$.

    Now (ii) says that $\abs{x_n - x_{n+1}}_5 \le 5^{-n}$, so by \autoref{prop:1_6}, $(x_n)$ is Cauchy in $(\bQ, \abs{\cdot}_5)$. Suppose that $x_n$ converges to $\ell \in \bQ$. Then $x_n^2 \rightarrow \ell^2 \in \bQ$. However (i) implies that $x_n^2 \rightarrow -1$, so that $\ell^2 = -1$. This shows that $(\bQ, \abs{\cdot}_5)$ is not complete.
\end{example}

\begin{definition}
    The \emph{$p$-adic numbers} $\bQ_p$ is the completion of $\bQ$ with respect to $\abs{\cdot}_p$.
\end{definition}

\begin{remark}
    $\bR$ is the completion of $\bQ$ with respect to $\abs{\cdot}_\infty$.
\end{remark}

\noindent Let $(K, \abs{\cdot})$ be a valued field. For $x \in K$ and $r \in \bR_{> 0}$, define
\begin{align*}
    B(x, r) &= \{y \in K \mid \abs{x - y} < r\}\\
    \overline{B}(x, r) &= \{y \in K \mid \abs{x - y} \le r\}
\end{align*}

\begin{lemma}\label{lem:1_8}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field.
    \begin{enumerate}
        \item (Open balls don't have centres) If $z \in B(x, r)$, then $B(z, r) = B(x, r)$
        \item (Closed balls don't have centres) If $z \in \overline{B}(x, r)$, then $\overline{B}(z, r) = \overline{B}(x, r)$
        \item (Open balls are closed) $B(x, r)$ is closed.
        \item (Closed balls are open) $\overline{B}(x, r)$ is open.
    \end{enumerate}
\end{lemma}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Let $y \in B(x, r)$. Then
            \begin{equation*}
                \abs{z - y} \le \max\{\abs{z-x}, \abs{x-y}\} < r
            \end{equation*}
            so $y \in B(z, r)$. The other inclusion follows by symmetry.
        \item Same as (i) with $<$ replaced with $\le$.
        \item Let $y \in B(x, r)^c$. We show that $y \in B(y, r) \subseteq B(x, r)^c$. Suppose there is a $z \in B(x, r) \cap B(y, r)$. Then $B(x, r) = B(z, r) = B(y, r)$ by (i), so $y \in B(x, r)$, contradiction.
        \item Let $z \in \overline{B}(x, r)$. Then $z \in B(z, r) \subseteq \overline{B}(z, r) = \overline{B}(x, r)$ by (ii). \qedhere
    \end{enumerate}
\end{proof}

\subsection{Valuation Rings}

\begin{definition}
    Let $K$ be a field. A valuation on $K$ is a function $v : K^\times \to \bR$ such that
    \begin{enumerate}
        \item $v(xy) = v(x) + v(y)$
        \item $v(x + y) \ge \min\{v(x), v(y)\}$
    \end{enumerate}
\end{definition}

\noindent Fix $0 < \alpha < 1$. If $v$ is a valuation on $K$, then
\begin{equation*}
    \abs{x} =
    \begin{cases}
        \alpha^{v(x)} & \text{if } x \neq 0\\
        0 & \text{if } x = 0
    \end{cases}
\end{equation*}
determines a non-archimedean absolute value on $K$.

Conversely a non-archimedean absolute value determines a valuation by taking $v(x) = \log_\alpha \abs{x}$.

\begin{remark}
    We ignore the trivial valuation $v(x) = 0 \quad \forall x \in K^\times$.
\end{remark}
\begin{remark}
    We say that $v_1, v_2$ are \emph{equivalent} if $\exists c \in \bR_{> 0}, \forall x \in K^\times, v_1(x) = c v_2(x)$.
\end{remark}

\begin{example}\phantom{}
    \begin{itemize}
        \item For $K = \bQ$, $v_p(x) = -\log_p \abs{x}_p$ is the $p$-adic valuation.
        \item Let $k$ be a field and let $K = k(t)$ be the rational function field. Define $v(t^n \frac{f(t)}{g(t)}) = n$, where $f, g \in k[t]$ are such that $f(0), g(0) \neq 0$. This gives the \emph{$t$-adic valuation}.
        \item Let $k$ be a field and let $K = k \llbracket t \rrbracket$ be the field of formal Laurent series. Define $v(\sum a_i t^i) = \min \{i \mid a_i \neq 0\}$. This is also called the $t$-adic valuation.
    \end{itemize}
\end{example}

\begin{definition}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field. The \emph{valuation ring} of $K$ is defined to be
    \begin{equation*}
        \cO_K = \{x \in K \mid \abs{x} \le 1\} = \overline{B}(0, 1)
    \end{equation*}
\end{definition}
\noindent Note that we also have $\cO_K = \{0\} \cup \{x \in K^\times \mid v(x) \ge 0\}$.

\begin{proposition}\label{prop:2_3}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field.
    \begin{enumerate}
        \item $\cO_K$ is an open subring of $K$.
        \item The subsets $\{x \in K \mid \abs{x} \le r\}$ and $\{x \in K \mid \abs{x} < r\}$ for $r \le 1$ are open ideals of $\cO_K$.
        \item $\cO_K^\times = \{x \in K \mid \abs{x} = 1\}$
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Openness follows from \autoref{lem:1_8}.

            \noindent We have $\abs{0} = 0$ and $\abs{1} = 1$, so $0, 1 \in \cO_K$.

            \noindent If $x \in \cO_K$, then $\abs{-x} = \abs{-1}\abs{x} = \abs{x} \le 1$, so $-x \in \cO_K$.

            \noindent If $x, y \in \cO_K$, then $\abs{x + y} \le \max \{\abs{x}, \abs{y}\} \le 1$. Also $\abs{x y} = \abs{x} \abs{y} \le 1$, so $x + y, x y \in \cO_K$.

        \item Similar to (i).

        \item $\abs{x} \abs{x^{-1}} = 1$ and $\abs{x}, \abs{x^{-1}} \le 1$ together imply that $\abs{x} = \abs{x^{-1}} = 1$. \qedhere
    \end{enumerate}
\end{proof}

\noindent The above proposition shows that $\cO_K$ is a local ring with maximal ideal $\fm = \{x \in K \mid \abs{x} < 1\} = \{x \in K \mid v(x) > 0\}$. We let $k = \cO_K / \fm$ denote the residue field.

\begin{corollary}\label{cor:2_4}
    $\cO_K$ is a local ring with unique maximal ideal $\fm$.
\end{corollary}

\begin{definition}
    Let $v : K^\times \to \bR$ be a valuation. If $v(K^\times) \cong \bZ$, then we say that $v$ is a \emph{discrete valuation} and that $k$ is \emph{discretely valued}.

    An element $\pi \in \cO_K$ is a \emph{uniformiser} if $v(\pi) > 0$ and $v(\pi)$ generates $v(K^\times)$.
\end{definition}

\begin{example}
    $K = \bQ$ with the $p$-adic valuation and $K = k(t)$ with $t$-adic valuation are both discretely valued fields.
\end{example}

\begin{remark}
    If $v$ is a discrete valuation, we can always replace it with an equivalent one such that $v(K^\times) = \bZ$. Such a $v$ will be called a \emph{normalised valuation}.

    In this case, $v(\pi) = 1$ iff $\pi$ is a uniformiser.
\end{remark}

\begin{lemma}\label{lem:2_6}
    Let $v$ be a valuation on $K$. The following are equivalent:
    \begin{enumerate}
        \item $v$ is discrete
        \item $\cO_K$ is a PID
        \item $\cO_K$ is Noetherian
        \item $\fm$ is principal
    \end{enumerate}
\end{lemma}
\begin{proof}
    (i) $\rightarrow$ (ii): $\cO_K$ is a domain since it is a subring of the field $K$.

    Let $I \subseteq \cO_K$ be a non-zero ideal. Let $x \in I \setminus 0$ be such that $v(x)$ is minimal. We show that $I = x \cO_K$.

    Let $y \in I \setminus 0$. Then $v(x^{-1} y) = v(y) - v(x) \ge 0$, so $x^{-1} y \in \cO_K$, and $y = x(x^{-1} y) \in x \cO_K$.

    (ii) $\Rightarrow$ (iii) Clear.

    (iii) $\Rightarrow$ (iv) Write $\fm = x_1 \cO_K + \ldots + x_n \cO_K$. WLOG assume that $v(x_1) \le \ldots \le v(x_n)$. Then $x_2, \ldots, x_n \in x_1 \cO_K$, so $\fm = x_1 \cO_K$.

    (iv) $\Rightarrow$ (i) Suppose that $\fm = \pi \cO_K$. Let $c = v(\pi)$. If $x \in \cO_K$ is such that $v(x) > 0$, then $x \in \fm$, so $v(x) \ge c$. Thus $v(K^\times) \cap (0, c) = \emptyset$. Since $v(K^\times)$ is a subgroup of $\bR$, we have $v(K^\times) = c \bZ$.
\end{proof}

\begin{remark}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field. Then $\cO_K[x^{-1}] = K$ for any $x \in \fm$. In particular, $K = \Frac(\cO_K)$.

    Indeed let $y \in K$. Then $\abs{x^n y} \le 1$ for some $n$ sufficiently large. Then $y = x^n y / x^n \in \cO_K[x^{-1}]$.
\end{remark}

\begin{definition}
    A ring $R$ is called a \emph{discrete valuation ring} (DVR) if it is a PID and has exactly one non-zero prime ideal (necessarily maximal).
\end{definition}

\begin{lemma}\label{lem:2_8}\phantom{}
    \begin{enumerate}
        \item Let $v$ be a discrete valuation on a field $K$. Then $\cO_K$ is a DVR.
        \item Given a DVR $R$, there exists a valuation on $K = \Frac(R)$ such that $\cO_K = R$.
    \end{enumerate}
\end{lemma}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $\cO_K$ is a PID by \autoref{lem:2_6}, so any non-zero prime ideal of $\cO_K$ is maximal. The result follows by \autoref{cor:2_4}.

        \item Let $R$ be a DVR with maximal ideal $\fm = \pi R$, where $\pi \in R$. By unique factorisation, we may write each $x \in R \setminus 0$ uniquely in the form $x = \pi^m u$ for some $u \in R^\times$ and $m \ge 0$. Thus any $x \in K^\times$ can be written uniquely\footnote{if $\pi^m u = \pi^n v$ for some $m, n \in \bZ$ and $u, v \in R^\times$, then $\pi^{n-m} = u v^{-1} \in R^\times$, so $n = m$.} in the form $x = \pi^m u$ for some $u \in R^\times$ and $m \in \bZ$.

        Define $v(\pi^m u) = m$. It is easy to check that $v$ is a valuation, and that $\cO_K = R$. \qedhere
    \end{enumerate}
\end{proof}

\begin{example}
    $\bZ_(p)$ and $k \llbracket t \rrbracket$ are DVRs, where $p$ is a prime and $k$ is a field.
\end{example}

\subsection{\texorpdfstring{$p$}{p}-adic numbers}

\noindent Recall that $\bQ_p$ is the completion of $\bQ$ with respect to $\abs{\cdot}_p$.

An exercise on Example Sheet 1 shows that $\bQ_p$ is a field, that $\abs{\cdot}_p$ extends to $\bQ_p$, and the associated valuation is discrete.

\begin{definition}
    The ring of $p$-adic integers is the valuation ring
    \begin{equation*}
        \bZ_p = \{x \in \bQ_p \mid \abs{x}_p \le 1\} = \{x \in \bQ_p \mid v_p(x) \ge 0\}
    \end{equation*}
\end{definition}

\noindent $\bZ_p$ is a DVR with maximal ideal $p \bZ_p$. Its non-zero ideals are given by $p^n \bZ_p$ for $n \ge 0$.

\begin{proposition}\label{prop:3_2}
    $\bZ_p$ is the closure of $\bZ$ inside $\bQ_p$. In particular, $\bZ_p$ is the completion of $\bZ$ with respect to $\abs{\cdot}_p$.
\end{proposition}
\begin{proof}
    We need to show that $\bZ$ is dense inside $\bZ_p$. We divide this into two parts:
    \begin{enumerate}
        \item $\bZ_{(p)}$ is dense in $\bZ_p$: Note that $\bQ$ is dense inside $\bQ_p$. By \autoref{lem:1_8}, $\bZ_p$ is open in $\bQ_p$, so $\bZ_p \cap \bQ$ is dense in $\bZ_p$.
            \begin{equation*}
                \bZ_p \cap \bQ = \{x \in \bQ \mid \abs{x}_p \le 1\} = \{a/b \in \bQ \mid p \nmid b\} = \bZ_{(p)}
            \end{equation*}
        \item $\bZ$ is dense inside $\bZ_{(p)}$:
    Let $a/b \in \bZ_{(p)}$, with $a, b \in \bZ$ and $p \nmid b$. For $n \in \bN$, choose $y_n \in \bZ$ such that $b y_n \equiv a \pmod{p^n}$. Then $y_n \to a/b$ as $n \to \infty$ with respect to $\abs{\cdot}_p$.
    \end{enumerate}
    Since being dense is transitive\footnote{if $A \subseteq B \subseteq C$, $A$ is dense in $B$ and $B$ is dense in $C$, then $A$ is dense in $C$.}, we are done. The last part follows since $\bZ_p$ is complete\footnote{as it is closed in $\bQ_p$} and $\bZ$ is dense in $\bZ_p$.
\end{proof}

\subsubsection*{Inverse limits}

Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings together with homomorphisms $\varphi_n : A_{n+1} \to A_n$ called \emph{transition maps}. The \emph{inverse limit} of $(A_n)_{n=1}^\infty$ is the set/group/ring
\begin{equation*}
    \varprojlim A_n = \left\{(a_n) \in \prod_{n=1}^\infty A_n \mid \varphi_n(a_{n+1}) = a_n\right\} \subseteq \prod_{n=1}^\infty A_n
\end{equation*}

\noindent Fact: If $A_n$ is a group/ring, then $\varprojlim A_n$ is a group/ring, with group/ring operations defined component-wise.

Let $\theta_m : \varprojlim A_n \to A_m$ denote the natural projection. Then the inverse limit satisfies the following universal property:

\begin{proposition}\label{prop:3_3}
    For any set/group/ring $B$ together with homomorphisms $\psi_n : B \to A_n$ such that
    \begin{equation*}
    \begin{tikzcd}
        & B \arrow[ld, "\psi_{n+1}"'] \arrow[rd, "\psi_n"] &\\
        A_{n+1} \arrow[rr, "\varphi_n"'] & & A_n
    \end{tikzcd}
    \end{equation*}
    commutes for all $n$. Then there exists a unique homomorphism $\phi : B \to \varprojlim A_n$ such that $\theta_m \circ \psi = \psi_m$
\end{proposition}
\begin{proof}
    Define $\psi : B \to \prod_{n=1}^\infty A_n$ by $\psi(b) = (\psi_n(b))_n$. Then $\psi_n = \varphi_n \circ \psi_{n+1}$ implies that $\psi(b) \in \varprojlim A_n$. The map is clearly unique, since we want $\theta_m \circ \psi = \psi_m$, and is a homomorphism (of sets/groups/rings).
\end{proof}

\begin{definition}
    Let $I$ be an ideal of a ring $R$. Then the \emph{$I$-adic completion} of $R$ is the ring
    \begin{equation*}
        \widehat{R} = \varprojlim R/I^n
    \end{equation*}
    where $R/I^{n+1} \to R/I^n$ is the natural projection.
\end{definition}

Note that there is a natural map $i : R \to \widehat{R}$ induced by the natural projections $R \to R/I^n$. We say that $R$ is \emph{$I$-adically complete} if $i$ is an isomorphism.

\noindent Fact: $\ker{i} = \bigcap_{n=1}^\infty I^n$.

\begin{proposition}\label{prop:3_5}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $\pi \in \cO_K$ be such that $\abs{\pi} < 1$. Assume that $K$ is complete with respect to $\abs{\cdot}$. Then
    \begin{enumerate}
        \item $i : \cO_K \to \varprojlim \cO_K / \pi^n \cO_K$ is an isomorphism ($\cO_K$ is $\pi$-adically complete)
        \item Fix a set of coset representatives $A$ for $\cO_K / \pi \cO_K$. Then every $x \in \cO_K$ can be written uniquely in the form
            \begin{equation*}
                x = \sum_{i=0}^\infty a_i \pi^i
            \end{equation*}
            with $a_i \in A$.
            Moreover any such power series $\sum_{i=0}^\infty a_i \pi^i$ converges.
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $i$ is injective: Since $K$ is complete and $\cO_K$ is closed in $K$, $\cO_K$ is complete.
            \begin{align*}
                x \in \ker i
                &\implies x \in \bigcap_{n=1}^\infty \pi^n \cO_K\\
                &\implies \forall n \ge 1, v(x) \ge v(\pi)\\
                &\implies x = 0
            \end{align*}
            $i$ is surjective: Let $(x_n) \in \varprojlim \cO_K / \pi^n \cO_K$. For each $n$, let $y_n \in \cO_K$ be a lift of $x_n$. Then $y_n - y_{n+1} \in \pi^n \cO_K$, so that $v(y_n - y_{n+1}) \ge n v(\pi)$. In terms of absolute values, $\abs{y_n - y_{n+1}} \le \abs{\pi}^n \to 0$. Thus by \autoref{prop:1_6}, $(y_n)$ converges, say $y_n \to y \in \cO_K$. We show that $i(y) = (x_n)$.

            This is equivalent to showing $y_n - y \in \pi^n \cO_K$ for each $n$, or in terms of absolute values, $\abs{y_n - y} \le \abs{\pi}^n$. This follows because for $m > n$, we have
            \begin{equation*}
                \abs{y_n - y_m} \le \max\{\abs{y_n - y_{n+1}}, \ldots, \abs{y_{m-1} - y_m} \} \le \abs{\pi}^n
            \end{equation*}
            so taking $m \to \infty$ gives the result.

        \item See exercise sheet. \qedhere
    \end{enumerate}
\end{proof}

\begin{warning}
    If $(K, \abs{\cdot})$ is not discretely valued, then $\cO_K$ is not necessarily $\fm$-adically complete.
\end{warning}

\begin{corollary}\label{cor:3_6}
    Let $K, A$ be as in part (ii) of \autoref{prop:3_5}. Then every $x \in K$ can be written uniquely as $x = \sum_{i=n}^\infty a_i \pi^i$ for some $n \in \bZ$, $a_i \in A$. Conversely, any such expansion $x = \sum_{i=n}^\infty a_i \pi^i$ defines an element of $K$.
\end{corollary}
\begin{proof}
    Let $n \in \bZ$ be such that $\pi^{-n} x \in \cO_K$ and apply \autoref{prop:3_5} (ii) to $\pi^{-n} x$.
\end{proof}

\begin{corollary}\phantom{}
    \begin{enumerate}
        \item $\bZ_p \cong \varprojlim \bZ / p^n \bZ$.
        \item Every element of $x \in \bQ_p$ can be written uniquely as a Laurent series $x = \sum_{i=n}^\infty a_i p^i$ where $n \in \bZ$ and $a_i \in \{0, \ldots, p - 1\}$
    \end{enumerate}
\end{corollary}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Let $f_n : \bZ \to \bZ_p / p^n \bZ_p$ be the natural map. We have
            \begin{equation*}
                \ker{f_n} = \{x \in \bZ \mid \abs{x}_p \le p^{-n}\} = p^n \bZ
            \end{equation*}
            $f_n$ is surjective: Let $\overline{c} \in \bZ_p / p^n \bZ_p$, and let $c \in \bZ_p$ be a lift. Since $\bZ$ is dense in $\bZ_p$, there is\footnote{recall that closed balls are open, and $x \in \bZ$ iff $x \in \overline{B}(c, p^{-n})$} an $x \in \bZ$ such that $x \in c + p^n \bZ$. Then $f_n(x) = \overline{c}$.

            Thus $f_n$ induces an isomorphism $\tilde{f}_n : \bZ / p^n \bZ \to \bZ_p / p^n \bZ_p$. Note that the diagram
            \begin{equation*}
            \begin{tikzcd}
                \bZ/p^{n+1} \bZ \arrow[r]\arrow[d, "\tilde{f}_{n+1}", "\sim"'] & \bZ/p^n \bZ \arrow[d, "\tilde{f}_n", "\sim"']\\
                \bZ_p/p^{n+1} \bZ_p \arrow[r] & \bZ_p/p^n \bZ_p
            \end{tikzcd}
            \end{equation*}
            commutes. Thus the $\tilde{f}_n$ induce an isomorphism $\varprojlim \bZ/p^n\bZ \cong \varprojlim \bZ_p/p^n\bZ_p$.

            On the other hand, \autoref{prop:3_5} implies that $\bZ_p \cong \varprojlim \bZ_p / p^n \bZ_p$, so we are done.

        \item This follows from \autoref{cor:3_6}, using $\bZ_p / p \bZ_p \cong \bF_p$.\qedhere
    \end{enumerate}
\end{proof}

\section{Complete Valued Fields}

\subsection{Hensel's Lemma}

\begin{theorem}[Hensel's Lemma Version 1]\label{thm:4_1}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(X) \in \cO_K[X]$ and assume that there is an $a \in \cO_K$ such that $\abs{f(a)} < \abs{f'(a)}^2$. Then there exists a unique $x \in \cO_K$ such that $f(x) = 0$ and $\abs{x - a} < \abs{f'(a)}$.
\end{theorem}
\begin{proof}
    Let $v$ be a normalized valuation and let $\pi \in \cO_K$ be a uniformiser. Let $r = v(f'(a))$. We shall construct a sequence $(x_n)_{n=1}^\infty$ in $\cO_K$ such that
    \begin{enumerate}
        \item $f(x_n) \equiv 0 \pmod{\pi^{n + 2r}}$.
        \item $x_{n+1} \equiv x_n \pmod{\pi^{n+r}}$.
    \end{enumerate}
    Take $x_1 = a$, then\footnote{$\abs{f(a)} < \abs{f'(a)}^2$ implies $v(f(a)) > 2v(f'(a)) = 2r$, so $v(f(x_1)) \ge 1 + 2r$} $f(x_1) \equiv 0 \pmod{\pi^{1+2r}}$.

    Now suppose we have constructed $x_1, \ldots, x_n$ satisfying (i) and (ii). Define $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$. We first verify (ii): Since $x_n \equiv x_1 \pmod{\pi^{r+1}}$, we have\footnote{since $f'(x_n) \equiv f'(x_1) \pmod{\pi^{r+1}}$} $v(f'(x_n)) = r$. Hence $\frac{f(x_n)}{f'(x_n)} \equiv 0 \pmod{\pi^{n+r}}$ by (i). Thus (ii) holds.

    Note that for indeterminates $X, Y$, $f(X + Y) = f_0(X) + f_1(X) Y + f_2(X) Y^2 + \ldots$ for some $f_i \in \cO_K[X]$, and $f_0(X) = f(X)$, $f_1(X) = f'(X)$. Then
    \begin{equation*}
        f(x_{n+1}) = f(x_n) + f'(x_n) c + \underbrace{f_2(x_n) c^2 + \ldots}_{\in \pi^{n + 2r + 1} \cO_K}
    \end{equation*}
    where $c = -\frac{f(x_n)}{f'(x_n)}$. Thus
    \begin{equation*}
        f(x_{n+1}) \equiv f(x_n) + f'(x_n) c \equiv 0 \pmod{\pi^{n + 2r + 1}}
    \end{equation*}

    Now (ii) implies that $(x_n)$ is Cauchy, say $x_n \to x \in \cO_K$. Then $f(x) = \lim_{n \to \infty} f(x_n) = 0$ by (i). Moreover, (ii) implies that $a = x_1 \equiv x_n \pmod{\pi^{r+1}}$ for all $n$, so $x \equiv a \pmod{\pi^{r+1}}$, which implies that $\abs{x - a} < \abs{f'(a)}$. This completes the existence part of the proof.

    For uniqueness, suppose that $x'$ also satisfies $f(x') = 0$ and $\abs{x' - a} < \abs{f'(a)}$, but $x' \neq x$. Let $\delta = x' - x \neq 0$. Then $\abs{x' - a}, \abs{x - a} < \abs{f'(a)}$ so by the ultrametric inequality, $\abs{\delta} = \abs{x' - x} < \abs{f'(a)}$. However,
    \begin{equation*}
        0 = f(x') = f(x + \delta) = \underbrace{f(x)}_{0} + f'(x) \delta + \underbrace{(\ldots)\delta^2}_{\abs{\cdot} \le \abs{\delta}^2}
    \end{equation*}
    so $\abs{f'(x) \delta} \le \abs{\delta}^2$, and\footnote{as $a \equiv x \pmod{\pi^{r+1}}$, $0 \not\equiv f'(a) \equiv f'(x) \pmod{\pi^{r+1}}$} $\abs{f'(a)} = \abs{f'(x)} \le \abs{\delta}$, which gives a contradiction.
\end{proof}

\begin{remark}
    The proof above uses the iteration $x_{n=1} = x_n - \frac{f(x_n)}{f'(x_n)}$. This is the non-archimedean analogue of the Newton-Raphson method.
\end{remark}

\begin{corollary}\label{cor:4_2}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, $f(X) \in \cO[X]$, and let $\overline{c} \in k = \cO_K / \fm$ be a simple root of $\overline{f}(X) = f(X) \pmod{\fm}$ in $k[X]$. Then there is a unique $x \in \cO_K$ such that $f(x) = 0$ and $x \equiv \overline{c} \pmod{\fm}$.
\end{corollary}
\begin{proof}
    Apply \autoref{thm:4_1} to a lift $c \in \cO_K$ of $\overline{c}$. Then $\abs{f(c)} < 1 = \abs{f'(c)}^2$ since $\overline{c}$ is a simple root.
\end{proof}

\begin{example}
    $f(X) = X^2 - 2$ has a simple root mod $7$. Thus $\sqrt{2} \in \bZ_7$.
\end{example}

\begin{corollary}\label{cor:4_3}
    \begin{equation*}
        \bQ_p^\times / (\bQ_p^\times)^2 \cong
        \begin{cases}
            (\bZ / 2 \bZ)^2 & \text{if } p > 2\\
            (\bZ / 2 \bZ)^3 & \text{if } p = 2
        \end{cases}
    \end{equation*}
\end{corollary}
\begin{proof}
    Case $p > 2$: Let $b \in \bZ_p^\times$. Applying \autoref{cor:4_2} to $f(X) = X^2 - b$, we find that $b \in (\bZ_p^\times)^2$ iff $\overline{b} \in (\bF_p^\times)^2$. Thus we have an isomorphism $\bZ_p^\times / (\bZ_p^\times)^2 \cong \bF_p^\times / (\bF_p^\times)^2 \cong \bZ / 2\bZ$.

    We have an isomorphism $\bZ_p^\times \times \bZ \xrightarrow{\sim} \bQ_p^\times$ given by $(u, n) \mapsto u p^n$, so $\bQ_p^\times / (\bQ_p)^2 \cong \bZ_p^\times / (\bZ_p^\times)^2 \times \bZ / 2\bZ \cong (\bZ / 2\bZ)^2$

    Case $p = 2$: Let $b \in \bZ_2^\times$. Consider $f(X) = X^2 - b$. We have $f'(X) = 2X \equiv 0 \pmod{2}$.

    Suppose that $b \equiv 1 \pmod{8}$. Then
    \begin{equation*}
        \abs{f(1)}_2 \le 2^{-3} < 2^{-2} = \abs{f'(1)}_2^2
    \end{equation*}
    Hensel's lemma implies that $f(X)$ has a root in $\bZ_2$, so $b \in (\bZ_2^\times)^2$. Conversely if $b \in (\bZ_2^\times)^2$, then $b \pmod{8} \in ((\bZ / 8\bZ)^\times)^2 = \{1\}$. Thus $b \in (\bZ_2^\times)^2$ iff $b \equiv 1 \pmod{8}$. Thus we have an isomorphism $\bZ_2^\times / (\bZ_2^\times)^2 \cong (\bZ / 8 \bZ)^\times \cong (\bZ / 2\bZ)^2$. We can conclude using the isomorphism $\bZ_2^\times \times \bZ \cong \bQ_2^\times$ as in the previous case.
\end{proof}

\begin{theorem}[Hensel's Lemma Version 2]
    Let $(K, \abs{\cdot})$ be a complete, discretely valued field, and $f(X) \in \cO_K[X]$. Suppose $\overline{f}(X) = f(X) \pmod{\fm}$ in $k[X]$ factorises as $\overline{f}(X) = \overline{g}(X) \overline{h}(X)$ in $k[X]$ with $\overline{g}(X)$ and $\overline{h}(X)$ coprime. Then there is a factorisation $f(X) = g(X) h(X)$ in $\cO_K[X]$ with $\overline{g}(X) \equiv g(X) \pmod{\fm}$, $\overline{h}(X) \equiv h(X) \pmod{\fm}$, and $\deg{g} = \deg{\overline{g}}$.
\end{theorem}
\begin{proof}
    See Example Sheet 1.
\end{proof}

\end{document}
