\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{array}
\usepackage{chngcntr}
\usepackage{commath}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{stmaryrd}
\usepackage{thmtools}
\usepackage{tikz}
\usepackage{tikz-cd}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[subsection]
\newtheorem*{example}{Example}
\newtheorem*{warning}{Warning}
\newtheorem*{exercise}{Exercise}
\newtheorem*{fact}{Fact}
\newtheorem*{notation}{Notation}

\theoremstyle{plain}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{corollary}[definition]{Corollary}
\newtheorem*{lemma*}{Lemma}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\renewcommand{\qedsymbol}{$\blacksquare$}

\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Char}{char}
\DeclareMathOperator{\Int}{int}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Adj}{Adj}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\mult}{mult}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\id}{id}

\newcommand{\FF}{\mathbb{F}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\fp}{\mathfrak{p}}
\newcommand{\fq}{\mathfrak{q}}
\newcommand{\fm}{\mathfrak{m}}

\renewcommand\thesection{\Roman{section}}
\counterwithout{subsection}{section}

\setlist[enumerate,1]{label=(\roman*), nosep}
\setlist[itemize,1]{nosep}

\title{Part III Local Fields Lecture Notes}
\author{Ming Yean Lim}

\begin{document}

\maketitle

\noindent These lecture notes were based on the Part III course Local Fields taught during Michaelmas 2022 by Dr. Rong Zhou.

\section{Basic Theory}

\subsection{Absolute Value}

\begin{definition}
    Let $K$ be a field. An \emph{absolute value} on $K$ is a function $\abs{\cdot} : K \to \RR_{\ge 0}$ such that
    \begin{enumerate}
        \item (Definiteness) $\forall x \in K,\, \abs{x} = 0 \iff x = 0$
        \item (Multiplicativity) $\forall x, y \in K,\, \abs{x y} = \abs{x} \abs{y}$
        \item (Triangle inequality) $\forall x, y \in K,\, \abs{x + y} \le \abs{x} + \abs{y}$
    \end{enumerate}
    $(K, \abs{\cdot})$ is said to be a \emph{valued field}.
\end{definition}

\begin{example}\phantom{}
    \begin{itemize}
        \item $K = \QQ, \RR, \CC$ with the usual absolute value, denoted $\abs{\cdot}_\infty$.
        \item Let $K$ be any field, then there is a \emph{trivial absolute value} given by
            \begin{equation*}
                \abs{x} =
                \begin{cases}
                    0 & \text{if } x = 0 \\
                    1 & \text{if } x \neq 0
                \end{cases}
            \end{equation*}
        \item The only absolute value on a finite field is trivial. This follows from the easy fact that for $n \ge 1$, $x^n = 1$ implies that $\abs{x} = 1$.
        \item Let $K = \QQ$, and let $p$ be a prime. The \emph{$p$-adic absolute value} is defined to be
            \begin{equation*}
                \abs{x}_p =
                \begin{cases}
                    0 & \text{if } x = 0 \\
                    p^{-n} & \text{if } x = p^n \frac{a}{b}\text{, where } p \nmid a, b.
                \end{cases}
            \end{equation*}
            In fact, $\abs{\cdot}_p$ satisfies the stronger inequality $\abs{x + y}_p \le \max\{\abs{x}_p, \abs{y}_p\}$.
    \end{itemize}
\end{example}

\noindent An absolute value $\abs{\cdot}$ on $K$ induces a metric $d(x, y) = \abs{x - y}$, which in turn induces a topology on $K$.

\begin{definition}
    Let $\abs{\cdot}, \abs{\cdot}'$ be absolute values on $K$. We say $\abs{\cdot}$ and $\abs{\cdot}'$ are \emph{equivalent} if they define the same topology.

    An equivalence class of absolute values is called a \emph{place}.
\end{definition}

\begin{proposition}\label{prop:1_3}
    Let $\abs{\cdot}, \abs{\cdot}'$ be non-trivial absolute values on $K$. The following are equivalent:
    \begin{enumerate}
        \item $\abs{\cdot}$ and $\abs{\cdot}'$ are \emph{equivalent}
        \item $\forall x \in K, \abs{x} < 1 \iff \abs{x}' < 1$
        \item $\exists c \in \RR_{> 0}, \forall x \in K, \abs{x}' = \abs{x}^c$
    \end{enumerate}
\end{proposition}
\begin{proof}
    (i) $\Rightarrow$ (ii):
    \begin{align*}
        \abs{x} < 1
        &\iff x^n \rightarrow 0 \text{ wrt } \abs{\cdot}\\
        &\iff x^n \rightarrow 0 \text{ wrt } \abs{\cdot}'\\
        &\iff \abs{x}' < 1
    \end{align*}

    \noindent(ii) $\Rightarrow$ (iii): Let $a \in K^\times$ be such that $\abs{a} < 1$ (which exists since $\abs{\cdot}$ is non-trivial). It suffices to show that $\forall x \in K^\times$,
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} = \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Fix $x \in K^\times$ and suppose that the equality does not hold. WLOG we may assume that
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} < \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Pick a rational number $m/n$ (with $n > 0$) such that
    \begin{equation*}
        \frac{\log{\abs{x}}}{\log{\abs{a}}} < \frac{m}{n} < \frac{\log{\abs{x}'}}{\log{\abs{a}'}}
    \end{equation*}
    Then
    \begin{align*}
        n \log{\abs{x}} &> m \log{\abs{a}} \\
        n \log{\abs{x}'} &< m \log{\abs{a}'}
    \end{align*}
    By exponentiating, we find that
    \begin{equation*}
        \abs{\frac{x^n}{a^m}}' < 1 < \abs{\frac{x^n}{a^m}}
    \end{equation*}
    contradiction.

    \noindent (iii) $\Rightarrow$ (i): (iii) implies that the topologies have the same open balls.
\end{proof}

\begin{definition}
    An absolute value $\abs{\cdot}$ on $K$ is \emph{non-archimedean} if it satisfies the \emph{ultrametric inequality}
    \begin{equation*}
        \abs{x + y} \le \max\{\abs{x}, \abs{y}\} \qquad \forall x, y \in K
    \end{equation*}
    $\abs{\cdot}$ is \emph{archimedean} if it is not non-archimedean.
\end{definition}

\begin{example}
    $\abs{\cdot}_\infty$ is archimedean, while $\abs{\cdot}_p$ on $\QQ$ is non-archimedean.
\end{example}

\begin{lemma}[All triangles are isoceles]\label{lem:1_5}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $x, y \in K$. If $\abs{x} < \abs{y}$, then $\abs{x - y} = \abs{y}$.
\end{lemma}
\begin{proof}
    \begin{align*}
        \abs{x - y}
        &\le \max\{\abs{x}, \abs{y}\}\\
        &= \abs{y}\\
        &= \abs{x + (y - x)}\\
        &\le \max\{\abs{x}, \abs{x - y}\} \\
        &= \abs{x - y} \qquad(\text{since } \abs{y} \not\le \abs{x}) \qedhere
    \end{align*}
\end{proof}

\begin{proposition}\label{prop:1_6}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $(x_n)_{n=1}^\infty$ be a sequence in $K$. If $\abs{x_n - x_{n+1}} \to 0$, then $(x_n)_{n=1}^\infty$ is Cauchy.

    In particular, if in addition $K$ is complete, then $(x_n)$ converges.
\end{proposition}
\begin{proof}
    Fix $\varepsilon > 0$. Choose $N$ such that $\forall n \ge N, \abs{x_n - x_{n+1}} < \varepsilon$. Then for $m \ge n \ge N$, we have
    \begin{align*}
        \abs{x_n - x_m}
        &= \abs{(x_n - x_{n+1}) + \ldots + (x_{m-1} - x_m)}\\
        &\le \max\{\abs{x_n - x_{n+1}}, \ldots, \abs{x_{m-1} - x_m} \}\\
        &< \varepsilon \qedhere
    \end{align*}
\end{proof}

\begin{example}
    We construct a sequence $(x_n)$ in $\ZZ$ such that
    \begin{enumerate}
        \item $x_n^2 + 1 \equiv 0 \pmod{5^n}$
        \item $x_{n + 1} \equiv x_n \pmod{5^n}$
    \end{enumerate}

    Set $x_1 = 2$. Suppose we have constructed the sequence up to $x_n$, where $n \ge 1$. We have $x_n^2 + 1 = 5^n a$. It suffices to find $b$ such that $x_{n+1} = x_n + 5^n b$. We have
    \begin{align*}
        x_{n+1}^2 + 1
        &= x_n^2 + 2 \cdot 5^n b x_n + 5^{2n} b^2 + 1\\
        &= 5^n a + 2 \cdot 5^n b x_n + 5^{2n} b^2\\
        &\equiv 5^n (a + 2 b x_n) \pmod{5^{n+1}}
    \end{align*}
    Thus we just take any $b$ with $a + 2b x_n \equiv 0 \pmod{5}$.

    Now (ii) says that $\abs{x_n - x_{n+1}}_5 \le 5^{-n}$, so by \autoref{prop:1_6}, $(x_n)$ is Cauchy in $(\QQ, \abs{\cdot}_5)$. Suppose that $x_n$ converges to $\ell \in \QQ$. Then $x_n^2 \rightarrow \ell^2 \in \QQ$. However (i) implies that $x_n^2 \rightarrow -1$, so that $\ell^2 = -1$. This shows that $(\QQ, \abs{\cdot}_5)$ is not complete.
\end{example}

\begin{definition}
    The \emph{$p$-adic numbers} $\QQ_p$ is the completion of $\QQ$ with respect to $\abs{\cdot}_p$.
\end{definition}

\begin{remark}
    $\RR$ is the completion of $\QQ$ with respect to $\abs{\cdot}_\infty$.
\end{remark}

\noindent Let $(K, \abs{\cdot})$ be a valued field. For $x \in K$ and $r \in \RR_{> 0}$, define
\begin{align*}
    B(x, r) &= \{y \in K \mid \abs{x - y} < r\}\\
    \overline{B}(x, r) &= \{y \in K \mid \abs{x - y} \le r\}
\end{align*}

\begin{lemma}\label{lem:1_8}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field.
    \begin{enumerate}
        \item (Open balls don't have centres) If $z \in B(x, r)$, then $B(z, r) = B(x, r)$
        \item (Closed balls don't have centres) If $z \in \overline{B}(x, r)$, then $\overline{B}(z, r) = \overline{B}(x, r)$
        \item (Open balls are closed) $B(x, r)$ is closed.
        \item (Closed balls are open) $\overline{B}(x, r)$ is open.
    \end{enumerate}
\end{lemma}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Let $y \in B(x, r)$. Then
            \begin{equation*}
                \abs{z - y} \le \max\{\abs{z-x}, \abs{x-y}\} < r
            \end{equation*}
            so $y \in B(z, r)$. The other inclusion follows by symmetry.
        \item Same as (i) with $<$ replaced with $\le$.
        \item Let $y \in B(x, r)^c$. We show that $y \in B(y, r) \subseteq B(x, r)^c$. Suppose there is a $z \in B(x, r) \cap B(y, r)$. Then $B(x, r) = B(z, r) = B(y, r)$ by (i), so $y \in B(x, r)$, contradiction.
        \item Let $z \in \overline{B}(x, r)$. Then $z \in B(z, r) \subseteq \overline{B}(z, r) = \overline{B}(x, r)$ by (ii). \qedhere
    \end{enumerate}
\end{proof}

\subsection{Valuation Rings}

\begin{definition}
    Let $K$ be a field. A valuation on $K$ is a function $v : K^\times \to \RR$ such that
    \begin{enumerate}
        \item $v(xy) = v(x) + v(y)$
        \item $v(x + y) \ge \min\{v(x), v(y)\}$
    \end{enumerate}
\end{definition}

\noindent Fix $0 < \alpha < 1$. If $v$ is a valuation on $K$, then
\begin{equation*}
    \abs{x} =
    \begin{cases}
        \alpha^{v(x)} & \text{if } x \neq 0\\
        0 & \text{if } x = 0
    \end{cases}
\end{equation*}
determines a non-archimedean absolute value on $K$.

Conversely a non-archimedean absolute value determines a valuation $v(x) = \log_\alpha \abs{x}$.

\begin{remark}
    We ignore the trivial valuation $v(x) = 0 \quad \forall x \in K^\times$.
\end{remark}
\begin{remark}
    We say that $v_1, v_2$ are \emph{equivalent} if $\exists c \in \RR_{> 0}, \forall x \in K^\times, v_1(x) = c v_2(x)$.
\end{remark}

\begin{example}\phantom{}
    \begin{itemize}
        \item For $K = \QQ$, $v_p(x) = -\log_p \abs{x}_p$ is the $p$-adic valuation.
        \item Let $k$ be a field and let $K = k(t)$ be the rational function field. Define $v(t^n \frac{f(t)}{g(t)}) = n$, where $f, g \in k[t]$ are such that $f(0), g(0) \neq 0$. This gives the \emph{$t$-adic valuation}.
        \item Let $k$ be a field and let $K = k \llbracket t \rrbracket$ be the field of formal Laurent series. Define $v(\sum a_i t^i) = \min \{i \mid a_i \neq 0\}$. This is also called the $t$-adic valuation.
    \end{itemize}
\end{example}

\begin{definition}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field. The \emph{valuation ring} of $K$ is defined to be
    \begin{equation*}
        \cO_K = \{x \in K \mid \abs{x} \le 1\} = \overline{B}(0, 1)
    \end{equation*}
\end{definition}
\noindent Note that we also have $\cO_K = \{0\} \cup \{x \in K^\times \mid v(x) \ge 0\}$.

\begin{proposition}\label{prop:2_3}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field.
    \begin{enumerate}
        \item $\cO_K$ is an open subring of $K$.
        \item The subsets $\{x \in K \mid \abs{x} \le r\}$ and $\{x \in K \mid \abs{x} < r\}$ for $r \le 1$ are open ideals of $\cO_K$.
        \item $\cO_K^\times = \{x \in K \mid \abs{x} = 1\}$
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Openness follows from \autoref{lem:1_8}.

            \noindent We have $\abs{0} = 0$ and $\abs{1} = 1$, so $0, 1 \in \cO_K$.

            \noindent If $x \in \cO_K$, then $\abs{-x} = \abs{-1}\abs{x} = \abs{x} \le 1$, so $-x \in \cO_K$.

            \noindent If $x, y \in \cO_K$, then $\abs{x + y} \le \max \{\abs{x}, \abs{y}\} \le 1$. Also $\abs{x y} = \abs{x} \abs{y} \le 1$, so $x + y, x y \in \cO_K$.

        \item Similar to (i).

        \item $\abs{x} \abs{x^{-1}} = 1$ and $\abs{x}, \abs{x^{-1}} \le 1$ together imply that $\abs{x} = \abs{x^{-1}} = 1$. \qedhere
    \end{enumerate}
\end{proof}

\noindent The above proposition shows that $\cO_K$ is a local ring with maximal ideal $\fm = \{x \in K \mid \abs{x} < 1\} = \{x \in K \mid v(x) > 0\}$. We let $k = \cO_K / \fm$ denote the residue field.

\begin{corollary}\label{cor:2_4}
    $\cO_K$ is a local ring with unique maximal ideal $\fm$.
\end{corollary}

\begin{definition}
    Let $v : K^\times \to \RR$ be a valuation. If $v(K^\times) \cong \ZZ$, then we say that $v$ is a \emph{discrete valuation} and that $K$ is \emph{discretely valued}.\footnote{In this case, implicitly $K$ is non-archimedean.}

    An element $\pi \in \cO_K$ is a \emph{uniformiser} if $v(\pi) > 0$ and $v(\pi)$ generates $v(K^\times)$.
\end{definition}

\begin{example}
    $K = \QQ$ with the $p$-adic valuation and $K = k(t)$ with $t$-adic valuation are both discretely valued fields.
\end{example}

\begin{remark}
    If $v$ is a discrete valuation, we can always replace it with an equivalent one such that $v(K^\times) = \ZZ$. Such a $v$ will be called a \emph{normalised valuation}.

    In this case, $v(\pi) = 1$ iff $\pi$ is a uniformiser.
\end{remark}

\begin{lemma}\label{lem:2_6}
    Let $v$ be a valuation on $K$. The following are equivalent:
    \begin{enumerate}
        \item $v$ is discrete
        \item $\cO_K$ is a PID
        \item $\cO_K$ is Noetherian
        \item $\fm$ is principal
    \end{enumerate}
\end{lemma}
\begin{proof}
    (i) $\rightarrow$ (ii): $\cO_K$ is a domain since it is a subring of the field $K$.

    Let $I \subseteq \cO_K$ be a non-zero ideal. Let $x \in I \setminus 0$ be such that $v(x)$ is minimal. We show that $I = x \cO_K$.

    Let $y \in I \setminus 0$. Then $v(x^{-1} y) = v(y) - v(x) \ge 0$, so $x^{-1} y \in \cO_K$, and $y = x(x^{-1} y) \in x \cO_K$.

    \noindent (ii) $\Rightarrow$ (iii): Clear.

    \noindent (iii) $\Rightarrow$ (iv): Write $\fm = x_1 \cO_K + \ldots + x_n \cO_K$. WLOG assume that $v(x_1) \le \ldots \le v(x_n)$. Then $x_2, \ldots, x_n \in x_1 \cO_K$, so $\fm = x_1 \cO_K$.

    \noindent (iv) $\Rightarrow$ (i): Suppose that $\fm = \pi \cO_K$. Let $c = v(\pi)$. If $x \in \cO_K$ is such that $v(x) > 0$, then $x \in \fm$, so $v(x) \ge c$. Thus $v(K^\times) \cap (0, c) = \emptyset$. Since $v(K^\times)$ is a subgroup of $\RR$, we have $v(K^\times) = c \ZZ$.
\end{proof}

\begin{remark}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field. Then $\cO_K[x^{-1}] = K$ for any $x \in \fm$. In particular, $K = \Frac(\cO_K)$.

    Indeed let $y \in K$. Then $\abs{x^n y} \le 1$ for some $n$ sufficiently large. Then $y = x^n y / x^n \in \cO_K[x^{-1}]$.
\end{remark}

\begin{definition}
    A ring $R$ is called a \emph{discrete valuation ring} (DVR) if it is a PID and has exactly one non-zero prime ideal (necessarily maximal).
\end{definition}

\begin{lemma}\label{lem:2_8}\phantom{}
    \begin{enumerate}
        \item Let $v$ be a discrete valuation on a field $K$. Then $\cO_K$ is a DVR.
        \item Given a DVR $R$, there exists a valuation on $K = \Frac(R)$ such that $\cO_K = R$.
    \end{enumerate}
\end{lemma}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $\cO_K$ is a PID by \autoref{lem:2_6}, so any non-zero prime ideal of $\cO_K$ is maximal. The result follows by \autoref{cor:2_4}.

        \item Let $R$ be a DVR with maximal ideal $\fm = \pi R$, where $\pi \in R$. By unique factorisation, we may write each $x \in R \setminus 0$ uniquely in the form $x = \pi^m u$ for some $u \in R^\times$ and $m \ge 0$. Thus any $x \in K^\times$ can be written uniquely\footnote{if $\pi^m u = \pi^n v$ for some $m, n \in \ZZ$ and $u, v \in R^\times$, then $\pi^{n-m} = u v^{-1} \in R^\times$, so $n = m$.} in the form $x = \pi^m u$ for some $u \in R^\times$ and $m \in \ZZ$.

        Define $v(\pi^m u) = m$. It is easy to check that $v$ is a valuation, and that $\cO_K = R$. \qedhere
    \end{enumerate}
\end{proof}

\begin{example}
    $\ZZ_{(p)}$ and $k \llbracket t \rrbracket$ are DVRs, where $p$ is a prime and $k$ is a field.
\end{example}

\subsection{\texorpdfstring{$p$}{p}-adic numbers}

\noindent Recall that $\QQ_p$ is the completion of $\QQ$ with respect to $\abs{\cdot}_p$.

An exercise on Example Sheet 1 shows that $\QQ_p$ is a field, that $\abs{\cdot}_p$ extends to $\QQ_p$, and the associated valuation is discrete.

\begin{definition}
    The ring of \emph{$p$-adic integers} is the valuation ring
    \begin{equation*}
        \ZZ_p = \{x \in \QQ_p \mid \abs{x}_p \le 1\} = \{x \in \QQ_p \mid v_p(x) \ge 0\}
    \end{equation*}
\end{definition}

\noindent $\ZZ_p$ is a DVR with maximal ideal $p \ZZ_p$. Its non-zero ideals are given by $p^n \ZZ_p$ for $n \ge 0$.

\begin{proposition}\label{prop:3_2}
    $\ZZ_p$ is the closure of $\ZZ$ inside $\QQ_p$. In particular, $\ZZ_p$ is the completion of $\ZZ$ with respect to $\abs{\cdot}_p$.
\end{proposition}
\begin{proof}
    We need to show that $\ZZ$ is dense inside $\ZZ_p$. We divide this into two parts:
    \begin{enumerate}
        \item $\ZZ_{(p)}$ is dense in $\ZZ_p$: Note that $\QQ$ is dense inside $\QQ_p$. By \autoref{lem:1_8}, $\ZZ_p$ is open in $\QQ_p$, so $\ZZ_p \cap \QQ$ is dense in $\ZZ_p$.
            \begin{equation*}
                \ZZ_p \cap \QQ = \{x \in \QQ \mid \abs{x}_p \le 1\} = \{a/b \in \QQ \mid p \nmid b\} = \ZZ_{(p)}
            \end{equation*}
        \item $\ZZ$ is dense inside $\ZZ_{(p)}$:
    Let $a/b \in \ZZ_{(p)}$, with $a, b \in \ZZ$ and $p \nmid b$. For $n \in \NN$, choose $y_n \in \ZZ$ such that $b y_n \equiv a \pmod{p^n}$. Then $y_n \to a/b$ as $n \to \infty$ with respect to $\abs{\cdot}_p$.
    \end{enumerate}
    Since being dense is transitive\footnote{if $A \subseteq B \subseteq C$, $A$ is dense in $B$ and $B$ is dense in $C$, then $A$ is dense in $C$.}, we are done. The last part follows since $\ZZ_p$ is complete\footnote{as it is closed in $\QQ_p$} and $\ZZ$ is dense in $\ZZ_p$.
\end{proof}

\subsubsection*{Inverse Limits}

Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings together with homomorphisms $\varphi_n : A_{n+1} \to A_n$ called \emph{transition maps}. The \emph{inverse limit} of $(A_n)_{n=1}^\infty$ is the set/group/ring
\begin{equation*}
    \varprojlim A_n = \bigg\{(a_n) \in \prod_{n=1}^\infty A_n \,\bigg\vert\, \varphi_n(a_{n+1}) = a_n\bigg\} \subseteq \prod_{n=1}^\infty A_n
\end{equation*}

\begin{fact}
    If $A_n$ is a group/ring, then $\varprojlim A_n$ is a group/ring, with group/ring operations defined component-wise.
\end{fact}

Let $\theta_m : \varprojlim A_n \to A_m$ denote the natural projection. Then the inverse limit satisfies the following universal property:

\begin{proposition}\label{prop:3_3}
    For any set/group/ring $B$ together with homomorphisms $\psi_n : B \to A_n$ such that
    \begin{equation*}
    \begin{tikzcd}
        & B \arrow[ld, "\psi_{n+1}"'] \arrow[rd, "\psi_n"] &\\
        A_{n+1} \arrow[rr, "\varphi_n"'] & & A_n
    \end{tikzcd}
    \end{equation*}
    commutes for all $n$. Then there exists a unique homomorphism $\phi : B \to \varprojlim A_n$ such that $\theta_m \circ \psi = \psi_m$
\end{proposition}
\begin{proof}
    Define $\psi : B \to \prod_{n=1}^\infty A_n$ by $\psi(b) = (\psi_n(b))_n$. Then $\psi_n = \varphi_n \circ \psi_{n+1}$ implies that $\psi(b) \in \varprojlim A_n$. The map is clearly unique, since we want $\theta_m \circ \psi = \psi_m$, and is a homomorphism (of sets/groups/rings).
\end{proof}

\begin{definition}
    Let $I$ be an ideal of a ring $R$. Then the \emph{$I$-adic completion} of $R$ is the ring
    \begin{equation*}
        \widehat{R} = \varprojlim R/I^n
    \end{equation*}
    where $R/I^{n+1} \to R/I^n$ is the natural projection.
\end{definition}

Note that there is a natural map $i : R \to \widehat{R}$ induced by the natural projections $R \to R/I^n$. We say that $R$ is \emph{$I$-adically complete} if $i$ is an isomorphism.

\begin{fact}
    $\ker{i} = \bigcap_{n=1}^\infty I^n$.
\end{fact}

\begin{proposition}\label{prop:3_5}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field and let $\pi \in \cO_K$ be such that $\abs{\pi} < 1$. Assume that $K$ is complete with respect to $\abs{\cdot}$. Then
    \begin{enumerate}
        \item $i : \cO_K \to \varprojlim \cO_K / \pi^n \cO_K$ is an isomorphism ($\cO_K$ is $\pi$-adically complete)
        \item Fix a set of coset representatives $A$ for $\cO_K / \pi \cO_K$. Then every $x \in \cO_K$ can be written uniquely in the form
            \begin{equation*}
                x = \sum_{i=0}^\infty a_i \pi^i
            \end{equation*}
            with $a_i \in A$.
            Moreover any such power series $\sum_{i=0}^\infty a_i \pi^i$ converges.
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $i$ is injective: Since $K$ is complete and $\cO_K$ is closed in $K$, $\cO_K$ is complete.
            \begin{align*}
                x \in \ker i
                &\implies x \in \bigcap_{n=1}^\infty \pi^n \cO_K\\
                &\implies \forall n \ge 1, v(x) \ge v(\pi)\\
                &\implies x = 0
            \end{align*}
            $i$ is surjective: Let $(x_n) \in \varprojlim \cO_K / \pi^n \cO_K$. For each $n$, let $y_n \in \cO_K$ be a lift of $x_n$. Then $y_n - y_{n+1} \in \pi^n \cO_K$, so that $v(y_n - y_{n+1}) \ge n v(\pi)$. In terms of absolute values, $\abs{y_n - y_{n+1}} \le \abs{\pi}^n \to 0$. Thus by \autoref{prop:1_6}, $(y_n)$ converges, say $y_n \to y \in \cO_K$. We show that $i(y) = (x_n)$.

            This is equivalent to showing $y_n - y \in \pi^n \cO_K$ for each $n$, or in terms of absolute values, $\abs{y_n - y} \le \abs{\pi}^n$. This follows because for $m > n$, we have
            \begin{equation*}
                \abs{y_n - y_m} \le \max\{\abs{y_n - y_{n+1}}, \ldots, \abs{y_{m-1} - y_m} \} \le \abs{\pi}^n
            \end{equation*}
            so taking $m \to \infty$ gives the result.

        \item See Example Sheet 1. \qedhere
    \end{enumerate}
\end{proof}

\begin{warning}
    If $(K, \abs{\cdot})$ is not discretely valued, then $\cO_K$ is not necessarily $\fm$-adically complete.
\end{warning}

\begin{corollary}\label{cor:3_6}
    Let $K, A$ be as in part (ii) of \autoref{prop:3_5}. Then every $x \in K$ can be written uniquely as $x = \sum_{i=n}^\infty a_i \pi^i$ for some $n \in \ZZ$, $a_i \in A$. Conversely, any such expansion $x = \sum_{i=n}^\infty a_i \pi^i$ defines an element of $K$.
\end{corollary}
\begin{proof}
    Let $n \in \ZZ$ be such that $\pi^{-n} x \in \cO_K$ and apply \autoref{prop:3_5} (ii) to $\pi^{-n} x$.
\end{proof}

\begin{corollary}\label{cor:3_7}\phantom{}
    \begin{enumerate}
        \item $\ZZ_p \cong \varprojlim \ZZ / p^n \ZZ$.
        \item Every element of $x \in \QQ_p$ can be written uniquely as a Laurent series $x = \sum_{i=n}^\infty a_i p^i$ where $n \in \ZZ$ and $a_i \in \{0, \ldots, p - 1\}$
    \end{enumerate}
\end{corollary}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Let $f_n : \ZZ \to \ZZ_p / p^n \ZZ_p$ be the natural map. We have
            \begin{equation*}
                \ker{f_n} = \{x \in \ZZ \mid \abs{x}_p \le p^{-n}\} = p^n \ZZ
            \end{equation*}
            $f_n$ is surjective: Let $\overline{c} \in \ZZ_p / p^n \ZZ_p$, and let $c \in \ZZ_p$ be a lift. Since $\ZZ$ is dense in $\ZZ_p$, there is\footnote{recall that closed balls are open, and $x \in \ZZ$ iff $x \in \overline{B}(c, p^{-n})$} an $x \in \ZZ$ such that $x \in c + p^n \ZZ_p$. Then $f_n(x) = \overline{c}$.

            Thus $f_n$ induces an isomorphism $\tilde{f}_n : \ZZ / p^n \ZZ \to \ZZ_p / p^n \ZZ_p$. Note that the diagram
            \begin{equation*}
            \begin{tikzcd}
                \ZZ/p^{n+1} \ZZ \arrow[r]\arrow[d, "\tilde{f}_{n+1}", "\sim"'] & \ZZ/p^n \ZZ \arrow[d, "\tilde{f}_n", "\sim"']\\
                \ZZ_p/p^{n+1} \ZZ_p \arrow[r] & \ZZ_p/p^n \ZZ_p
            \end{tikzcd}
            \end{equation*}
            commutes. Thus the $\tilde{f}_n$ induce an isomorphism $\varprojlim \ZZ/p^n\ZZ \cong \varprojlim \ZZ_p/p^n\ZZ_p$.

            On the other hand, \autoref{prop:3_5} implies that $\ZZ_p \cong \varprojlim \ZZ_p / p^n \ZZ_p$, so we are done.

        \item This follows from \autoref{cor:3_6}, using $\ZZ_p / p \ZZ_p \cong \FF_p$.\qedhere
    \end{enumerate}
\end{proof}

\section{Complete Valued Fields}

\subsection{Hensel's Lemma}

\begin{theorem}[Hensel's Lemma Version 1]\label{thm:4_1}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(X) \in \cO_K[X]$ and assume that there is an $a \in \cO_K$ such that $\abs{f(a)} < \abs{f'(a)}^2$. Then there exists a unique $x \in \cO_K$ such that $f(x) = 0$ and $\abs{x - a} < \abs{f'(a)}$.
\end{theorem}
\begin{proof}
    Let $v$ be a normalised valuation and let $\pi \in \cO_K$ be a uniformiser. Let $r = v(f'(a))$. We shall construct a sequence $(x_n)_{n=1}^\infty$ in $\cO_K$ such that
    \begin{enumerate}
        \item $f(x_n) \equiv 0 \pmod{\pi^{n + 2r}}$.
        \item $x_{n+1} \equiv x_n \pmod{\pi^{n+r}}$.
    \end{enumerate}
    Take $x_1 = a$, then\footnote{$\abs{f(a)} < \abs{f'(a)}^2$ implies $v(f(a)) > 2v(f'(a)) = 2r$, so $v(f(x_1)) \ge 1 + 2r$} $f(x_1) \equiv 0 \pmod{\pi^{1+2r}}$.

    Now suppose we have constructed $x_1, \ldots, x_n$ satisfying (i) and (ii). Define $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$. We first verify (ii): Since $x_n \equiv x_1 \pmod{\pi^{r+1}}$, we have\footnote{since $f'(x_n) \equiv f'(x_1) \pmod{\pi^{r+1}}$} $v(f'(x_n)) = r$. Hence $\frac{f(x_n)}{f'(x_n)} \equiv 0 \pmod{\pi^{n+r}}$ by (i). Thus (ii) holds.

    Note that for indeterminates $X, Y$, $f(X + Y) = f_0(X) + f_1(X) Y + f_2(X) Y^2 + \ldots$ for some $f_i \in \cO_K[X]$, and $f_0(X) = f(X)$, $f_1(X) = f'(X)$. Then
    \begin{equation*}
        f(x_{n+1}) = f(x_n) + f'(x_n) c + \underbrace{f_2(x_n) c^2 + \ldots}_{\in \pi^{n + 2r + 1} \cO_K}
    \end{equation*}
    where $c = -\frac{f(x_n)}{f'(x_n)}$. Thus
    \begin{equation*}
        f(x_{n+1}) \equiv f(x_n) + f'(x_n) c \equiv 0 \pmod{\pi^{n + 2r + 1}}
    \end{equation*}

    Now (ii) implies that $(x_n)$ is Cauchy, say it converges to $x \in \cO_K$. Then $f(x) = \lim_{n \to \infty} f(x_n) = 0$ by (i). Moreover, (ii) implies that $a = x_1 \equiv x_n \pmod{\pi^{r+1}}$ for all $n$, so $x \equiv a \pmod{\pi^{r+1}}$, which implies that $\abs{x - a} < \abs{f'(a)}$. This completes the existence part of the proof.

    For uniqueness, suppose that $x'$ also satisfies $f(x') = 0$ and $\abs{x' - a} < \abs{f'(a)}$, but $x' \neq x$. Let $\delta = x' - x \neq 0$. Then $\abs{x' - a}, \abs{x - a} < \abs{f'(a)}$ so by the ultrametric inequality, $\abs{\delta} = \abs{x' - x} < \abs{f'(a)}$. However,
    \begin{equation*}
        0 = f(x') = f(x + \delta) = \underbrace{f(x)}_{0} + f'(x) \delta + \underbrace{(\ldots)\delta^2}_{\abs{\cdot} \le \abs{\delta}^2}
    \end{equation*}
    so $\abs{f'(x) \delta} \le \abs{\delta}^2$, and\footnote{as $a \equiv x \pmod{\pi^{r+1}}$, $0 \not\equiv f'(a) \equiv f'(x) \pmod{\pi^{r+1}}$} $\abs{f'(a)} = \abs{f'(x)} \le \abs{\delta}$, which gives a contradiction.
\end{proof}

\begin{remark}
    The proof above uses the iteration $x_{n=1} = x_n - \frac{f(x_n)}{f'(x_n)}$. This is the non-archimedean analogue of the Newton-Raphson method.
\end{remark}

\begin{corollary}\label{cor:4_2}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, $f(X) \in \cO[X]$, and let $\overline{c} \in k = \cO_K / \fm$ be a simple root of $\overline{f}(X) = f(X) \pmod{\fm}$ in $k[X]$. Then there is a unique $x \in \cO_K$ such that $f(x) = 0$ and $x \equiv \overline{c} \pmod{\fm}$.
\end{corollary}
\begin{proof}
    Apply \autoref{thm:4_1} to a lift $c \in \cO_K$ of $\overline{c}$. Then $\abs{f(c)} < 1 = \abs{f'(c)}^2$ since $\overline{c}$ is a simple root.
\end{proof}

\begin{example}
    $f(X) = X^2 - 2$ has a simple root mod $7$. Thus $\sqrt{2} \in \ZZ_7$.
\end{example}

\begin{corollary}\label{cor:4_3}
    \begin{equation*}
        \QQ_p^\times / (\QQ_p^\times)^2 \cong
        \begin{cases}
            (\ZZ / 2 \ZZ)^2 & \text{if } p > 2\\
            (\ZZ / 2 \ZZ)^3 & \text{if } p = 2
        \end{cases}
    \end{equation*}
\end{corollary}
\begin{proof}
    Case $p > 2$: Let $b \in \ZZ_p^\times$. Applying \autoref{cor:4_2} to $f(X) = X^2 - b$, we find that $b \in (\ZZ_p^\times)^2$ iff $\overline{b} \in (\FF_p^\times)^2$. Thus we have an isomorphism $\ZZ_p^\times / (\ZZ_p^\times)^2 \cong \FF_p^\times / (\FF_p^\times)^2 \cong \ZZ / 2\ZZ$.

    We have an isomorphism $\ZZ_p^\times \times \ZZ \xrightarrow{\sim} \QQ_p^\times$ given by $(u, n) \mapsto u p^n$, so $\QQ_p^\times / (\QQ_p)^2 \cong \ZZ_p^\times / (\ZZ_p^\times)^2 \times \ZZ / 2\ZZ \cong (\ZZ / 2\ZZ)^2$

    Case $p = 2$: Let $b \in \ZZ_2^\times$. Consider $f(X) = X^2 - b$. We have $f'(X) = 2X \equiv 0 \pmod{2}$.

    Suppose that $b \equiv 1 \pmod{8}$. Then
    \begin{equation*}
        \abs{f(1)}_2 \le 2^{-3} < 2^{-2} = \abs{f'(1)}_2^2
    \end{equation*}
    Hensel's lemma implies that $f(X)$ has a root in $\ZZ_2$, so $b \in (\ZZ_2^\times)^2$. Conversely if $b \in (\ZZ_2^\times)^2$, then $b \pmod{8} \in ((\ZZ / 8\ZZ)^\times)^2 = \{1\}$. Thus $b \in (\ZZ_2^\times)^2$ iff $b \equiv 1 \pmod{8}$. Thus we have an isomorphism $\ZZ_2^\times / (\ZZ_2^\times)^2 \cong (\ZZ / 8 \ZZ)^\times \cong (\ZZ / 2\ZZ)^2$. We can conclude using the isomorphism $\ZZ_2^\times \times \ZZ \cong \QQ_2^\times$ as in the previous case.
\end{proof}

\begin{theorem}[Hensel's Lemma Version 2]\label{thm:4_4}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, and $f(X) \in \cO_K[X]$. Suppose $\overline{f}(X) = f(X) \pmod{\fm}$ in $k[X]$ factorises as $\overline{f}(X) = \overline{g}(X) \overline{h}(X)$ in $k[X]$ with $\overline{g}(X)$ and $\overline{h}(X)$ coprime. Then there is a factorisation $f(X) = g(X) h(X)$ in $\cO_K[X]$ with $\overline{g}(X) \equiv g(X) \pmod{\fm}$, $\overline{h}(X) \equiv h(X) \pmod{\fm}$, and $\deg{g} = \deg{\overline{g}}$.
\end{theorem}
\begin{proof}
    See Example Sheet 1.
\end{proof}

\begin{corollary}\label{cor:4_5}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(X) = a_n X^n + \ldots + a_0 \in K[X]$, with $a_0, \ldots, a_n \neq 0$. If $f(X)$ is irreducible, then $\abs{a_i} \le \max\{\abs{a_0}, \abs{a_n}\}$ for all $i$.
\end{corollary}

\begin{proof}
    Upon scaling, we may assume that $f(X) \in \cO_K[X]$, with $\max_i \abs{a_i} = 1$. We need to show that $\max \{\abs{a_0}, \abs{a_n}\} = 1$. If not, let $r$ be minimal such that $\abs{a_r} = 1$. Then $0 < r < n$. Reducing mod $\fm$,
    \begin{equation*}
        \overline{f}(X) = X^r (a_n X^{n-r} + \ldots + a_r) \pmod{\fm}
    \end{equation*}
    Then \autoref{thm:4_4} implies that $f(X) = g(X) h(X)$ for some $g(X), h(X) \in \cO_K$ with $0 < \deg{g} = r < n$, contradicting irreduciblity of $f$.
\end{proof}

\subsection{Teichm\"uller Lifts}

\begin{definition}
    A ring $R$ of characteristic $p > 0$ ($p$ prime) is a \emph{perfect ring} if the Frobenius map $x \mapsto x^p$ is a bijection. A field of characteristic $p$ is a \emph{perfect field} if it is perfect as a ring.
\end{definition}

\begin{remark}
    Since $\Char R = p$, $(x+y)^p = x^p + y^p$, so the Frobenius map is a ring homomorphism.
\end{remark}

\begin{example}\phantom{}
    \begin{enumerate}
        \item $\FF_{p^n}, \overline{\FF}_p$ are perfect fields.
        \item $\FF_p[t]$ is not perfect, since $t$ does not lie in the image of the Frobenius map.
        \item $\FF_p(t^\frac{1}{p^n}) = \FF_p(t, t^\frac{1}{p}, t^\frac{1}{p^2}, \ldots)$ is a perfect field (it is the \emph{perfection} of $\FF_p(t)$).
    \end{enumerate}
\end{example}

\begin{fact}
    A field $k$ of characteristic $p > 0$ is perfect iff any finite extension of $k$ is separable.
\end{fact}

\begin{theorem}\label{thm:5_2}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field such that $k = \cO_K / \fm$ is a perfect field of characteristic $p$. Then there exists a unique map $[\cdot] : k \to \cO_K$ such that
    \begin{enumerate}
        \item $a \equiv [a] \pmod{m}$
        \item $\forall a, b \in k, [a b] = [a] [b]$
    \end{enumerate}
    Moreover if $\Char K = p$, then $[\cdot]$ is a ring homomorphism.
\end{theorem}

\begin{definition}
    The element $[a] \in \cO_K$ constructed in \autoref{thm:5_2} is called the \emph{Teichm\"uller lift} of $a$.
\end{definition}

\begin{lemma}\label{lem:5_4}
    Let $(K, \abs{\cdot})$ be as in \autoref{thm:5_2}, and fix a uniformiser $\pi \in \cO_K$. Let $x, y \in \cO_K$ and $k \ge 1$ be such that $x \equiv y \pmod{\pi^k}$. Then $x^p \equiv y^p \pmod{\pi^{k+1}}$.
\end{lemma}
\begin{proof}
    Write $x = y + u \pi^k$ with $u \in \cO_K$. Then
    \begin{equation*}
        x^p
        = \sum_{i=0}^p \binom{p}{i} y^{p-i} (u \pi^k)^i
        = y^p + \sum_{i=1}^p \binom{p}{i} y^{p-i} (u \pi^k)^i
    \end{equation*}
    Since $\cO_K / \pi \cO_K$ has characteristic $p$, we have $p \in \pi \cO_K$. Thus $\binom{p}{i} y^{p-i} (u \pi^k)^i \in \pi^{k+1} \cO_K$ for $1 \le i \le p$.
\end{proof}

\begin{proof}[Proof of \autoref{thm:5_2}]
    Let $a \in k$. For each $i \ge 0$, we choose a lift $y_i \in \cO_K$ of $a^{\frac{1}{p^i}}$ and we define $x_i = y_i^{p^i}$. We claim that $(x_i)_{i=1}^\infty$ is a Cauchy sequence and its limit $x$ is independent of the choice of $y_i$.

    By construction, $y_i \equiv y_{i+1}^p \pmod{\pi}$. By \autoref{lem:5_4} and induction, $y_i^{p^r} \equiv y_{i+1}^{p^{r+1}} \pmod{\pi^{r+1}}$ for any $r \ge 0$. By taking $r = i$, we see that $x_i \equiv x_{i+1} \pmod{\pi^i}$. Thus $(x_i)$ is Cauchy, hence $x_i \to x$ for some $x \in \cO_K$.

    Suppose that $(x'_i)$ arises from another choice of $y'_i$ lifting $a^\frac{1}{p^i}$. Then $x'_i$ is Cauchy, and $x'_i \to x' \in \cO_K$. Define
    \begin{gather*}
        x''_i = \begin{cases}
            x_i & \text{if } i \text{ is even}\\
            x'_i & \text{if } i \text{ is odd}
        \end{cases}\\
        y''_i = \begin{cases}
            y_i & \text{if } i \text{ is even}\\
            y'_i & \text{if } i \text{ is odd}
        \end{cases}
    \end{gather*}
    Then $x''_i$ arises from lifting $y''_i$. As before, $(x''_i)$ is Cauchy, and it converges to both $x$ and $x'$, so $x = x'$. Thus $x$ is independent of $y_i$, so we may define $[a] = x$.

    Now $x_i \equiv y_i^{p^i} \equiv (a^\frac{1}{p^i})^{p^i} \equiv a \pmod{\pi}$. Thus $x \equiv a \pmod{\pi}$, proving (i).

    Let $b \in k$, and choose $u_i \in \cO_K$ a lift of $b^\frac{1}{p^i}$. Let $z_i = u_i^{p^i}$. Then $[b] = \lim_{i \to \infty} z_i$. Now $u_i y_i$ is a lift of $(a b)^\frac{1}{p^i}$, hence
    \begin{equation*}
        [a b] = \lim_{i \to \infty} x_i z_i = \left(\lim_{i \to \infty} x_i\right) \left(\lim_{i \to \infty} z_i\right) = [a] [b]
    \end{equation*}
    so (ii) is satisfied.

    If $\Char K = p$, then $y_i + u_i$ is a lift of $a_i^\frac{1}{p^i} + b_i^\frac{1}{p^i} = (a_i + b_i)^\frac{1}{p^i}$. Then
    \begin{equation*}
        [a + b] = \lim_{i \to \infty}(y_i + u_i)^{p^i} = \lim_{i \to \infty} y_i^{p^i} + u_i^{p^i} = \lim_{i \to \infty} x_i + \lim_{i \to \infty} z_i = [a] + [b]
    \end{equation*}
    It is easy to check that $[0] = 0$ and $[1] = [1]$, so $[\cdot]$ is a ring homomorphism.

    For uniqueness, let $\phi : k \to \cO_K$ be another such map. Then for $a \in k$, $\phi(a^\frac{1}{p^i})$ is a lift of $a^\frac{1}{p^i}$. It follows that
    \begin{equation*}
        [a] = \lim_{i \to \infty} \phi(a^\frac{1}{p^i})^{p^i} = \lim_{i \to \infty} \phi(a) = \phi(a)
    \end{equation*}
    as required.
\end{proof}

\begin{example}
    Take $K = \QQ_p$, then $[\cdot] : \FF_p \to \ZZ_p$. Take $a \in \FF_p^\times$. Then $[a]^{p-1} = [a^{p-1}] = [1] = 1$, so $[a]$ is a $(p-1)$\textsuperscript{th} root of unity.
\end{example}

More generally, we have

\stepcounter{definition} % Numbering issue

\begin{lemma}\label{lem:5_6}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. If $k \subseteq \overline{\FF}_p$, then for $a \in k^\times$, $[a] \in \cO_K^\times$ is a root of unity.
\end{lemma}
\begin{proof}
    $a \in \overline{\FF}_p$ implies that $a \in \FF_{p^n}$ for some $n$. Then $[a]^{p^n-1} = [a^{p^n-1}] = [1] = 1$.
\end{proof}

\begin{theorem}\label{thm:5_7}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field with $\Char K = p > 0$ . Assume that $k$ is perfect, then $K \cong k((t))$
\end{theorem}
\begin{proof}
    Since $K = \Frac{\cO_K}$, it suffices to show that $\cO_K \cong k\llbracket t \rrbracket$ as rings. Fix a uniformiser $\pi \in \cO_K$. Let $[\cdot] : k \to \cO_K$ be the Teichm\"uller lift. Define $\varphi : k\llbracket t \rrbracket \to \cO_K$ by
    \begin{equation*}
        \varphi(\sum_{i=0}^\infty a_i t_i) = \sum_{i=0}^\infty [a_i] \pi^i
    \end{equation*}
    Then $\varphi$ is a ring homomorphism since $[\cdot]$ is and it is a bijection by \autoref{prop:3_5} (ii).
\end{proof}

\subsection{Extensions of Complete Valued Fields}

\begin{theorem}\label{thm:6_1}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, and $L / K$ a finite extension of degree $n$. Then
    \begin{enumerate}
        \item $\abs{\cdot}$ extends uniquely to an absolute value $\abs{\cdot}_L$ defined by $\abs{y}_L = \abs{N_{L/K}(y)}^\frac{1}{n}$ for $y \in L$.
        \item $L$ is complete with respect to $\abs{\cdot}_L$.
    \end{enumerate}
\end{theorem}

\begin{remark}
    Recall if $L / K$ is finite, then $N_{L/K}$ is defined by $N_{L/K}(y) = \det (m_y)$, where $m_y : L \to L$ is the $K$-linear map induced by multiplication by $y$.
\end{remark}

\begin{fact}\phantom{}
    \begin{itemize}
        \item $N_{L/K}(xy) = N_{L/K}(x) N_{L/K}(y)$
        \item Let $X^n + a_{n-1}X^{n-1} + \ldots + a_0 \in K[X]$ be the minimal polynomial of $y \in L$. Then $N_{L/K}(y) = \pm a_0^m$ for some $m \ge 1$. In particular, $N_{L/K}(y) = 0$ iff $x = 0$.
    \end{itemize}
\end{fact}

\begin{definition}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field, $V$ a vector space over $K$. A \emph{norm} on $V$ is a function $\norm{\cdot} : V \to \RR_{\ge 0}$ satisfying
    \begin{enumerate}
        \item $\norm{x} = 0 \iff x = 0$
        \item $\forall x \in V, \forall \lambda \in K, \norm{\lambda x} = \abs{\lambda} \norm{x}$
        \item $\forall x, y \in V, \norm{x + y} \le \max\{\norm{x}, \norm{y}\}$
    \end{enumerate}
\end{definition}

\begin{example}
    If $V$ is finite-dimensional and $e_1, \ldots, e_n$ is a basis of $V$, the \emph{sup norm} $\norm{\cdot}_\mathrm{sup}$ on $V$ is defined by
    \begin{equation*}
        \norm{x}_\mathrm{sup} = \max_i \abs{x_i}
    \end{equation*}
    where $x = \sum_{i=1}^n x_i e_i$.
\end{example}
\begin{exercise}
    Show that $\norm{\cdot}_\mathrm{sup}$ is a norm.
\end{exercise}

\begin{definition}
    Two norms $\norm{\cdot}_1, \norm{\cdot}_2$ are \emph{equivalent} if there are $C, D \in \RR_{>0}$ such that
    \begin{equation*}
        C \norm{x}_1 \le \norm{x}_2 \le D \norm{x}_1
    \end{equation*}
    for all $x \in V$.
\end{definition}
\begin{fact}
    A norm defines a topology on $V$ and equivalent norms induce the same topology.
\end{fact}

\begin{proposition}\label{prop:6_4}
    Let $(K, \abs{\cdot})$ be a complete, non-archimedean valued field, and $V$ a finite-dimensional vector space over $K$. Then $V$ is complete with respect to $\norm{\cdot}_\mathrm{sup}$.
\end{proposition}
\begin{proof}
    Let $e_1, \ldots, e_n$ be the basis for $V$ used to defined $\norm{\cdot}_\mathrm{sup}$. Let $(v_i)_{i=1}^\infty$ be a Cauchy sequence in $V$. Write $v_i = \sum_{j=1}^n x_j^i e_j$. Then $(x_j^i)_{i=1}^\infty$ is a Cauchy sequence in $K$. Let $x_j^i \to x_j \in K$. Then $v_i \to v = \sum_{j=1}^n x_j e_j$.
\end{proof}

\begin{theorem}\label{thm:6_5}
    Let $(K, \abs{\cdot})$ be a complete non-archimedean valued field, and $V$ a finite-dimensional vector space over $K$. Then any two norms on $V$ are equivalent. In particular, $V$ is complete with respect to any norm.
\end{theorem}
\begin{proof}
    Since equivalence defines an equivalence relation on the set of norms, it suffices to show that any norm is equivalent to $\norm{\cdot}_\mathrm{sup}$.

    Let $e_1, \ldots, e_n$ be a basis for $V$ used to define $\norm{\cdot}_\mathrm{sup}$. Set $D = \max_i \norm{e_i}$. Then for $x = \sum_{i=1}^n x_i e_i$, we have $\norm{x} \le \max_i \norm{x_i e_i} = \max_i \abs{x_i} \norm{e_i} \le D \norm{x}_\mathrm{sup}$.

    To find $C$ such that $C \norm{\cdot}_\mathrm{sup} \le \norm{\cdot}$, we induct on $n = \dim{V}$. For $n = 1$, $\norm{x} = \norm{x_1 e_1} = \abs{x_1}\norm{e_1} = \norm{x}_\mathrm{sup} \norm{e_1}$, so we may take $C = \norm{e_1}$. Now suppose $n > 1$. Set $V_i = \langle e_1, \ldots, e_{i-1}, e_{i+1}, \ldots, e_n \rangle$. By induction, $V_i$ is complete with respect to $\norm{\cdot}$, hence is closed. Then $e_i + V_i$ is closed for all $i$, hence $S = \bigcup_{i=1}^n e_i + V_i$ is a closed subset not containing $0$. Thus there is a $C > 0$ such that $B(0, c) \cap S = \emptyset$. Let $x = \sum_{i=1}^n x_i e_i \neq 0$ and let $j$ be such that $\abs{x_j} = \max_i \abs{x_i}$. Then $\norm{x}_\mathrm{sup} = \abs{x_j}$, and $x_j^{-1} x \in S$. Thus $\norm{x_j^{-1} x} \ge C$, which implies that $\norm{x} \ge C \abs{x_j} = C \norm{x}_\mathrm{sup}$.

    The completeness of $V$ follows by \autoref{prop:6_4}.
\end{proof}

\begin{proof}[Proof of \autoref{thm:6_1}]
    We show that $\abs{\cdot}_L = \abs{N_{L/K}(\cdot)}^\frac{1}{n}$ satisfies the three axioms in the definition of absolute value:
    \begin{enumerate}
        \item $\abs{y}_L = 0 \iff \abs{N_{L/K}(y)}^\frac{1}{n} = 0 \iff N_{L/K}(y) = 0 \iff y = 0$.
        \item $\abs{y_1 y_2}_L = \abs{N_{L/K}(y_1 y_2)}^\frac{1}{n} = \abs{N_{L/K}(y_1) N_{L/K}(y_2)}^\frac{1}{n} = \abs{N_{L/K}(y_1)}^\frac{1}{n} \abs{N_{L/K}(y_2)}^\frac{1}{n} = \abs{y_1}_L \abs{y_2}_L$.
    \end{enumerate}
    For (iii), we need a proposition:
    \renewcommand*{\qedsymbol}{}
\end{proof}

\begin{definition}\phantom{}
    \begin{itemize}
        \item Let $R$ be a subring of $S$. We say $s \in S$ is \emph{integral over $R$} if there exists a monic polynomial $f(X) \in R[X]$ such that $f(s) = 0$.
        \item The \emph{integral closure} $R^{\Int(S)}$ of $R$ in $S$ is defined to be
            \begin{equation*}
                R^{\Int(S)} = \{s \in S \mid s \text{ is integral over } R\}
            \end{equation*}
        \item We say $R$ is \emph{integrally closed in $S$} if $R^{\Int(S)} = R$.
    \end{itemize}
\end{definition}

\begin{proposition}\label{prop:6_7}
    $R^{\Int(S)}$ is a subring of $S$. Moreover, $R^{\Int(S)}$ is integrally closed in $S$.
\end{proposition}
\begin{proof}
    See Example Sheet 2.
\end{proof}

\begin{lemma}\label{lem:6_8}
    Let $(K, \abs{\cdot})$ be a non-archimedean valued field. Then $\cO_K$ is integrally closed in $K$.
\end{lemma}
\begin{proof}
    Let $x \in K$ be integral over $\cO_K$. WLOG $x \neq 0$. Let $f(X) = X^n + a_{n-1} + \ldots + a_0 \in \cO_K$  be such that $f(x) = 0$. Then $x = -a_{n-1} - \ldots - \frac{a_0}{x^{n-1}}$. If $\abs{x} > 1$, then $\abs{-a_{n-1} - \ldots - \frac{a_0}{x^{n-1}}} \le 1$, contradiction. Thus $\abs{x} \le 1$, so $x \in \cO_K$.
\end{proof}

\begin{proof}[Proof of \autoref{thm:6_1} (continued)]
    Set $\cO_L = \{y \in L \mid \abs{y}_L \le 1\}$. We claim that $\cO_L$ is the integral closure of $\cO_K$ in $L$, which will be proved in \autoref{lem:6_9}. Assuming this, we shall prove (iii). Let $x, y \in L$. WLOG assume that $\abs{x}_L \le \abs{y}_L$. Then $\abs{\frac{x}{y}}_L \le 1$, so $\frac{x}{y} \in \cO_L$. Since $1 \in \cO_L$ and $\cO_L$ is a ring by our claim, $1 + \frac{x}{y} \in \cO_L$. Thus $\abs{1 + \frac{x}{y}}_L \le 1$, so $\abs{x + y}_L \le \abs{y}_L = \max \{\abs{x}_L, \abs{y}_L\}$ as required.
    \renewcommand*{\qedsymbol}{}
\end{proof}

\begin{lemma}\label{lem:6_9}
    $\cO_L$ is the integral closure of $\cO_K$ in $L$.
\end{lemma}
\begin{proof}
    Let $0 \neq y \in L$. Let $f(X) = X^d + a_{d-1} X^{d-1} + \ldots + a_0 \in K[X]$ be the minimal polynomial of $y$. We claim that $y$ is integral over $\cO_K$ iff $f(X) \in \cO_K[X]$.

    \noindent ($\Leftarrow$) Clear.

    \noindent ($\Rightarrow$) Let $g(X) \in \cO_K[X]$ be a monic polynomial such that $g(y) = 0$. Then $f \mid g$, so every root of $f$ is a root of $g$. Thus every root of $f$ (in $\overline{K}$) is integral over $\cO_K$, so the $a_i$'s are integral over $\cO_K$, since they are elementary symmetric polynomials in the roots. Thus $a_i \in \cO_K$ by \autoref{lem:6_8}.

    By \autoref{cor:4_5}, $\abs{a_i} \le \max\{\abs{a_0}, 1\}$ for $0 \le i \le d - 1$. Recall that $N_{L/K}(y) = \pm a_0^m$ for some $m$. Hence we have
    \begin{align*}
        y \in \cO_L
        &\iff \abs{N_{L/K}(y)} \le 1\\
        &\iff \abs{a_0} \le 1\\
        &\iff \forall 0 \le i \le d - 1, \abs{a_i} \le 1\\
        &\iff \forall 0 \le i \le d - 1, a_i \in \cO_K\\
        &\iff y \text{ is integral over } \cO_K
    \end{align*}
    which completes the proof.
\end{proof}

\begin{proof}[Proof of \autoref{thm:6_1} (continued)]
    We have already shown that $\abs{x}_L$ defines an absolute value on $L$. Since $N_{L/K}(x) = x^n$ for $x \in K$, $\abs{\cdot}_L$ indeed extends $\abs{\cdot}$ on $K$.

    For uniqueness, suppose that $\abs{\cdot}'_L$ is another absolute value on $L$ extending $\abs{\cdot}$. Then $\abs{\cdot}_L$ and $\abs{\cdot}'_L$ are norms on $L$, so \autoref{thm:6_5} implies that they induce the same topology on $L$. Thus by \autoref{prop:1_3}, there is a $c \in \RR_{>0}$ such that $\abs{\cdot}'_L = \abs{\cdot}_L^c$. Since $\abs{\cdot}'_L$ extends $\abs{\cdot}$ on $K$, we have $c = 1$.

    By \autoref{thm:6_5}, $L$ is complete with respect to $\abs{\cdot}_L$.
\end{proof}

\begin{corollary}\label{cor:6_10}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $L / K$ be a finite extension. Then
    \begin{enumerate}
        \item $L$ is discretely valued with respect to $\abs{\cdot}_L$.
        \item $\cO_L$ is the integral closure of $\cO_K$ in $L$.
    \end{enumerate}
\end{corollary}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Let $v$ be a valuation on $K$ and $v_L$ be a valuation on $L$ such that $v_L$ extends $v$. Let $n = [L : K]$. For $y \in L^\times$, we have $\abs{y}_L = \abs{N_{L/K}(y)}^\frac{1}{n}$, so $v_L(y) = \frac{1}{n} v(N_{L/K}(y))$. Thus $v_L(L^\times) \subseteq \frac{1}{n} v(K^\times)$. It follows that $v_L$ is discrete.

        \item This is \autoref{lem:6_9}.\qedhere
    \end{enumerate}
\end{proof}

\begin{corollary}\label{cor:6_11}
    Let $\overline{K}$ be the algebraic closure of $K$. Then $\abs{\cdot}$ extends to a unique absolute value $\abs{\cdot}_{\overline{K}}$ on $\overline{K}$.
\end{corollary}
\begin{proof}
    Let $x \in \overline{K}$. Then $x \in L$ for some finite extension $L/K$. Define $\abs{x}_{\overline{K}} = \abs{x}_L$. This is well-defined, since the absolute value is independent of $L$ by the uniqueness assertion in \autoref{thm:6_1}. The axioms for $\abs{\cdot}_{\overline{K}}$ to be an absolute value can be checked over finite extensions.

    The uniqueness of $\abs{\cdot}_{\overline{K}}$ is clear.
\end{proof}

\begin{remark}
    $\abs{\cdot}_{\overline{K}}$ is never discrete. For example, take $K = \QQ_p$, consider $p^\frac{1}{n} \in \overline{\QQ_p}$. Then $v_p(p^\frac{1}{n}) = \frac{1}{n} v_p(p) = \frac{1}{n}$.

    $\overline{\QQ_p}$ is not complete. On Example Sheet 2, we will see that if $\CC_p$ is the completion of $\overline{\QQ_p}$ with respect to $\abs{\cdot}_{\overline{\QQ_p}}$, then $\CC_p$ is algebraically closed.
\end{remark}

\begin{proposition}\label{prop:6_12}
    Let $L/K$ be a finite extension of complete discretely valued fields. Assume that
    \begin{enumerate}
        \item $\cO_K$ is compact
        \item $k_L / k$ is a finite separable extension
    \end{enumerate}
Then there is an $\alpha \in \cO_L$ such that $\cO_L = \cO_K[\alpha]$.
\end{proposition}

\noindent We will soon see (in \autoref{prop:7_2}) that condition (i) implies condition (ii).

\begin{proof}
    Fix a uniformiser $\pi_L \in \cO_L$, and let $v_L$ be the normalised valuation.

    Since $k_L/k$ is finite separable, by the primitive element theorem, there is an $\overline{\alpha} \in k_L$ such that $k_L = k(\overline{\alpha})$. Let $\alpha \in \cO_L$ be a lift of $\overline{\alpha}$, and $g(X) \in \cO_K[X]$ be a monic lift of the minimal polynomial $\overline{g}(X) \in k[X]$ of $\overline{\alpha}$. Then since $\overline{g}$ is irreducible and separable, $\overline{\alpha}$ is a simple root of $\overline{g}$, so $g(\alpha) \equiv 0 \pmod{\pi_L}$, and $g'(\alpha) \not\equiv 0 \pmod{\pi_L}$.

    If $g(\alpha) \equiv 0 \pmod{\pi_L^2}$, then $g(\alpha + \pi_L) \equiv g(\alpha) + \pi_L g'(\alpha) \equiv \pi_L g'(\alpha) \pmod{\pi_L^2}$. Thus $v_L(g(\alpha + \pi_L)) = v_L(\pi_L g'(\alpha)) = 1$. Thus either $v_L(g(\alpha)) = 1$ or $v_L(g(\alpha + \pi_L)) = 1$. Upon possibly replacing $\alpha$ by $\alpha + \pi_L$, we may assume that $v_L(g(\alpha)) = 1$.

    Set $\beta = g(\alpha) \in \cO_K[\alpha]$, which is a uniformiser. Let $n = [K(\alpha) : K]$ and define $\varphi : \cO_K^n \to L$ by $\varphi(x_0, \ldots, x_{n-1}) = \sum_{i=0}^{n-1} x_i \alpha^i$. $\cO_K[\alpha]$ is the image\footnote{the minimal polynomial of $\alpha$ over $K$ has degree $n$ and coefficients in $\cO_K$ by the proof of \autoref{lem:6_9}} of $\cO_K^n$ under the continuous map $\varphi$. Since $\cO_K$ is compact, so is $\cO_K[\alpha]$, hence $\cO_K[\alpha]$ is closed in $L$.

    Since $k_L = k(\overline{\alpha})$, $\cO_K[\alpha]$ contains a set of coset representatives for $k_L = \cO_L / \pi_L \cO_L = \cO_L / \beta \cO_L$. Let $y \in \cO_L$. By \autoref{prop:3_5}, $y = \sum_{i=0}^\infty \lambda_i \beta^i$ for some $\lambda_i \in \cO_K[\alpha]$. If we let $y_m = \sum_{i=0}^m \lambda_i \beta^i \in \cO_K[\alpha]$, then we see that $y_m \to y$, so $y \in \cO_K[\alpha]$ since $\cO_K[\alpha]$ is closed.
\end{proof}

\section{Local Fields}

\subsection{Local Fields}

\begin{definition}
    Let $(K, \abs{\cdot})$ be a valued field. $K$ is a \emph{local field} if it is complete and locally compact\footnote{every point has a compact neighbourhood}.
\end{definition}

\begin{example}
    $\RR$ and $\CC$ are local fields.
\end{example}

\begin{proposition}\label{prop:7_2}
    Let $(K, \abs{\cdot})$ be a non-archimedean complete valued field. The following are equivalent:
    \begin{enumerate}
        \item $K$ is locally compact
        \item $\cO_K$ is compact
        \item $v$ is discrete and $k = \cO_K / \fm$ is finite.
    \end{enumerate}
\end{proposition}
\begin{proof}
    (i) $\Rightarrow$ (ii): Let $U$ be a compact neighbourhood of $0$. Then there is a non-zero $x \in \cO_K$ such that $x \cO_K \subseteq U$. Since $x \cO_K$ is closed, it is compact, so $\cO_K$ is also compact, since multiplying by $x^{-1}$ gives a homeomorphism $x \cO_K \to \cO_K$.

    \noindent (ii) $\Rightarrow$ (i): For $a \in K$, $a + \cO_K$ is a compact neighbourhood of $a$.

    \noindent (ii) $\Rightarrow$ (iii): Let $x \in \fm$ and $A_x$ be a set of coset representatives for $\cO_K / x \cO_K$. Then $\cO_K = \bigcup_{y \in A_x} y + x \cO_K$ is a disjoint open cover. Thus $A_x$ is finite by compactness, and so $\cO_K / x \cO_K$ is finite. It follows that $k$ is finite, since we have a surjection $\cO_K / x \cO_K \to k$.

    Suppose that $v$ is not discrete. Let $x = x_1, x_2, \ldots$ be such that $v(x_1) > v(x_2) > \ldots$. Then $x \cO_K = x_1 \cO_K \subsetneq x_2 \cO_K \subsetneq \ldots \subsetneq \cO_K$. This contradicts the fact that $\cO_K / x \cO_K$ is finite.

    \noindent (iii) $\Rightarrow$ (ii): Since $\cO_K$ is a metric space, it suffices to show that $\cO_K$ is sequentially compact. Let $(x_n)_{n=1}^\infty$ be a sequence in $\cO_K$ and let $\pi \in \cO_K$ be a uniformiser. Since $\pi^i \cO_K / \pi^{i+1} \cO_K \cong k$, we have that $\cO_K / \pi^i \cO_K$ is finite for all $i$.

    Since $\cO_K/\pi \cO_K$ is finite, there is an $a_1 \in \cO_K/\pi \cO_K$ and a subsequence $(x_{1,n})_{n=1}^\infty$ of $(x_n)_{n=1}^\infty$ such that $x_{1,n} \equiv a_1 \pmod{\pi}$ for all $n$.

    Since $\cO_K/\pi^2 \cO_K$ is finite, there is an $a_2 \in \cO_K/\pi^2 \cO_K$ and a subsequence $(x_{2,n})_{n=1}^\infty$ of $(x_{1,n})_{n=1}^\infty$ such that $x_{2,n} \equiv a_2 \pmod{\pi}$ for all $n$.

    Continuing in this fashion, we obtain sequences $(x_{in})_{n=1}^\infty$ for $i \ge 1$ such that
    \begin{enumerate}
        \item $(x_{i+1, n})_{n=1}^\infty$ is a subsequence of $(x_{i, n})_{n=1}^\infty$
        \item For any $i$, there is an $a_i \in \cO_K / \pi^i \cO_K$ such that for all $n \ge 1$, we have $x_{i,n} \equiv a_i \pmod{\pi^i}$.
    \end{enumerate}
    Necessary $a_i \equiv a_{i+1} \pmod{\pi^i}$. Now define $y_i = x_{i,i}$. This defines a subsequence of $(x_n)_{n=1}^\infty$. Moreover, $y_i \equiv a_i \equiv a_{i+1} \equiv y_{i+1} \pmod{\pi^i}$. Thus $y_i$ converges by \autoref{prop:1_6}.
\end{proof}

\begin{example}
    $\QQ_p$ and $\FF_p((t))$ are local fields.
\end{example}

\subsubsection*{More on Inverse Limits}
Let $(A_n)_{n=1}^\infty$ be a sequence of sets/groups/rings and $\varphi_n : A_{n+1} \to A_n$ homomorphisms.

\begin{definition}
    Assume that the $A_n$ are finite. The \emph{profinite topology} on $A = \varprojlim A_n$ is the weakest topology on $A$ such that $A \to A_n$ is continuous for all $n$, where $A_n$ is equipped with the discrete topology.
\end{definition}

\begin{fact}
    $A = \varprojlim A_n$ with the profinite topology is compact, totally disconnected\footnote{the connected components are 1-point sets}, and Hausdorff.
\end{fact}

\begin{proposition}\label{prop:7_4}
    Let $K$ be a non-archimedean local field with uniformiser $\pi$. Under the isomorphism
    \begin{equation*}
        \cO_K \cong \varprojlim \cO_K / \pi^n \cO_K
    \end{equation*}
    given by \autoref{prop:3_5}, the topology on $\cO_K$ coincides with the profinite topology.
\end{proposition}
\begin{proof}
    We check that $\mathcal{B} = \{a + \pi^n\cO_K \mid n \ge 1, a \in \cO_K\}$ is a basis of open sets for both topologies. Note that $\mathcal{B}$ indeed defines a basis. For the topology given by $\abs{\cdot}$, this is clear. For the profinite topology, note that $\cO_K \to \cO_K \pi^n \cO_K$ is continuous iff $a + \pi^n \cO_K$ is open for all $a \in \cO_K$.
\end{proof}

\begin{lemma}\label{lem:7_5}
    Let $K$ be a non-archimedean local field, and let $L/K$ be a finite extension. Then $L$ is a local field.
\end{lemma}
\begin{proof}
    \autoref{thm:6_1} and \autoref{cor:6_10} implies that $L$ is complete and discretely valued. By \autoref{prop:7_2}, it suffices to show that $k_L = \cO_L / \fm_L$ is finite.

    Let $\alpha_1, \ldots, \alpha_n$ be a basis for $L$ as a $K$-vector space. By \autoref{thm:6_5}, $\norm{\cdot}_\mathrm{sup}$ (with respect to the basis) is equivalent to $\abs{\cdot}_L$ as norms. Thus there is an $r > 0$ such that $\cO_L \subseteq \{x \in L \mid \norm{x}_\mathrm{sup} \le r\}$. Take $a \in K$ such that $\abs{a} > r$, then $\cO_L \subseteq \bigoplus_{i=1}^n a \alpha_i \cO_K$. Since $\cO_K$ is Noetherian by \autoref{lem:2_6}, and $\bigoplus_{i=1}^n a \alpha_i \cO_K$ is a finitely generated $\cO_K$-module, it is Noetherian. Thus $\cO_L$ is finitely generated as an $\cO_K$-module, so $k_L$ is finitely generated as a $k$-module. Since $k$ is finite by \autoref{prop:7_2}, it follows that $k_L$ is finite.
\end{proof}

\stepcounter{definition} % Numbering issue

\begin{definition}
    A non-archimedean valued field $(K, \abs{\cdot})$ is said to have \emph{equal characteristic} if $\Char{K} = \Char{k}$, otherwise it has \emph{mixed characteristic}.
\end{definition}

\begin{example}
    $\QQ_p$ has mixed characteristic, while $\FF_p((t))$ has equal characteristic.
\end{example}

\begin{theorem}\label{thm:7_8}
    Let $K$ be a local field of equal characteristic $p > 0$. Then $K \cong \FF_{p^n}((t))$ for some $n \ge 1$.
\end{theorem}
\begin{proof}
    $K$ is complete, discretely valued, and $k$ is finite by \autoref{prop:7_2}. Hence $k \cong \FF_{p^n}$ for some $n$, which is perfect. By \autoref{thm:5_7}, $K \cong \FF_{p^n}((t))$.
\end{proof}

\begin{lemma}\label{lem:7_9}
    An absolute value $\abs{\cdot}$ on a field $K$ is non-archimedean iff $\abs{\cdot}$ is bounded on $\ZZ$.
\end{lemma}
\begin{proof}
    ($\Rightarrow$) Since $\abs{-n} = \abs{n}$, it suffices to show that $\abs{n}$ is bounded for $n \ge 1$. Indeed $\abs{n} = \abs{1 + \ldots + 1} \le \abs{1} = 1$.

    \noindent ($\Leftarrow$) Suppose that there is a $B$ such that $\abs{n} \le B$ for all $n \in \ZZ$. Let $x, y \in K$ be such that $\abs{x} \le \abs{y}$. Then for $m \ge 0$,
    \begin{align*}
        \abs{x + y}^m
        &= \abs{\sum_{i=0}^m \binom{m}{i} x^i y^{m-i}}\\
        &\le \sum_{i=0}^m \abs{\binom{m}{i} x^i y^{m-i}}\\
        &\le \abs{y}^m B (m+1)
    \end{align*}
    Taking $m$\textsuperscript{th} roots, $\abs{x + y} \le \abs{y} (B (m + 1))^\frac{1}{m}$. Taking $m \to \infty$, we get $\abs{x + y} \le \abs{y}$.
\end{proof}

\begin{theorem}[Ostrowski's Theorem]\label{thm:7_10}
    Any non-trivial absolute value on $\QQ$ is equivalent to either the usual absolute value $\abs{\cdot}_\infty$ or the $p$-adic absolute value $\abs{\cdot}_p$ for some prime $p$.
\end{theorem}
\begin{proof}
    \underline{Case 1:} $\abs{\cdot}$ is archimedean.
    By \autoref{lem:7_9}, there is a integer $b > 1$ such that $\abs{b} > 1$. Let $a > 1$ be an integer and write $b^n$ in base $a$:
    \begin{equation*}
        b^n = c_m a^m + c_{m-1} + a^{m-1} + \ldots + c
    \end{equation*}
    where $0 \le c_i < a$ and $c_m \neq 0$. Let $B = \max_{0 \le c < a} \abs{c}$, then we have
    \begin{equation*}
        \abs{b}^n \le (m + 1) B \max \{\abs{a}^m, 1\}
    \end{equation*}
    Since $m \le n \log_a{b}$,
    \begin{equation*}
        \abs{b} \le \left[(n \log_a{b} + 1) B \right]^{\frac{1}{n}} \max \{\abs{a}^{\log_a{b}}, 1\}
    \end{equation*}
    Taking $n \to \infty$, we see that $\abs{b} \le \max \{\abs{a}^{\log_a{b}}, 1\}$, so $\abs{a} > 1$, and $\abs{b} \le \abs{a}^{\log_a{b}}$. Thus we may switch the roles of $a$ and $b$ to obtain $\abs{a} \le \abs{b}^{\log_b{a}}$. Thus
    \begin{equation*}
        \frac{\log{\abs{a}}}{\log{a}} = \frac{\log{\abs{b}}}{\log{b}}
    \end{equation*}
    for any $a, b > 1$. Let $\lambda > 0$ be this common value. Then for $a \in \ZZ_{>1}$, $\abs{a} = a^\lambda$, and it follows that for any $x \in \QQ$, $\abs{x} = \abs{x}_\infty^\lambda$, i.e. $\abs{\cdot}$ is equivalent to $\abs{\cdot}_\infty$.

    \underline{Case 2:} $\abs{\cdot}$ is non-archimedean. As in \autoref{lem:7_9}, we have $\abs{n} \le 1$ for all $n \in \ZZ$. Since $\abs{\cdot}$ is non-trivial, there is an $n > 1$ such that $\abs{n} < 1$. Then $\abs{p} < 1$ for some prime $p$ dividing $n$. Suppose that $\abs{q} < 1$ for some other prime $q \neq p$. Then $rp + sq = 1$ for some $r, s \in \ZZ$. Thus $1 = \abs{rp + sq} \le \max\{\abs{rp}, \abs{sq}\} < 1$, contradiction. Thus $\abs{\cdot}$ is equivalent to $\abs{\cdot}_p$.
\end{proof}

\begin{theorem}\label{thm:7_11}
    Let $(K, \abs{\cdot})$ be a non-archimedean local field of mixed characteristic. Then $K$ is a finite extension of $\QQ_p$ for some prime $p$.
\end{theorem}
\begin{proof}
    Since $K$ is mixed characteristic, $\Char{K} = 0$, so $\QQ \subseteq K$. Since $(K, \abs{\cdot})$ is non-archimedean, so is $(\QQ, \abs{\cdot} \vert_\QQ)$ by \autoref{lem:7_9}. Thus $\abs{\cdot} \vert_\QQ$ is equivalent to $\abs{\cdot}_p$ for some prime $p$. Since $K$ is complete, $\QQ_p \subseteq K$.

    To show that $K / \QQ_p$ is finite, it suffices to show that $\cO_K$ is finite as a $\ZZ_p$-module\footnote{the generators of $\cO_K$ as a $\ZZ_p$-module span generate $K$ as a $\QQ$-vector space}. Let $\pi \in \cO_K$ be a uniformiser, $v$ the normalised valuation on $K$, and set $e = v(p)$. Then $\cO_K / p \cO_K = \cO_K / \pi^e \cO_K$ is finite, since $\pi^i \cO_K / \pi^{i+1} \cO_K \cong \cO_K / \pi \cO_K$ is finite. Via the map $\FF_p \cong \ZZ_p / p \ZZ_p \to \cO_K / p \cO_K$, $\cO_K / p \cO_K$ is a finite-dimensional $\FF_p$-vector space. Let $x_1, \ldots, x_n \in \cO_K$ be coset representatives for a $\FF_p$-basis of $\cO_K / p \cO_K$. Then $\{\sum_{j=1}^n a_j x_j \mid a_j \in \{0, \ldots, p-1\}\}$ is a set of coset representatives for $\cO_K / p \cO_K$.

    Let $y \in \cO_K$. By \autoref{prop:3_5} (ii), there are $a_{ij} \in \{0, \ldots, p-1\}$ such that
    \begin{align*}
        y
        &= \sum_{i=0}^\infty \left(\sum_{j=1}^n a_{ij} x_j\right) p^i\\
        &= \sum_{j=1}^n \underbrace{\left(\sum_{i=0}^\infty a_{ij} p^i\right)}_{\in \ZZ_p} x_j
    \end{align*}
    Thus $\cO_K$ is generated by $x_1, \ldots, x_n$ is a $\ZZ_p$-module.
\end{proof}

On Example Sheet 2, we will show that if $K$ is a complete archimedean field, then $K \cong \RR$ or $\CC$. To summarise, if $K$ is a local field, then
\begin{enumerate}
    \item if $K$ is archimedean, then $K \cong \RR, \CC$
    \item if $K$ is non-archimedean of equal characteristic, then $K \cong \FF_{p^n}((t))$ for some prime $p$ and integer $n \ge 1$
    \item if $K$ is non-archimedean of mixed characteristic, then $K$ is a finite extension of $\QQ_p$ for some prime $p$.
\end{enumerate}

\subsection{Global Fields}

\begin{definition}
    A \emph{global field} is a field which is either
    \begin{enumerate}
        \item an algebraic number field
        \item a global function field, i.e. a finite extension of $\FF_p(t)$
    \end{enumerate}
\end{definition}

\begin{lemma}\label{lem:8_2}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, and $L/K$ a finite Galois extension with absolute value $\abs{\cdot}_L$ extending $\abs{\cdot}$. Then for $x \in L$ and $\sigma \in \Gal(L/K)$, $\abs{\sigma(x)}_L = \abs{x}_L$.
\end{lemma}
\begin{proof}
    The map $x \mapsto \abs{\sigma(x)}_L$ is another absolute value in $L$ extending $K$. The result follows from \autoref{thm:6_1}.
\end{proof}

\begin{lemma}[Krasner's Lemma]\label{lem:8_3}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field. Let $f(X) \in K[X]$ be a separable irreducible polynomial with roots $\alpha_1, \ldots, \alpha_n \in \overline{K}$. Suppose that $\beta \in \overline{K}$ is such that $\abs{\beta - \alpha_1} < \abs{\beta - \alpha_i}$ for $2 \le i \le n$. Then $K(\alpha_1) \subset K(\beta)$.
\end{lemma}
\begin{proof}
    Let $L = K(\beta)$, $L' = L(\alpha_1, \ldots, \alpha_n)$. Let $\sigma \in \Gal(L' / L)$. By \autoref{lem:8_2}, we have $\abs{\beta - \sigma(\alpha_1)} = \abs{\sigma(\beta - \alpha_1)} = \abs{\beta - \alpha_1}$. Thus $\sigma(\alpha_1) = \alpha_1$, so $\alpha_1 \in L = K(\beta)$.
\end{proof}

\begin{proposition}\label{prop:8_4}
    Let $(K, \abs{\cdot})$ be a complete discretely valued field, and let $f(X) = \sum_{i=0}^n a_i X^i \in \cO_K[X]$ be a separable irreducible monic polynomial. Let $\alpha \in \overline{K}$ be a root of $f$. Then there is an $\varepsilon > 0$ such that for any monic polynomial $g(X) = \sum_{i=0}^n b_i X^i \in \cO_K[X]$ with $\abs{a_i - b_i} < \varepsilon$, there exists a root $\beta$ of $g(X)$ such that $K(\alpha) = K(\beta)$.
\end{proposition}
\begin{proof}
    Let $\alpha = \alpha_1, \ldots, \alpha_n$ be the roots of $f$, necessarily distinct. Then $f'(\alpha_1) \neq 0$. By continuity, there is an $\varepsilon > 0$ sufficiently small such that if $\abs{a_i - b_i} < \varepsilon$, then $\abs{g(\alpha_1)} < \abs{f'(\alpha_1)}^2$ and $\abs{f'(\alpha_1) - g'(\alpha_1)} < \abs{f'(\alpha)}$. Then by \autoref{lem:1_5}, we have $\abs{g(\alpha_1)} < \abs{f'(\alpha_1)}^2 = \abs{g'(\alpha_1)}^2$. By \autoref{thm:4_1} applied to the field $K(\alpha_1)$, there exists $\beta \in K(\alpha_1)$ such that $g(\beta) = 0$ and $\abs{\beta - \alpha_1} < \abs{g'(\alpha_1)}$. We have
    \begin{equation*}
        \abs{g'(\alpha_1)} = \abs{f'(\alpha_1)} = \prod_{i=2}^n \abs{\alpha_1 - \alpha_i} \le \abs{\alpha_1 - \alpha_i}
    \end{equation*}
    for each $2 \le i \le n$, since $\abs{\alpha_1 - \alpha_i} \le 1$ by \autoref{lem:6_8}. Since $\abs{\beta - \alpha_1} < \abs{\alpha_1 - \alpha_1} = \abs{\beta - \alpha_i}$. By \autoref{lem:8_3}, $\alpha \in K(\beta)$, so $K(\beta) = K(\alpha_1)$.
\end{proof}

\begin{theorem}\label{thm:8_5}
    Let $K$ be a local field. Then $K$ is the completion of a global field.
\end{theorem}
\begin{proof}
    \underline{Case 1:} $K$ is archimedean. In this case $K \cong \RR$ or $\CC$. $\RR$ and $\CC$ are the completions of $\QQ$ and $\QQ(i)$ respectively with respect to $\abs{\cdot}_\infty$.

    \underline{Case 2:} $K$ is non-archimedean of equal characteristic. In this case $K \cong \FF_q((t))$, so $K$ is the completion of $\FF_q(t)$ with respect to the $t$-adic absolute value.

    \underline{Case 3:} $K$ is non-archimedean of mixed characteristic. In this case $K$ is a finite extension of $\QQ_p$. By the primitive element theorem, $K = \QQ_p(\alpha)$, for some $\alpha \in K$. By normalising, we can take $\alpha$ to be a root of a monic irreducible polynomial with coefficients in $\ZZ_p$. Since $\ZZ$ is dense in $\ZZ_p$, by \autoref{prop:8_4}, there is a monic polynomial $g(X) \in \ZZ[X]$ and a root $\beta \in K$ of $g(X)$ such that $K = \QQ_p(\alpha) = \QQ_p(\beta)$. Since $\QQ(\beta)$ is dense in $\QQ_p(\beta) = K$, $K$ is the completion of $\QQ(\beta)$.
\end{proof}

\section{Dedekind Domains}

\subsection{Dedekind Domains}

\begin{definition}
    A \emph{Dedekind domain} is a ring $R$ such that
    \begin{enumerate}
        \item $R$ is a Noetherian integral domain
        \item $R$ is integrally closed in $\Frac(R)$
        \item Every non-zero prime ideal is maximal
    \end{enumerate}
\end{definition}

\begin{example}\phantom{}
    \begin{enumerate}
        \item The ring of integers in a number field is a Dedekind domain.
        \item Any PID (hence DVR) is a Dedekind domain.
    \end{enumerate}
\end{example}

\begin{theorem}\label{thm:9_2}
    A ring $R$ is a DVR if and only if $R$ is a Dedekind domain with exactly one non-zero prime ideal.
\end{theorem}

\begin{lemma}\label{lem:9_3}
    Let $R$ be a Noetherian ring and $I \subseteq R$ be a non-zero ideal. Then there exists non-zero prime ideals $\fp_1, \ldots, \fp_r \subseteq I$ such that $\fp_1 \ldots \fp_r \subseteq I$.
\end{lemma}
\begin{proof}
    Suppose otherwise. Since $R$ is Noetherian, we may choose $I$ maximal with this property. Then $I$ is not prime, so there are $x, y \in R \setminus I$ such that $xy \in I$. Let $I_1 = I + (x)$ and $I_2 = I + (y)$. By maximality of $I$, there are non-zero prime ideals $\fp_1, \ldots, \fp_r, \fq_1, \ldots, \fq_s$ such that $\fp_1 \ldots \fp_r \subseteq I_1$ and $\fq_1 \ldots \fq_s \subseteq I_2$. Then $\fp_1 \ldots \fp_r \fq_1 \ldots \fq_s \subseteq I_1 I_2 \subseteq I$.
\end{proof}

\begin{lemma}\label{lem:9_4}
    Let $R$ be an integrally closed integral domain, $I \subseteq R$ a non-zero finitely generated ideal, and $x \in K$. If $x I \subseteq I$, then $x \in R$.
\end{lemma}
\begin{proof}
    Let $I = \langle c_1, \ldots, c_n \rangle$. Then there are $a_{ij} \in R$ such that
    \begin{equation*}
        x c_i = \sum_{j=1}^\infty a_{ij} c_j
    \end{equation*}
    Let $A$ be the matrix $(a_{ij})$ and set $B = x I - A$. Let $\Adj(B)$ denote the adjugate matrix for $B$. Then multiplying the equality $B (c_1, \ldots, c_n)^t = 0$ on the left by $\Adj(B)$, we get $(\det{B}) (c_1, \ldots, c_n)^t = 0$. Since some $c_i$ is non-zero, we have $\det(B) = 0$, which gives an integral relation for $x$.
\end{proof}

\begin{proof}[Proof of \autoref{thm:9_2}]\phantom{}\\
    \noindent ($\Rightarrow$) Clear.

    \noindent ($\Leftarrow$) We need to show that $R$ is a PID. The assumption implies that $R$ is a local ring with unique maximal ideal $\fm$.

    \noindent \underline{Step 1:} $\fm$ is principal.

    Let $0 \neq x \in \fm$. By \autoref{lem:9_3}, $(x) \supseteq \fm^n$ for some $n \ge 1$. Let $n$ be minimal such that $(x) \supseteq \fm^n$. Then there is some $y \in \fm^{n-1} \setminus (x)$. Set $\pi = x / y$. Then $y \fm \subseteq \fm^n \subseteq (x)$, so $\pi^{-1} \fm \subseteq R$. If $\pi^{-1} \fm \neq R$, then $\pi^{-1} \in R$ by \autoref{lem:9_4}, so $y \in (x)$, contradiction.

    \noindent \underline{Step 2:} $R$ is a PID.

    Let $I \subseteq R$ be a non-zero ideal. Consider the sequence of fractional ideals $I \subseteq \pi^{-1} I \subseteq \pi^{-2} I \subseteq \ldots$ in $K$. Since $\pi^{-1} \notin R$, $\pi^{-k} I \neq \pi^{-(k+1)} I$ by \autoref{lem:9_4}. Since $R$ is Noetherian, we may choose $n$ maximal such that $\pi^{-n} \subseteq R$. If $\pi^{-n} I \neq R$, then $\pi^{-n} I \subseteq \fm = (\pi)$, so $\pi^{-(n+1)} I \subseteq R$, contradiction.

    Thus $\pi^{-n} I = R$, so $I = (\pi^n)$.
\end{proof}

Let $R$ be an integral domain and $S \subseteq R$ be a multiplicatively closed subset, i.e. $x, y \in S \implies xy \in S$, $1 \in S$, and $0 \notin S$.

The \emph{localisation} $S^{-1}R$ of $R$ with respect to $S$ is the ring $S^{-1} R = \{r/s \mid r \in R, s \in S\} \subseteq \Frac(R)$.

If $\fp$ is a prime ideal of $R$, we write $R_{(\fp)}$ for the localisation with respect to $S = R \setminus \fp$.

\begin{example}\phantom{}
    \begin{itemize}
        \item If $\fp = (0)$, then $R_{(\fp)} = \Frac(R)$
        \item If $R = \ZZ$, then $\ZZ_{(p)} = \{a / b \mid a \in \ZZ, (b, p) = 1\}$.
    \end{itemize}
\end{example}

\begin{fact}\phantom{}
    \begin{itemize}
        \item If $R$ is Noetherian, then so is $S^{-1}R$.
        \item There is a bijection

            \begin{tabular}{ccc}
                $\{\text{prime ideals in } S^{-1}R\}$ & $\longleftrightarrow$ & $\{\text{prime ideals } \fp \subseteq R \text{ such that } \fp \cap S = \emptyset\}$\\
                $\fp S^{-1}R$ & $\mapsfrom$ & $\fp$
            \end{tabular}
    \end{itemize}
\end{fact}

\begin{corollary}\label{cor:9_5}
    Let $R$ be a Dedekind domain, $\fp \subseteq R$ be a non-zero prime ideal. Then $R_{(\fp)}$ is a DVR.
\end{corollary}
\begin{proof}
    By the properties of localisation, $R_{(\fp)}$ is a Noetherian integral domain with unique non-zero prime ideal $\fp R_{(\fp)}$. By \autoref{thm:9_2}, it suffices to show that $R_{(\fp)}$ is integrally closed in $\Frac(R_{(\fp)}) = \Frac(R)$.

    Let $x \in \Frac(R)$ be integral over $R_{(\fp)}$. Clearing denominators in the integral relation satisfied by $x$, we obtain
    \begin{equation*}
        s x^n + a_{n-1} x^{n-1} + \ldots + a_0 = 0
    \end{equation*}
    for some $a_i \in R$ and $s \in S = R \setminus \fp$. Multiplying by $s^{n-1}$, we see that $xs$ is integral over $R$, so $xs \in R$, $x \in R_{(\fp)}$ as required.
\end{proof}

\begin{definition}
    If $R$ is a Dedekind domain, $\fp \subseteq R$ a non-zero prime ideal, then we write $v_p$ for the normalised valuation on $\Frac(R) = \Frac(R_{(\fp)})$ corresponding to the DVR $R_{(\fp)}$.
\end{definition}

\begin{example}
    If $R = \ZZ$, $\fp = (p)$, then $v_p$ is the $p$-adic valuation.
\end{example}

\begin{theorem}\label{thm:9_7}
    Let $R$ be a Dedekind domain. Then every non-zero ideal in $I \subseteq R$ can be uniquely written as a product of prime ideals
    \begin{equation*}
        I = \fp_1^{e_1} \ldots \fp_r^{e_1}
    \end{equation*}
    where $\fp$ are distinct primes, and $e_i > 0$.
\end{theorem}
\begin{proof}
    We quote the following properties of localisation:
    \begin{enumerate}
        \item $I = J \iff I R_{(\fp)} = J R_{(\fp)}$ for all prime ideals $\fp$.
        \item If $R$ is a Dedekind domain and $\fp_1, \fp_2$ are non-zero prime ideals, then
            \begin{equation*}
                \fp_1 R_{(\fp_2)} =
                \begin{cases}
                    R_{(\fp_2)} &\text{if } \fp_1 \neq \fp_2\\
                    \fp_2 R_{(\fp_2)} &\text{if } \fp_1 = \fp_2
                \end{cases}
            \end{equation*}
    \end{enumerate}

    Let $I \subseteq R$ be a non-zero ideal. Then by \autoref{lem:9_3}, there are distinct prime ideals $\fp_1, \ldots, \fp_r$ and $\beta_i > 0$ such that $\fp_1^{\beta_1} \ldots \fp_r^{\beta_r} \subseteq I$. Let $\fp$ be a non-zero prime ideal with $\fp \neq \fp_i$ for each $i$. Then (ii) implies that $\fp_i R_{(\fp)} = R_{(\fp)}$, so $I R_{(\fp)} = R_{(\fp)}$. By \autoref{cor:9_5}, $I R_{(\fp_i)} = \fp_i^{\alpha_i} R_{(\fp_i)}$ for some $0 \le \alpha_i \le \beta_i$. Thus $I = \fp_1^{\alpha_1} \ldots \fp_r^{\alpha_r}$ by (i).

    For uniqueness, suppose that $I = \fp_1^{\alpha_1} \ldots \fp_r^{\alpha_r} = \fp_1^{\gamma_1} \ldots \fp_r^{\gamma_r}$. Then $\fp_i^{\alpha_i} R_{(\fp_i)} = \fp_i^{\gamma_i} R_{(\fp_i)}$, so $\alpha_i = \gamma_i$ by unique factorisation in DVRs.
\end{proof}

\subsection{Extensions of Dedekind Domains}

Let $L / K$ be a finite extension. For $x \in L$, we write $\Tr_{L/K}(x) \in K$ for the trace of the $K$-linear map $y \mapsto x y$. If $L/K$ is separable of degree $n$, let $\sigma_1, \ldots, \sigma_n : L \to \overline{K}$ denote the set of distinct embeddings of $L/K$ into an algebraic closure $\overline{K}$. Then
\begin{equation*}
    \Tr_{L/K}(x) = \sum_{i=1}^n \sigma_i(x)
\end{equation*}

\begin{lemma}\label{lem:10_1}
    Let $L / K$ be a finite separable extension of fields. Then the symmetric bilinear pairing $(\cdot, \cdot) : L \times L \to K$ defined by $(x, y) = \Tr_{L/K}(xy)$ is non-degenerate.
\end{lemma}
\begin{proof}
    Since $L/K$ is separable, $L = K(\alpha)$ for some $\alpha \in L$. Consider the matrix $A$ of $(\cdot, \cdot)$ with respect to the basis $1, \alpha, \ldots, \alpha^{n-1}$. We have
    \begin{equation*}
        A_{ij} = Tr_{L/K}(\alpha^{i+j}) = [B B^t]_{ij}
    \end{equation*}
    where $B_{ij} = \sigma_j(\alpha^i)$.

    Then $\det(A) = \det(B)^2 = \prod_{1 \le i < j \le n} (\sigma_i(\alpha) - \sigma_j(\alpha))^2 \neq 0$, since $\sigma_i(\alpha) \neq \sigma_j(\alpha)$ for $i \neq j$ by separability.
\end{proof}

On Exercise Sheet 3 we will see that a finite extension $L/K$ is separable iff the trace form is non-degenerate.

\begin{theorem}\label{thm:10_2}
    Let $\cO_K$ be a Dedekind domain and $L$ a finite separable extension of $K = \Frac(\cO_K)$. Then the integral closure $\cO_L$ of $\cO_K$ in $L$ is also a Dedekind domain.
\end{theorem}
\begin{proof}
    Since $\cO_L$ is a subring of $L$, $\cO_L$ is an integral domain. We need to show that
    \begin{enumerate}
        \item $\cO_L$ is Noetherian,
        \item $\cO_L$ is integrally closed in $L$,
        \item Every non-zero prime ideal $\cP$ in $\cO_L$ is maximal.
    \end{enumerate}

    \begin{enumerate}
        \item Let $e_1, \ldots, e_n \in L$ be a $K$-basis for $L$. Upon rescaling by $K$, we may assume that $e_i \in \cO_L$ for all $i$. Let $f_1, \ldots, f_n$ be the dual basis for $e_1, \ldots, e_n$ with respect to the trace form $(\cdot, \cdot)$, i.e. $(e_i, f_j) = \delta_{ij}$.

            Let $x \in \cO_L$ and write $x = \sum_{i=1}^n \lambda_i f_i$, with $\lambda_i \in K$. Then $\lambda_i = \Tr_{L/K}(x e_i) \in \cO_K$. Thus $\cO_L \subseteq \cO_K f_1 + \ldots \cO_K f_n$, which is a finitely generated $\cO_K$-module. Since $\cO_K$ is Noetherian, it follows that $\cO_L$ is a finitely generated $\cO_K$-module, hence Noetherian.

        \item This is an exercise on Example Sheet 2.

        \item Let $\cP$ be a non-zero prime ideal in $\cO_L$. Let $\fp = \cP \cap \cO_K$, which is a prime in $\cO_K$. Let $0 \neq x \in \cP$ Then $x$ satisfies an equation of the form $x^n + a_{n-1}x^{n-1} + \ldots + a_0 = 0$, with $a_i \in \cO_K$ and $a_0 \neq 0$. Thus $a_0 \in \fp$, so $\fp \neq 0$ hence is maximal.

            We have an inclusion $\cO_K / \fp \hookrightarrow \cO_L / \cP$ that makes $\cO_L / \cP$ a finite-dimensional\footnote{recall that $\cO_L$ is a finitely generated $\cO_K$-module} vector space over $\cO_K / \fp$. Since $\cO_L / \cP$ is an integral domain, it is a field\footnote{for $0 \neq z \in \cO_L / \cP$, the map $y \mapsto z y$ is injective hence an isomorphism by rank-nullity}. Thus $\cP$ is maximal. \qedhere
    \end{enumerate}
\end{proof}

\begin{remark}
    \autoref{thm:10_2} holds without the assumption that $L / K$ is separable.
\end{remark}

\begin{corollary}\label{cor:10_3}
    The ring of integers of a number field is a Dedekind domain.
\end{corollary}

As a convention, if $\cO_K$ is the ring of integers of a number field $K$, and $\fp \subseteq \cO_K$ is a non-zero prime ideal, we normalise $\abs{\cdot}_\fp$ by $\abs{x}_\fp = N_\fp^{-v_\fp(x)}$, where $N_\fp = \abs{\cO_K / \fp}$. Note that $N_\fp$ is finite. We can see this from the proof of \autoref{thm:10_2}: Let $\fp \cap \ZZ = (p)$. Then $\cO_K / \fp$ is a finite-dimensional vector space over $\FF_p$.

Also if $K = \QQ$, $\cO_K = \ZZ$, $\fp = (p)$, then $N_\fp = p$, so the convention is consistent with the $p$-adic valuation defined previously.

For the remaining of this section, let $\cO_K$ be a Dedekind domain, $K = \Frac{\cO_K}$, $L / K$ a finite separable extension, $\cO_L$ the integral closure of $\cO_K$ in $L$, which is a Dedekind domain by \autoref{thm:10_2}.

\begin{lemma}\label{lem:10_4}
    Let $0 \neq x \in \cO_K$. Then
    \begin{equation*}
        (x) = \prod_{\fp \neq 0} \fp^{v_\fp(x)}
    \end{equation*}
\end{lemma}
\begin{proof}
    By definition of $v_\fp(x)$, $x \cO_{K(p)} = \fp^{v_\fp(x)} \cO_{K(\fp)}$. The lemma follows by the properties of localisation: $I = J \iff \forall \text{ prime ideals } \fp, I \cO_{K(p)} = J \cO_{K(p)}$.
\end{proof}

Let $\cP \subseteq \cO_L$ and $\fp \subseteq \cO_K$ be non-zero prime ideals. We write $\cP \mid \fp$ if $\cP$ is one of the primes occurring in the prime factorisation of $\fp \cO_L$, i.e. if $\fp \cO_L = \cP_1^{e_1} \ldots \cP_r^{e_r}$ where $e_i > 0$ and $\cP = \cP_i$ for some $i$.

\begin{theorem}\label{thm:10_5}
    For a non-zero prime ideal $\fp \subseteq \cO_K$, write $\fp \cO_L = \cP_1^{e_1} \ldots \cP_r^{e_r}$, where $e_i > 0$. Then the absolute values on $L$ extending $\abs{\cdot}_\fp$ are precisely $\abs{\cdot}_{\cP_1}, \ldots, \abs{\cdot}_{\cP_r}$ (up to equivalence).
\end{theorem}
\begin{proof}
    By \autoref{lem:10_4}, for any $0 \neq x \in \cO_K$ and $1 \le i \le r$, we have $v_{\cP_i}(x) = e_i v_\fp(x)$. Hence up to equivalence, $\abs{\cdot}_{\cP_i}$ extends $\abs{\cdot}_\fp$.

    Now suppose $\abs{\cdot}$ is an absolute value on $L$ extending $\abs{\cdot}_\fp$. Then $\abs{\cdot}$ is non-archimedean since $\abs{\cdot}_\fp$ is, by \autoref{lem:7_9}. Let $R = \{x \in L \mid \abs{x} \le 1\}$ be the valuation ring for $\abs{\cdot}$. Then $\cO_K \subseteq R$ as $\abs{\cdot}$ extends $\abs{\cdot}_\fp$. Since $R$ is integrally closed in $L$ by \autoref{lem:6_8}, we have $\cO_L \subseteq R$. Set $\cP = \{x \in \cO_L \mid \abs{x} < 1\} = \cO_L \cap \fm_R$, where $\fm_R \subseteq R$ is the maximal ideal. Then $\cP$ is a prime ideal of $\cO_L$, non-zero since $\fp \subseteq \cP$. Then $\cO_{L(\cP)} \subseteq R$, since $s \in \cO_L \setminus \cP$ implies $\abs{s} = 1$. Since $\cO_{L(\cP)}$ is a DVR, it is a maximal subring of $L = \Frac(\cO_{L(\cP)})$. Thus $\cO_{L(\cP)} = R$. Thus $\abs{\cdot}$ is equivalent to $\abs{\cdot}_\cP$, since by \autoref{prop:1_3}, the absolute values are determined by their valuation rings. Finally, note that $\fp \subseteq \cP$ implies that $\cP$ is one of the $\cP_i$.
\end{proof}

Let $K$ be a number field. If $\sigma : K \to \RR, \CC$ is a real or complex embedding, then $\abs{x}_\sigma = \abs{\sigma(x)}_\infty$ defines an absolute value on $K$.

\begin{corollary}\label{cor:10_6}
    Let $K$ be a number field with ring of integers $\cO_K$. Then any absolute value on $K$ is equivalent to
    \begin{enumerate}
        \item $\abs{\cdot}_\fp$ for some non-zero prime ideal $\fp \subseteq \cO_K$
        \item $\abs{\cdot}_\sigma$ for some $\sigma : K \to \RR$ or $\CC$.
    \end{enumerate}
\end{corollary}
\begin{proof}
    \underline{Case 1:} $\abs{\cdot}$ is non-archimedean. By \autoref{thm:7_10}, $\abs{\cdot} \vert_\QQ$ is equivalent to $\abs{\cdot}_p$ for some prime $p$. By \autoref{thm:10_5}, $\abs{\cdot}$ is equivalent to $\abs{\cdot}_\fp$ for some prime $\fp \mid (p)$.

    \underline{Case 2:} $\abs{\cdot}$ is archimedean. See Example Sheet 2.
\end{proof}

\subsection*{Completions}

Let $\fp \subseteq \cO_K$ and $\cP \subseteq \cO_L$ be non-zero prime ideals with $\cP \mid \fp$. Write $K_\fp$ and $L_\cP$ for the completions of $K$ and $L$ with respect to the absolute values $\abs{\cdot}_\fp$ and $\abs{\cdot}_\cP$ respectively.

Note that the inclusions $K \subseteq L \subseteq L_\cP$ induce an inclusion $K_\fp \subseteq L_\cP$, since $\abs{\cdot}_\cP \vert_K$ is equivalent to $\abs{\cdot}_\fp$.

\begin{lemma}\label{lem:10_7}\phantom{}
    \begin{enumerate}
        \item The natural map $\pi_\cP : L \otimes_K K_\fp \to L_\cP$ is surjective,
        \item $[L_\cP : K_\fp] \le [L : K]$
    \end{enumerate}
\end{lemma}
\begin{proof}
    Let $M = L K_\fp \subseteq L_\cP$. Write $L = K(\alpha)$. Then $M = K_\fp(\alpha)$. Hence $M$ is a finite extension of $K_\fp$ and $[M : K_\fp] \le [L : K]$. Moreover $M$ is complete by \autoref{thm:6_1}, and $L \subseteq M \subseteq L_\cP$, so $M = L_\cP$.
\end{proof}

\begin{lemma}[Chinese Remainder Theorem]\label{lem:10_8}
    Let $R$ be a ring and $I_1, \ldots, I_n$ be ideals of $R$ such that $I_i + I_j = R$ for $i \neq j$. Then
    \begin{enumerate}
        \item $\bigcap_{i=1}^n I_i = \prod_{i=1}^n I_i$
        \item $R / I \cong \prod_{i=1}^n R/I_i$, where $I$ is the ideal in (i).
    \end{enumerate}
\end{lemma}
\begin{proof}
    See Example Sheet 2.
\end{proof}

\begin{theorem}\label{thm:10_9}
    The natural map $L \otimes_K K_\fp \to \prod_{\cP \mid \fp} L_\cP$ is an isomorphism.
\end{theorem}
\begin{proof}
    Write $L = K(\alpha)$ and let $f(X) \in K[X]$ be the minimal polynomial of $\alpha$. Factorize $f$ as $f = f_1 \ldots f_r$ in $K_\fp[X]$, where $f_i \in K_\fp[X]$ are irreducible, distinct by separability. Since $L \cong K[X] / (f(X))$, we have
    \begin{equation*}
        L \otimes_K K_\fp \cong K_\fp[X]/(f(X)) \cong \prod_{i=1}^r K_\fp[X]/(f_i(X))
    \end{equation*}
    where the last isomorphism follows from \autoref{lem:10_8}. Set $L_i = K_\fp[X] / (f_i(X))$, which is a finite extension of $K_\fp$. $L_i$ contains $L$, since we have an inclusion $L \cong K[X] / (f(X)) \to K_\fp[X] / (f_i(X)) = L_i$. Also $L$ is dense in $L_i$, since $K$ is dense in $K_\fp$. The theorem follows from the following three claims:
    \begin{enumerate}
        \item $L_i \cong L_\cP$ for some prime $\cP \mid \fp$,
        \item Each $\cP$ appears at most once
        \item Each $\cP$ appears at least once
    \end{enumerate}
    Proof of claims:
    \begin{enumerate}
        \item Since $L_i/K_\fp$ is a finite extension, there is a unique absolute value on $L_i$ extending $\abs{\cdot}_\fp$ by \autoref{thm:6_1}. By \autoref{thm:10_5}, $\abs{\cdot} \vert_L$ is equivalent to $\abs{\cdot} \vert_\cP$ for some $\cP \mid \fp$. Since $L$ is dense in $L_i$ and $L_i$ is complete, we have $L_i \cong L_\cP$.
        \item Suppose $\phi_i : L_i \xrightarrow{\sim} L_j$ is an isomorphism preserving $L$ and $K_\fp$. Then $\varphi : K_\fp[X] / f_i(X) \to K_\fp[X] / f_j(X)$ takes $X$ to $X$, so $f_i = f_j$, and $i = j$.
        \item By \autoref{lem:10_7}, the natural map $\pi_\cP : L \otimes_K K_\fp \to L_\cP$ is surjective for any $\cP \mid \fp$. Since $L_\cP$ is a field, $\pi_\cP$ factors through $L_i$ for some $i$, and hence $L_i \cong L_\cP$ by surjectivity. \qedhere
    \end{enumerate}
\end{proof}

\begin{remark}
    From the proof above, we see that if $L = K(\alpha)$, $f(X) \in K[X]$ is the minimal polynomial of $\alpha$, $f = f_1 \ldots f_r$ the factorisation of $f$ in $K_\fp[X]$, then each $f_i$ corresponds to a prime $\cP_i \mid \fp$. Thus $r$ is the number of $\cP$ dividing $\fp$. Also $\deg f_i = [L_{\cP_i} : K_\fp] = e_{\cP_i/\fp} f_{\cP_i/\fp}$ (see \autoref{cor:11_6} below).
\end{remark}

\begin{example}
    Let $K = \QQ$, $L = \QQ(i)$, $f(X) = X^2 + 1$, $\fp = (5)$, $K_\fp = \QQ_5$. By Hensel's lemma, $\sqrt{-1} \in \QQ_5$. Thus $f(X) = (X - \sqrt{-1})(X + \sqrt{-1})$ in $\QQ_5[X]$. Thus by the remark above, $5$ splits in $\QQ(i)$ as $(5) = \fp_1 \fp_2$.
\end{example}

\begin{corollary}\label{cor:10_10}
    For a fixed non-zero prime $\fp$ of $\cO_K$, we have for $x \in L$ that
    \begin{equation*}
        N_{L/K}(x) = \prod_{\cP \mid \fp} N_{L_\cP/K_\fp}(x)
    \end{equation*}
\end{corollary}
\begin{proof}
    Let $B_1, \ldots, B_r$ be bases for $L_{\cP_1}, \ldots, L_{\cP_r}$ as $K_\fp$-vector spaces, where $\cP_i$ are the primes dividing $\fp$. Then $B = \cup B_i$ is a basis for $L \otimes K_\fp$ over $K_\fp$ by \autoref{thm:10_9}. Let $[\mathrm{mult}(x)]_B$ and $[\mathrm{mult}(x)]_{B_i}$ denote the matrices for $\mult(x) : L \otimes K_\fp \to L \otimes K_\fp$ with respect to the basis $B$ and $\mult(x) : L_{\cP_i} \to L_{\cP_i}$ with respect to the basis $B_i$ respectively. Then $[\mult(x)]_B$ is a block-diagonal matrix with blocks $[\mult(x)]_{B_i}$. Thus taking determinants, $N_{L/K}(x) = \det [\mult(x)]_B = \prod_{i=1}^r \det [\mult(x)]_{B_i} = \prod_{i=1}^r N_{L_{\cP_i} / K_\fp}(x)$.\footnote{The first equality follows since if $v_1, \ldots, v_n$ is a basis for $L$ as a $K$-vector space, then $v_1 \otimes 1, \ldots v_n \otimes 1$ is a basis for $L \otimes_K K_\fp$ as a $K_\fp$-vector space, and multiplying by $x$ gives the same basis in either case.}
\end{proof}

\subsection{Decomposition Groups}
Unless specified otherwise, we let $\cO_K$ be a Dedekind domain, $K = \Frac{\cO_K}$, $L / K$ a finite separable extension, $\cO_L$ the integral closure of $\cO_K$ in $L$, $\fp$ a non-zero prime ideal of $\cO_K$. Suppose that $\fp$ factors as a product of distinct primes $\fp \cO_L = \cP_1^{e_1} \ldots \cP_r^{e_r}$ in $\cO_L$, where $e_i > 0$.

Note that for any $i$, $\fp \subseteq \cO_K \cap \cP_i \subsetneq \cO_K$ so $\fp = \cO_K \cap \cP_i$, since $\fp$ is maximal.

\begin{definition}\phantom{}
    \begin{enumerate}
        \item We call $e_i$ the \emph{ramification index} of $\cP_i$ over $\fp$.
        \item We say that $\fp$ \emph{ramifies} in $L$ if $e_i > 1$ for some $i$.
    \end{enumerate}
\end{definition}

\begin{example}
    Consider $\cO_K = \CC[t], \cO_L = \CC[T]$ and the inclusion $\cO_K \to \cO_L$ given by $t \mapsto T^n$. Then $t \cO_L = T^n \cO_L$, so the ramification index of $(T)$ over $(t)$ is $n$.

    This corresponds geometrically to the degree $n$ covering of Riemann surfaces $\CC \to \CC$ given by $x \mapsto x^n$, which is ramified at $0$ with ramification index $n$.
\end{example}

\begin{definition}
    $f_i = [\cO_L / \cP_i : \cO_K / \fp]$ is the \emph{residue class degree of} $\cP_i$ over $\fp$.
\end{definition}

\begin{theorem}\label{thm:11_3}
    \begin{equation*}
        \sum_{i=1}^r e_i f_i = [L : K]
    \end{equation*}
\end{theorem}
\begin{proof}
    Let $S = \cO_K \setminus \fp$. We shall use the following properties of localisation:
    \begin{enumerate}
        \item $S^{-1} \cO_L$ is the integral closure of $S^{-1} \cO_K$ in $L$,
        \item $(S^{-1} \fp) (S^{-1} \cO_L) \cong S^{-1}(\cP_1^{e_1} \ldots \cP_r^{e_r})$,
        \item $S^{-1} \cO_L / S^{-1} \cP_i \cong \cO_L / \cP_i$, and $S^{-1} \cO_K / S^{-1} \fp \cong \cO_K / \fp$.
    \end{enumerate}
    In particular, (ii) and (iii) imply that $e_i$ and $f_i$ don't change when we replace $\cO_K$ and $\cO_L$ by $S^{-1}\cO_K$ and $S^{-1} \cO_L$.

    Thus we may assume that $\cO_K$ is a DVR (hence a PID). By CRT, we have
    \begin{equation*}
        \cO_L / \fp \cO_L \cong \prod_{i=1}^r \cO_L / \cP_i^{e_i}
    \end{equation*}
    We count the dimensions of both sides as $k = \cO_K / \fp$-vector spaces.

    For the RHS, we have an increasing sequence of $k$-subspaces
    \begin{equation*}
        0 \subseteq \frac{\cP_i^{e_i - 1}}{\cP_i^{e_i}} \subseteq \ldots \subseteq \frac{\cP_i}{\cP_i^{e_i}} \subseteq \frac{\cO_L}{\cP_i^{e_i}}
    \end{equation*}
    Thus $\dim_k \cO_L / \cP_i^{e_i} = \sum_{j=0}^{e_i - 1} \dim_k \cP_i^{j} / \cP_i^{j+1}$. Note that $\cP_i^{j} / \cP_i^{j+1} \cong \cO_L / \cP_i$ as $\cO_L / \cP_i$-modules: let $x \in \cP_i^j \setminus \cP_i^{j+1}$ and define a map $\cO_L \to \cP_i^j / \cP_i^{j+1}$ by $a \mapsto a x$. This is surjective since $\cP_i = x \cO_L + \cP_i^{j+1}$, and has kernel $\cP_i$. Thus $\dim_k \cP_i^j / \cP_i^{j+1} = f_i$, hence $\dim_k \cO_L / \cP_i^{e_i} = e_i f_i$ and $\dim_k \prod_{i=1}^r \cO_L / \cP_i^{e_i} = \sum_{i=1}^{r} e_i f_i$

    For the LHS, the structure theorem for finitely generated modules over PIDs implies that\footnote{since $\cO_L$ is torsion-free, and finitely generated over $\cO_K$ by the proof of \autoref{thm:10_2}} $\cO_L$ is a free $\cO_K$-module of rank $n = [L : K]$. Thus $\cO_L / \fp \cO_L \cong (\cO_K / \fp)^n$ as $\cO_K / \fp$-modules, hence $\dim_K \cO_L / \fp \cO_L = n$.
\end{proof}

Now assume that $L / K$ is Galois. Then for $\sigma \in \Gal(L / K)$, $\sigma(\cP_i) \cap \cO_K = \fp$, and hence $\sigma(\cP_i) \in \{\cP_1, \ldots, \cP_r\}$. Thus $\Gal(L / K)$ acts on $\{\cP_1, \ldots, \cP_r\}$. We can say more:

\begin{proposition}\label{prop:11_4}
    The action of $\Gal(L / K)$ on $\cP_1, \ldots, \cP_r$ is transitive.
\end{proposition}
\begin{proof}
    Suppose that there are $i \neq j$ such that $\sigma(\cP_i) \neq \cP_j$ for any $\sigma \in \Gal(L / K)$. By CRT, there is an $x \in \cO_L$ such that $x \equiv 0 \pmod{\cP_i}$ and $x \equiv 1 \pmod{\sigma(\cP_j)}$ for all $\sigma \in \Gal(L/K)$. Consider
    \begin{equation*}
        N_{L/K}(x) = \prod_{\sigma \in \Gal(L/K)} \sigma(x) \in \cO_K \cap \cP_i = \fp \subseteq \cP_j
    \end{equation*}
    Then $\tau(j) \in \cP_j$ for some $\tau \in \Gal(L/K)$, since $\cP_j$ is prime. Thus $x \in \tau^{-1}(\cP_j)$, i.e. $x \equiv 0 \pmod{\tau^{-1}(\cP_j)}$, contradiction.
\end{proof}

\begin{corollary}\label{cor:11_5}
    Suppose that $L/K$ is Galois. Then $e_1 = \ldots = e_r$ and $f_1 = \ldots = f_r$. Let $e$ and $f$ denote this common value. Then $n = e f r$.
\end{corollary}
\begin{proof}
    Let $1 \le i \le r$ and $\sigma \in \Gal(L/K)$ be such that $\sigma(\cP_1) = \cP_i$. Then considering the factorisation of $\fp \cO_L = \sigma(\fp) \cO_L$ gives $e_1 = e_i$. Also $\sigma$ induces a $\cO_K / \fp$-vector space isomorphism $\cO_L / \cP_1 \cong \cO_L / \cP_i$, so $f_1 = f_i$.
\end{proof}

If $L / K$ is an extension of complete discretely valued fields with normalised valuations $v_L$ and $v_K$ and uniformisers $\pi_L$ and $\pi_K$ respectively, we define the \emph{ramification index} to be $e = e_{L/K} = v_L(\pi_K)$, i.e. such that $\pi_K \cO_L = \pi_L^e \cO_L$, and the \emph{residue class degree} to be $f = f_{L/K} = [k_L : k]$.

\begin{corollary}\label{cor:11_6}
    Let $L/K$ be a finite separable extension of complete discretely valued fields. Then $[L : K] = e f$.
\end{corollary}
\begin{proof}
    This follows from \autoref{thm:11_3} with $r = 1$, since $\cO_K$ is a DVR, hence a Dedekind domain.
\end{proof}

\begin{definition}
    Let $\cO_K$ be a Dedekind domain, $L/K$ a finite Galois extension. Then the \emph{decomposition group} $G_\cP$ at a prime $\cP$ of $\cO_L$ is the stabilizer of $\cP$ under the action of $\Gal(L/K)$, i.e.
    \begin{equation*}
        G_\cP = \{\sigma \in \Gal(L/K) \mid \sigma(\cP) = \cP\}
    \end{equation*}
\end{definition}

\autoref{prop:11_4} implies that for any $\cP, \cP' \mid \fp$, the subgroups $G_\cP$ and $G_{\cP'}$ are conjugate.

\begin{proposition}\label{prop:11_8}
    Suppose $L / K$ is Galois and $\cP \mid \fp$ is a prime of $\cO_L$. Then
    \begin{enumerate}
        \item $L_\cP / K_\fp$ is Galois,
        \item There is a natural map $\res : \Gal(L_\cP / K_\fp) \to \Gal(L / K)$ which is injective and has image $G_\cP$.
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Since $L/K$ is Galois, it is the splitting field of  a separable polynomial $f(X) \in K[X]$. Then $L_\cP / K_\fp$ is the splitting field of $f(X) \in K_\fp[X]$, as the splitting field of $f$ contains $L$ and is complete. Thus $L_\cP / K_\fp$ is Galois as required.

        \item Let $\sigma \in \Gal(L_\cP / K_\fp)$. Since $L / K$ is normal, $\sigma(L) = L$, so we have a map $\res : \Gal(L_\cP / K_\fp) \to \Gal(L / K)$ given by restriction. $\res$ is injective, since $L$ is dense in $L_\cP$, and $\sigma \in \Gal(L_\cP / K_\fp)$ is continuous by \autoref{lem:8_2} say.

            By \autoref{lem:8_2}, for any $\sigma \in \Gal(L_\cP / K_\fp)$, we have $\sigma(\cP) = \cP$, so $\res(\sigma) \in G_\cP$.

            To show surjectivity, it suffices to show that
            \begin{equation*}
                [L_\cP : K_\fp] = e_{L_\cP / K_\fp} f_{L_\cP / K_\fp} = e_{\cP / \fp} f_{\cP / \fp} = \abs{G_\cP}
            \end{equation*}
            The first equality follows from \autoref{cor:11_6}. For the last equality, the orbit-stabilizer theorem with \autoref{prop:11_4} implies that $[G : G_\cP] = r$. Now use \autoref{cor:11_5}. The middle inequality is proven the next lemma. \qedhere
    \end{enumerate}
\end{proof}

\begin{lemma*}
    Ramification indices and residue class degree do not change under completions, i.e.
    \begin{enumerate}
        \item $e_{\cP / \fp} = e_{L_\cP / K_\fp}$,
        \item $f_{\cP / \fp} = f_{L_\cP / K_\fp}$.
    \end{enumerate}
\end{lemma*}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $\pi \in \fp \setminus \fp^2$. Then $e_{\cP / \fp} =v_\cP(x) = e_{L_\cP / K_\fp}$, where the first follows by considering the factorisation of $x \cO_L$, and the second follows since $x$ is a uniformiser of $K_\fp$.

        \item The inclusion $\cO_K \to \cO_{K_\fp}$ induces an inclusion $\cO_K / \fp \to \cO_{K_\fp} / \fp \cO_{K_\fp}$. This is surjective: Let $\overline{c} \in \cO_{K_\fp} / \fp\cO_{K_\fp}$, and let $c \in \cO_{K_\fp}$ be a lift of $\overline{x}$. Since $\cO_K$ is dense in $\cO_{K_\fp}$, there is an $x \in \cO_K$ such that $x \in c + \fp \cO_{K_\fp}$. Thus $x$ maps to $\overline{c}$. We have shown that $\cO_K / \fp \cong \cO_{K_\fp} / \fp \cO_{K_\fp}$. Similarly, $\cO_L / \cP \cong \cO_{L_\cP} / \fp \cO_{L_\cP}$. Thus the ramification indices are the same. \qedhere
    \end{enumerate}
\end{proof}

\section{Ramification Theory}

\subsection{Different and Discriminant}

Let $L / K$ be an extension of algebraic number fields of degree $n$.

\begin{notation}
    For $x_1, \ldots, x_n \in L$, define
    \begin{equation*}
        \Delta(x_1, \ldots, x_n) = \det(\Tr_{x_i x_j}) = \det(\sigma_i(x_j))^2 \in K
    \end{equation*}
    where $\sigma_i : L \to \overline{K}$ are the distinct embeddings of $L/K$ in an algebraic closure.
\end{notation}

\begin{remark}\phantom{}
    \begin{enumerate}
        \item If $y = \sum_{j=1}^n a_{ij}x_j$, where $a_{ij} \in K$, then
            \begin{equation*}
                \Delta(y_1, \ldots, y_n) = \det(A)^2 \Delta(x_1, \ldots, x_n)
            \end{equation*}
        \item If $x_1, \ldots, x_n \in \cO_L$, then $\Delta(x_1, \ldots, x_n) \in \cO_K$.
    \end{enumerate}
\end{remark}

\begin{lemma}\label{lem:12_1}
    Let $k$ be a field and $R$ a finite $k$-algebra. The trace form $(\cdot, \cdot) : R \times R \to k$ defined by
    \begin{equation*}
        (x, y) = \Tr_{R/k}(xy) = \Tr(\mult(xy))
    \end{equation*}
    is non-degenerate iff $R \cong k_1 \times \ldots \times k_n$, where $k_i / k$ are finite separable extensions\footnote{such an $R$ is an \emph{\'etale $k$-algebra}}. In particular if $k$ is perfect, then the trace form is non-degenerate.
\end{lemma}
\begin{proof}
    Suppose $R$ is not reduced. In this case, $R$ is obviously not a product of fields. Let $0 \neq x \in R$ be nilpotent. For any $y \in R$, $xy$ is nilpotent, so $\Tr_{R/k}(xy) = 0$, since the trace of a nilpotent matrix\footnote{the characteristic polynomial of a nilpotent matrix is $X^n$ for some $n$} is $0$.

    Thus we may assume that $R$ is reduced. Then $R$ is Artinian, since $R$ is a finite-dimensional $k$-vector space, and ideals of $R$ are $k$-subspaces. There are only finitely many maximal ideals $\fm_1, \ldots, \fm_n$ in $R$, whose intersection is the nilradical, which in this case is $0$. Then CRT gives an isomorphism $R \cong R/\fm_1 \times \ldots \times R/\fm_n$. Thus $k_i = R / \fm_i$, up to reordering. $(\cdot, \cdot)_{R/k}$ is non-degenerate iff $(\cdot, \cdot)_{k_i/k}$ is non-degenerate for all $i$.

    We are left to show that a finite extension $L/K$ is separable iff the trace form $(\cdot, \cdot)_{L/K}$ is non-degenerate.

    \noindent ($\Rightarrow$) Suppose that $L/K$ is separable. By the primitive element theorem, $L = K(\alpha)$ for some $\alpha \in L$. Consider the matrix of the trace form with respect to the basis $1, \alpha, \ldots, \alpha^{n-1}$, where $n = [L : K]$. We have $\det(\Tr_{L/K}(\alpha^{i+j})) = \det(\sigma_i(\alpha)^j)^2 \neq 0$, where $\sigma_i : L \to \overline{K}$ are the distinct embeddings of $L/K$.

    \noindent ($\Leftarrow$) Suppose that $L/K$ is not separable. Then $\Char K = p > 0$. First assume that $L = K(\alpha)$, where $\alpha \in L$ is a purely inseparable element of degree $p$. $\alpha$ has minimal polynomial $X^p - a$ for some $a \in K$. $L / K$ has basis $1, \alpha, \ldots, \alpha^{p-1}$. We have $\Tr_{L/K}(1) = [L : K] = p = 0$, and for $1 \le i \le p-1$, $\alpha^i$ has minimal polynomial $X^p - a^i$, so $\Tr_{L/K}(\alpha^i) = 0$. This shows that $\Tr_{L/K} = 0$.

    Now in general there is a subextension $L/M/K$ such that $L/M$ is purely inseparable of degree $p$. From the above, $\Tr_{L/M} = 0$, so $\Tr_{L/K} = \Tr_{M/K} \circ \Tr_{L/M} = 0$. Thus the trace form is zero, hence degenerate.
\end{proof}

\begin{theorem}\label{thm:12_2}
    Let $\fp \subseteq \cO_K$ be a non-zero prime ideal.
    \begin{enumerate}
        \item If $\fp$ ramifies in $L$, then for every $x_1, \ldots, x_n \in \cO_L$, we have $\fp \mid \Delta(x_1, \ldots, x_n)$.
        \item If $\fp$ is unramified in $L$, then there are $x_1, \ldots, x_n \in \cO_L$ such that $\fp \nmid \Delta(x_1, \ldots, x_n)$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    Write $\fp \cO_L = \cP_1^{e_1} \ldots \cP_r^{e_r}$, where $\cP_i$ are distinct non-zero prime ideals of $\cO_L$, and $e_i > 0$. Let $R = \cO_L / \fp \cO_L$ and $k = \cO_K / \fp \cO_K$. CRT implies that $R \cong \prod_{i=1}^r \cO_L / \cP_i^{e_i}$.
    \begin{enumerate}
        \item If $\fp$ ramifies in $L$, then $R$ has nilpotents. Thus by \autoref{lem:12_1}, the trace form $(\cdot, \cdot)_{R/k}$ is degenerate. Thus for any $\overline{x_1}, \ldots, \overline{x_n} \in \cO_L / \fp \cO_L$, we have $\Delta(\overline{x_1}, \ldots, \overline{x_n}) = 0$, we can see this by casing on whether $\overline{x_1}, \ldots, \overline{x_n}$ forms a basis of $R$ over $k$. Thus (see lemma below) $\Delta(x_1, \ldots, x_n) \equiv 0 \pmod{\fp}$ for any $x_1, \ldots, x_n \in \cO_L$.

        \item If $\cO_p$ is unramified, then $\cO_L / \fp \cO_L$ is a product of finite extensions of $k$. Thus by \autoref{lem:12_1}, the trace form $(\cdot, \cdot)_{R/k}$ is non-degenerate. Pick $x_1, \ldots, x_n \in \cO_L$ such that $\overline{x_i} \in R$ forms a basis as a $k$-vector space. Then $\Delta(\overline{x_1}, \ldots, \overline{x_n}) \neq 0$. Thus $\Delta(x_1, \ldots, x_n) \not\equiv 0 \pmod{\fp}$. \qedhere
    \end{enumerate}
\end{proof}

\begin{lemma*}
    Let $R$, $k$ be as in the proof of \autoref{thm:12_2} above. Then for $x \in \cO_L$, we have $Tr_{R/k}(\overline{x}) = \overline{Tr_{L/K}(x)}$.
\end{lemma*}
\begin{proof}
    By localizing at $\fp$ (as in the proof of \autoref{thm:11_3}), we may assume that $\cO_K$ is a PID. By the structure theorem for finitely generated modules over PIDs, $\cO_L$ is a free $\cO_K$-module. Let $x_1, \ldots, x_n$ be an $\cO_K$-basis for $\cO_L$. Then $x_1, \ldots, x_n$ is a $K$-basis for $L$, and $\overline{x_1}, \ldots, \overline{x_n}$ is a $k$-basis for $R$. Now it is easy to check that for $x \in \cO_L$, the matrix of $\mult(\overline{x})$ is just the matrix of $\mult(x)$ reduced modulo $\fp$, so the same holds for traces.
\end{proof}

\begin{definition}
    The \emph{discriminant} is the ideal $d_{L / K} \subseteq \cO_K$ given by
    \begin{equation*}
        d_{L/K} = \langle \Delta(x_1, \ldots, x_n) \mid x_1, \ldots, x_n \in \cO_L \rangle
    \end{equation*}
\end{definition}

\begin{remark}
    The discriminant (and later the inverse different and different) although denoted by $d_{L/K}$, depends on $\cO_K$ and $\cO_L$, not just $K$ and $L$.
\end{remark}

\begin{corollary}\label{cor:12_4}
    $\fp$ ramifies in $L$ iff $\fp \mid d_{L/K}$.
\end{corollary}

\begin{definition}
    The \emph{inverse different} is $\cD_{L/K}^{-1} = \{y \in L \mid \forall x \in \cO_L, \Tr_{L/K}(xy) \in \cO_K \}$. It is an $\cO_L$-submodule of $L$ containing $\cO_L$.
\end{definition}

\begin{lemma}\label{lem:12_6}
    $\cD_{L/K}^{-1}$ is a fractional ideal, i.e. there exists $0 \neq \alpha \in \cO_L$ such that $\alpha \cD_{L/K}^{-1} \subseteq \cO_L$.
\end{lemma}
\begin{proof}
    Let $x_1, \ldots, x_n$ be a basis for $L$ as a $K$-vector space. Set $d = \Delta(x_1, \ldots, x_n) \in \cO_K$. For $x \in \cD_{L/K}^{-1}$, write $x = \sum_{j=1}^n \lambda_j x_j$, where $\lambda_j \in K$. Then $\Tr_{L/K}(x x_i) = \sum_{j=1}^n \lambda_j \Tr_{L/K}(x_i x_j)$. Set $a_{ij} = \Tr_{L/K}(x_i x_j)$, $A = (a_{ij})$. Then
    \begin{equation*}
        A
        \begin{pmatrix} \lambda_1 \\ \vdots \\ \lambda_n \end{pmatrix}
        =
        \begin{pmatrix} \Tr_{L/K}(x x_1) \\ \vdots \\ \Tr_{L/K}(x x_1) \end{pmatrix}
    \end{equation*}
    Multiplying both sides by $\Adj(A) \in M_n(\cO_K)$, we get
    \begin{equation*}
        d
        \begin{pmatrix} \lambda_1 \\ \vdots \\ \lambda_n \end{pmatrix}
        = \Adj(A)
        \begin{pmatrix} \Tr_{L/K}(x x_1) \\ \vdots \\ \Tr_{L/K}(x x_1) \end{pmatrix}
    \end{equation*}
    Thus $\lambda_i \in \frac{1}{d} \cO_K$, so $x \in \frac{1}{d} \cO_L$. This shows that $d \cD_{L/K}^{-1} \subseteq \cO_L$.
\end{proof}

The inverse $\cD_{L/K} \subseteq \cO_L$ of $\cD_{L/K}^{-1}$ is called the \emph{different ideal}.

Let $I_L, I_K$ denote the groups of fractional ideals in $L$ and $K$ respectively. \autoref{thm:9_7} implies that $\cO_K$ is a free abelian group generated by non-zero primes ideals $\fp \subseteq \cO_K$, and similarly for $I_L$.

Define a group homomorphism $N_{L/K} : I_L \to I_K$ by $\cP \mapsto \fp^f$, where $\fp = \cP \cap \cO_K$, $f = f_{\cP / \fp}$. We have natural group homomorphisms $K^\times \to I_K$ and $L^\times \to I_L$ sending a unit to the principal fractional ideal that it generates.

\begin{remark}
    Consider the extension $K / \QQ$. For an ideal $I \subseteq \cO_K$ $N_{K / \QQ}(I) = [\cO_K : I]$.
\end{remark}

\begin{fact} The diagram
    \begin{equation*}
    \begin{tikzcd}
        L^\times \arrow[d, "N_{L/K}"'] \arrow[r] & I_L \arrow[d, "N_{L/K}"]\\
        K^\times \arrow[r] & I_K
    \end{tikzcd}
    \end{equation*}
    commutes. This follows from $v_\fp(N_{L_\cP/K_\fp}(x)) = f_{\cP / \fp} v_\cP(x)$, where $v_\cP$ and $v_\fp$ are normalised valuations on $L_\cP$ and $K_\fp$ respectively.
\end{fact}

\begin{theorem}\label{thm:12_7}
    $N_{L/K}(\cD_{L/K}) = d_{L/K}$.
\end{theorem}
\begin{proof}[Proof sketch]
    First assume that $\cO_K$ and $\cO_L$ are PIDs. Let $x_1, \ldots, x_n$ be an $\cO_K$ basis of $\cO_L$ and $y_1, \ldots, y_n$ the dual basis of the trace form. Then $y_1, \ldots, y_n$ forms an $\cO_K$-basis of $\cD_{L/K}^{-1}$. Let $\sigma_1, \ldots, \sigma_n : L \to \overline{K}$ be distinct embeddings of $L/K$. Then
    \begin{equation*}
        \sum_{i=1}^n \sigma_i(x_j) \sigma_i(y_k) = \Tr_{L/K}(x_j y_k) = \delta_{j k}
    \end{equation*}
    Since $\Delta(x_1, \ldots, x_n) = \det(\sigma_i(x_j))^2$, we have $\Delta(x_1, \ldots, x_n) \Delta(y_1, \ldots, y_n) = 1$. Write\footnote{Since $\cO_L$ is a PID, all fractional ideals are principal} $\cD_{L/K}^{-1} = \beta \cO_L$ for some $\beta \in L$. Then
    \begin{align}
        d_{L/K}^{-1}
        &= \langle \Delta(x_1, \ldots, x_n) \rangle^{-1} \notag\\
        &= \langle \Delta(y_1, \ldots, y_n) \rangle \notag\\
        &= \langle \Delta(\beta x_1, \ldots, \beta x_n) \rangle \label{eq:1}\\
        &= \langle N_{L/K}(\beta)^2 \Delta(x_1, \ldots, x_n) \rangle \label{eq:2}\\
        &= N_{L/K}(\beta)^2 d_{L/K}\notag
    \end{align}
    where \eqref{eq:1} follows since $y_1, \ldots, y_n$ and $\beta x_1, \ldots, \beta x_n$ are both $\cO_K$-bases of $\cD_{L/K}^{-1}$, and the change of basis matrix is invertible, while \eqref{eq:2} follows since the change of basis matrix is $\mult(\beta)$.

    Thus $d_{L/K}^{-1} = \langle N_{L/K}(\beta) \rangle = N_{L/K}(\cD_{L/K}^{-1})$, where the second equality follows from the commutativity of the diagram above.

    In the general case, localize at $S = \cO_K \setminus \fp$, and use $S^{-1} \cD_{L/K} = \cD_{S^{-1} \cO_L / S^{-1} \cO_K}$, $S^{-1} d_{L/K} = d_{S^{-1} \cO_L / S^{-1} \cO_K}$. We omit the details.
\end{proof}

\begin{theorem}\label{thm:12_8}
    If $\cO_L = \cO_K[\alpha]$ and $\alpha$ has (monic) minimal polynomial $g(X) \in \cO_K[X]$, then $\cD_{L/K} = \langle g'(\alpha) \rangle$.
\end{theorem}
\begin{proof}
    Let $\alpha = \alpha_1, \ldots, \alpha_n$ be the (distinct) roots of $g$. Write $\frac{g(X)}{X-\alpha} = \beta_{n-1}X^{n-1} + \beta_{n-2} X^{n-2} + \ldots + \beta_0$, where $\beta_i \in \cO_L$, and $\beta_{n-1} = 1$. We claim\footnote{one can obtain this identity by considering Lagrange interpolation of $X^r$ through $\alpha_1, \ldots, \alpha_n$} that
    \begin{equation*}
        \sum_{i=1}^n \frac{g(X)}{X - \alpha_i} \frac{\alpha_i^r}{g'(\alpha_i)} = X^r
    \end{equation*}
    for any $0 \le r \le n-1$. Indeed, the difference is a polynomial of degree $< n$ which vanishes at $X = \alpha_1, \ldots, \alpha_n$. Let $\sigma_1, \ldots, \sigma_n : L \to \overline{K}$ be the distinct embeddings of $L/K$. Then
    \begin{equation*}
        \sum_{i=1}^n \sigma_i\left(\frac{g(X)}{X - \alpha} \frac{\alpha^r}{g'(\alpha)}\right) = X^r
    \end{equation*}
    Equating coefficients of $X^s$, we get
    \begin{equation*}
        \Tr_{L/K}\left(\alpha^r \frac{\beta_s}{g'(\alpha)}\right) = \delta_{rs}
    \end{equation*}
    Since $\cO_L$ has $\cO_K$-basis $1, \alpha, \ldots, \alpha^{n-1}$, $\cD_{L/K}^{-1}$ has $\cO_K$-basis $\frac{\beta_0}{g'(\alpha)}, \frac{\beta_1}{g'(\alpha)}, \ldots, \frac{\beta_{n-1}}{g'(\alpha)} = \frac{1}{g'(\alpha)}$. Thus $\cD_{L/K}^{-1} = \langle \frac{1}{g'(\alpha)} \rangle$ as fractional ideals, so $\cD_{L/K} = \langle g'(\alpha) \rangle$, as required.
\end{proof}

Let $\cP$ be a non-zero prime of $\cO_L$, and $\fp = \cP \cap \cO_K$. We can define the different $\cD_{L_\cP / K_\fp} \subseteq \cO_{L_\cP}$ as before. We identify $\cD_{L_\cP / K_\fp}$ with a power of $\cP$.

\begin{theorem}\label{thm:12_9}
    $\cD_{L/K} = \prod_{\cP \mid \fp} \cD_{L_\cP / K_\fp}$.
\end{theorem}
\begin{proof}
    For $x \in L$ and $\fp$ a non-zero prime in $\cO_K$, we have (c.f. \autoref{cor:10_10})
    \begin{equation}\label{eq:3}
        \Tr_{L/K}(x) = \sum_{\cP \mid \fp} \Tr_{L_\cP / K_\fp}(x)
    \end{equation}
    We show that $\cD_{L/K}^{-1} = \prod_{\cP \mid \fp} \cD_{L_\cP / K_\fp}^{-1}$. Fix a non-zero prime $\cP$ in $\cO_L$ and let $\fp = \cP \cap \cO_K$.

    \noindent ($\subseteq$) Fix $\cP \mid \fp$. It suffices to show that $\cD_{L/K}^{-1} \subseteq \cD_{L_\cP / K_\fp}^{-1}$. Let $x \in \cD_{L/K}^{-1}$, $y \in \cO_{L_\cP}$. We need to show that $\Tr_{L_\cP / K_\fp}(xy) \in \cO_{K_\fp}$. For $\cP' \mid \fp$, the map $L \to K_\fp$ given by $z \mapsto \Tr_{L_{\cP'} / K_\fp}(x z)$ is continuous. By Weak Approximation (see Example Sheet 1), for any $\varepsilon > 0$, there is an $\eta \in L$ such that $\abs{\eta - y}_\cP < \varepsilon$ and $\abs{\eta}_{\cP'} < \varepsilon$ for $\cP' \neq \cP$. By \eqref{eq:3}, we have
    \begin{equation*}
        \Tr_{L_\cP / K_\fp}(xy) = \left(\Tr_{L_\cP / K_\fp}(xy) - \Tr_{L_\cP / K_\fp}(x \eta)\right) + \underbrace{\Tr_{L/K}(x \eta)}_{\in \cO_K} - \sum_{\substack{\cP' \mid \fp\\\cP' \neq \cP}} \Tr_{L_{\cP'} / K_\fp}(x \eta)
    \end{equation*}
    By choosing $\varepsilon$ sufficiently small, we may ensure that the bracketed terms and summands are in $\cO_{K_\fp}$. Thus $\Tr_{L_\cP / K_\fp}(xy) \in \cO_{K_\fp}$ as required.

    \noindent ($\supseteq$) Let $x \in \prod_{\cP \mid \fp} \cD_{L_\cP / K_\fp}^{-1}$. For fixed $\cP \mid \fp$, we have $x \in \cD_{L_\cP / K_\fp}^{-1}$, so that for all $y \in \cO_L \subseteq \cO_{L_\cP}$, $\Tr_{L_\cP / K_\fp}(xy) \in \cO_{K_\fp}$. Allowing $\cP$ to vary, \eqref{eq:3} shows that for any $y \in \cO_L$, $\Tr_{L/K}(xy) \in \cO_{K_\fp}$. Allowing $\fp$ to vary, we see that for any $y \in \cO_L$, $Tr_{L/K}(xy) \in \bigcap_\fp \cO_{K_\fp} = \cO_K$. Thus $x \in \cD_{L/K}^{-1}$.
\end{proof}

\begin{corollary}\label{cor:12_10}
    $d_{L/K} = \prod_{\cP \mid \fp} d_{L_\cP / K_\fp}$.
\end{corollary}
\begin{proof}
    Apply $N_{L/K}$ to both sides of \autoref{thm:12_9} and use \autoref{thm:12_7}. Note that $N_{L/K}(\cD_{L_\cP / K_\fp}) = N_{L_\cP / K_\fp}(\cD_{L_\cP / K_\fp})$, since the residue class degree does not change under completion by the lemma following \autoref{prop:11_8}.
\end{proof}

\subsection{Unramified and Totally Ramified Extensions of Local Fields}

Let $L/K$ be a finite separable extension of non-archimedean local fields.
Recall from \autoref{cor:11_6} that $[L : K] = e_{L/K} f_{L/K}$.

\begin{lemma}\label{lem:13_1}
    Let $M/L/K$ be finite separable extensions of local fields. Then
    \begin{enumerate}
        \item $f_{M/K} = f_{M/L} f_{L/K}$,
        \item $e_{M/K} = e_{M/L} e_{L/K}$.
    \end{enumerate}
\end{lemma}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item $f_{M/K} = [k_M : k] = [k_M : k_L] [k_L : k] = f_{M/K} f_{L/K}$.
        \item Follows from (i) and \autoref{cor:11_6}. \qedhere
    \end{enumerate}
\end{proof}

\begin{definition}
    The extension $L/K$ is said to be
    \begin{enumerate}
        \item \emph{unramified} if $e_{L/K} = 1$, or equivalently $f_{L/K} = [L : K]$,
        \item \emph{ramified} if $e_{L/K} > 1$, or equivalently $f_{L/K} < [L : K]$,
        \item \emph{totally ramified} if $e_{L/K} = [L : K]$, or equivalently $f_{L/K} = 1$.
    \end{enumerate}
\end{definition}

\begin{remark}
    \autoref{lem:13_1} immediately implies that for finite separable extensions of local fields $M/L/K$,
    \begin{enumerate}
        \item $M/K$ is unramified iff $M/L$ and $L/K$ are unramified,
        \item $M/K$ is totally ramified iff $M/L$ and $L/K$ are totally ramified.
    \end{enumerate}
\end{remark}

\begin{theorem}\label{thm:13_3}
    There exists a field $K_0$ such that $K \subseteq K_0 \subseteq L$ such that
    \begin{enumerate}
        \item $K_0/K$ is unramified,
        \item $L/K_0$ is totally ramified.
    \end{enumerate}
    Moreover, $[K_0 : K] = f_{L/K}$, $[L : K_0] = e_{L/K}$, and $K_0 / K$ is Galois.
\end{theorem}
\begin{proof}
    Let $f = f_{L/K}$ and $k = \FF_q$, so that $k_L = \FF_{q^f}$. Set $m = q^f - 1$, and let $[\cdot] : \FF_{q^f} \to L$ denote the Teichm\"uller lift for $L$. Let $\zeta_m = [\alpha]$ for some generator $\alpha$ of $\FF_{q^f}^\times$. Then $\zeta_m$ is a primitive $m$\textsuperscript{th} root of unity. Set $K_0 = K(\zeta_m)$, then $K_0 / K$ is Galois, since it is the splitting field of $X^m - 1$. $K_0$ has residue field $k_0 = \FF_q(\alpha) = \FF_{q^f} = k_L$. Let $\res : \Gal(K_0 / K) \to \Gal(k_0 / k)$ be the natural map\footnote{the map is well-defined, since for $\sigma \in \Gal(L/K)$, $\sigma(\cO_L) \subseteq \cO_L$ and $\sigma(\fm_L) \subseteq \fm_L$ by \autoref{lem:8_2}. Thus $\sigma : L \to L$ induces a map $k_L \to k_L$, which clearly also fixes $k$}. For $\sigma \in \Gal(K_0 / K)$, if $\sigma(\zeta_m) \equiv \zeta_m \pmod{\fm_0}$, then $\sigma(\zeta_m) = \zeta_m$, as $\cO_{K_0}^\times \to k_0^\times$ induces a bijection between $m$\textsuperscript{th} roots of unity by Hensel's lemma. Hence $\res$ is injective. Thus
    \begin{equation*}
        [K_0 : K] = \abs{\Gal(K_0 / K)} \le \abs{\Gal(k_0 / k)} = f_{K_0 / K}
    \end{equation*}
    We see that the inequality is actually an equality, so $\res$ is an isomorphism, and $K_0 / K$ is unramified.

    Since $k_0 = k_L$, we have $f_{L/K} = f_{K_0/K} = [K_0 : K]$. Since $f_{L/K_0} = 1$, $L / K_0$ is totally ramified, and $e_{L/K} = [L : K_0]$ by the tower law.
\end{proof}

\begin{theorem}\label{thm:13_4}
    For each $n \ge 1$, there is a unique unramified extension of $L/K$ of degree $n$. Moreover $L/K$ is Galois and the natural map $\Gal(L/K) \to \Gal(k_L / k)$ is an isomorphism. In particular, $\Gal(L/K) = \langle \Frob_{L/K} \rangle$ is cyclic, where $\Frob_{L/K}(x) \equiv x^q \pmod{\fm_L}$ for all $x \in \cO_L$.
\end{theorem}
\begin{proof}
    Fix $n \ge 1$. Let $q = \abs{k}$ and $m = q^n - 1$.

    For existence, set $L = K(\zeta_m)$, where $\zeta_m$ is a primitive $m$\textsuperscript{th} root of unity. As in \autoref{thm:13_3}, $\res : \Gal(L/K) \to \Gal(k_L/k)$ is an isomorphism. Thus $[L : K] = f_{L/K}$, i.e. $L/K$ is unramified. Since $\Gal(k_L/k) \cong \Gal(\FF_{q^n}/\FF_q)$ is cyclic generated by the Frobenius $x \mapsto q^n$, $\Gal(L/K)$ is generated by its lift.

    For uniqueness, let $L/K$ be an unramified extension of degree $n$. Then $\abs{k_L} = q^n$. Taking the Teichm\"uller lift of a generator of $k_L^\times$ gives a primitive $m$\textsuperscript{th} root of unity $\zeta_m \in L$. Since $[K(\zeta_m) : K] = n$ by the existence part above, we have $L = K(\zeta_m)$.
\end{proof}

\begin{corollary}\label{cor:13_5}
    Let $L/K$ be a finite Galois extension. Then the map $\res : \Gal(L/K) \to \Gal(k_L / k)$ is surjective.
\end{corollary}
\begin{proof}
    Let $K_0$ be the maximal unramified subextension as in \autoref{thm:13_3}. Since $k_L = k_0$, we have $\Gal(L/K_0) \subseteq \ker(\res)$. Thus $\res$ factors through the quotient $\Gal(L/K) / \Gal(L / K_0) \cong \Gal(K_0 / K)$ as
    \begin{equation*}
        \Gal(L / K) \twoheadrightarrow \Gal(K_0 / K) \xrightarrow{\sim} \Gal(k_L / k)
    \end{equation*}
    The second map is an isomorphism by \autoref{thm:13_4}.
\end{proof}

\begin{definition}
    Let $L/K$ be a finite Galois extension. The \emph{inertia subgroup} is
    \begin{equation*}
        I_{L/K} = \ker(\res : \Gal(L/K) \to \Gal(k_L / k)) \subseteq \Gal(L/K)
    \end{equation*}
\end{definition}

\begin{remark}\phantom{}
    \begin{enumerate}
        \item Since $e_{L/K} f_{L/K} = [L:K]$, we have $\abs{I_{L/K}} = e_{L/K}$.
        \item From the proof of \autoref{cor:13_5}, we see that $I_{L/K} = \Gal(L/K_0)$.
    \end{enumerate}
\end{remark}

\begin{definition}
    A monic polynomial $f(X) = X^n + a_{n-1} X^{n-1} + \ldots + a_0 \in \cO_K[X]$ is \emph{Eisenstein} if $v_K(a_i) \ge 1$ for all $i$, and $v(a_0) = 1$.
\end{definition}

Eisenstein's criterion implies that if $f(X)$ is Eisenstein, then $f(X)$ is irreducible.

\begin{theorem}\label{thm:13_8}\phantom{}
    \begin{enumerate}
        \item Let $L/K$ be finite, totally ramified, with uniformiser $\pi_L \in \cO_L$. Then the minimal polynomial of $\pi_L$ is Eisenstein, and $\cO_L = \cO_K[\pi_L]$.
        \item Conversely, if $f(X) \in \cO_K[X]$ is Eisenstein and $\alpha$ is a root of $f$, then $L = K(\alpha) / K$ is totally ramified, and $\alpha$ is a uniformiser in $L$.
    \end{enumerate}
\end{theorem}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item By assumption, $[L : K] = e$. Let $f(X) = X^m + a_{m-1} X^{m-1} + \ldots + a_0 \in \cO_K[X]$ be the minimal polynomial of $\pi_L$. Then $m \le e$. Since $v_L(K^\times) = e \ZZ$, we have $v_L(a_i \pi_L^i) \equiv i \pmod{e}$ for $i < m$. Hence the terms have distinct valuations. As $\pi_L^m = -\sum_{i=0}^{m-1} a_i \pi_L^i$, $m = v_L(m) = \min_{0 \le i \le m-1} v_L(a_i \pi_L^i) = \min_{0 \le i \le m-1} (i + e v_K(a_i))$. Thus $v_K(a_i) \ge 1$ for all $i$. Hence $v_k(a_0) = 1$ and $m = e$. Thus $f(X)$ is Eisenstein and $L = K(\pi_L)$.

            Now we show that $\cO_L = \cO_K[\pi_L]$. For $y \in L$, write $y = \sum_{i=0}^{e-1} b_i \pi_L^i$, with $b_i \in K$. Then $v_L(y) = \min_{0 \le i \le e-1} (i + e v_K(b_i))$. Thus
            \begin{align*}
                y \in \cO_L
                &\iff v_L(y) \ge 0\\
                &\iff \forall 0 \le i \le e-1, e v_K(b_i) \ge 0\\
                &\iff y \in \cO_K[\pi_L]
            \end{align*}

        \item Let $f(X) = X^n + a_{n-1} X^{n-1} + \ldots + a_0 \in \cO_K[X]$ be an Eisenstein polynomial. Let $\alpha$ be a root of $f$, $L = K(a)$, and $e = e_{L/K}$. Then $v_L(a_i) \ge e$, and $v_L(a_0) = e$. If $v_L \le 0$, then $v_L(\alpha^n) < v_L(\sum_{i=1}^{n-1} a_i \alpha^i)$, contradiction. Thus $v_L(\alpha) > 0$. For $i \neq 0$, $v_L(a_i \alpha^i) > e = v_L(a_0)$. Therefore, $n v_L(\alpha) = v_L(\alpha^n) = v_L(-\sum_{i=0}^{n-1} a_i \alpha_i) = e$. Since $n = [L : K] \ge e$, we have $n = e$ and $v_L(\alpha) = 1$.\qedhere
    \end{enumerate}
\end{proof}

\subsection*{Structure of Units}

Let $K / \QQ_p$ be a finite extension, $e = e_{K/\QQ_p}$, and $\pi \in \cO_K$ a uniformiser.

\begin{proposition}\label{prop:13_9}
    If $r > \frac{e}{p-1}$, then $\exp(x) = \sum_{n=0}^\infty \frac{x^n}{n!}$ converges on $\pi^r \cO_K$ and induces an isomorphism
    \begin{equation*}
        (\pi^r \cO_K, +) \cong (1 + \pi^r \cO_K, \times)
    \end{equation*}
\end{proposition}
\begin{proof}
    Fix $x \in \pi^r \cO_K$. From Example Sheet 1, we have
    \begin{equation*}
        v_K(n!) = e v_p(n!) = e \frac{n - s_p(n)}{n-1} \le e \frac{n-1}{p-1}
    \end{equation*}
    where $s_p(n)$ is the sum of $p$-adic digits of $n$. Fix $n \ge 1$, then
    \begin{equation*}
        v_K\left(\frac{x^n}{n!}\right) \ge nr - e \frac{n-1}{p-1} = r + (n-1)\left(r - \frac{e}{p-1}\right)
    \end{equation*}
    Thus $v_K\left(\frac{x^n}{n!}\right) \to \infty$ as $n \to \infty$. This shows that $\exp(x)$ converges. Since $v_K\left(\frac{x^n}{n!}\right) \ge r$ for $n \ge 1$, we have $\exp(x) \in 1 + \pi^r \cO_K$.

    Similarly, consider $\log : 1 + \pi^r \cO_K \to \pi^r \cO_K$, defined by $\log(1 + x) = \sum_{n=1}^\infty \frac{(-1)^{n-1}}{n} x^n$ for $x \in \pi^r \cO_K$. Since $v_K\left(\frac{(-1)^{n-1}}{n} x^n\right) \ge v_K\left(\frac{x^n}{n!}\right)$, $\log$ converges by the above, and has the stated codomain.

    Recall the identities of formal power series in $\QQ \llbracket X, Y \rrbracket$:
    \begin{gather*}
        \exp(X + Y) = \exp(X) \exp(Y)\\
        \exp(\log(1+X)) = 1 + X\\
        \log(\exp(X)) = X
    \end{gather*}
    This shows that $\exp : (\pi^r \cO_K, +) \to (1 + \pi^r \cO_K, \times)$ is an isomorphism.
\end{proof}

\noindent For a local field $K$, set $U_K = \cO_K^\times$ and let $\pi \in \cO_K$ be a uniformiser.

\begin{definition}
    For $s \in \ZZ_{\ge 1}$, the \emph{$s$\textsuperscript{th} unit group} $U_K^{(s)}$ is defined by $U_K^{(s)} = (1 + \pi^s \cO_K, \times)$. Set $U_K^{(0)} = U_K$. Then we have the inclusions $\ldots \subseteq U_K^{(s)} \subseteq U_K^{(s-1)} \subseteq \ldots \subseteq U_K^{(0)} = U_K$.
\end{definition}

\begin{proposition}\label{prop:13_11}\phantom{}
    \begin{enumerate}
        \item $U_K^{(0)} / U_K^{(1)} \cong (k^\times, \times)$,
        \item $U_K^{(s)} / U_K^{(s+1)} \cong (k, +)$ for $s \ge 1$.
    \end{enumerate}
\end{proposition}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item The reduction modulo $\pi$ map $\cO_K^\times \to k^\times$ is surjective with kernel $1 + \pi \cO_K = U_K^{(1)}$.

        \item Suppose $s \ge 1$. Define $f : U_K^{(s)} \to k$ by
            \begin{equation*}
                f(1 + \pi^s x) = x \pmod{\pi}
            \end{equation*}
            For $x, y \in \cO_K$, we have $(1 + \pi^s x)(1 + \pi^s y) = 1 + \pi^s (x + y + \pi^s x y)$, and $x + y + \pi^s x y \equiv x + y \pmod{\pi}$. Thus $f$ is a group homomorphism. It is surjective, with kernel $U_K^{(s+1)}$. \qedhere
    \end{enumerate}
\end{proof}

\begin{corollary}\label{cor:13_12}
    Let $K/\QQ_p$ be a finite extension. Then there is a finite index subgroup of $\cO_K^\times$ isomorphic to $(\cO_K, +)$.
\end{corollary}
\begin{proof}
    Pick $r > \frac{e}{p-1}$. Then $U_K^{(r)} \cong (\cO_K, +)$ by \autoref{prop:13_9}. $U_K^{(r)}$ has finite index in $U_K$ by \autoref{prop:13_11}.
\end{proof}

\begin{remark}
    The above arguments do not hold if $K$ is a local field of equal characteristic, since in that case $\exp$ is not defined.
\end{remark}

\begin{example}
    Consider the group of units of $\ZZ_p$. Take $K = \QQ_p$, so $e = 1$.

    If $p > 2$, then we can take $r = 1$.
    We have an isomorphism $\ZZ_p^\times \cong (\ZZ / p \ZZ)^\times \times (1 + p \ZZ_p) \cong \ZZ / (p-1) \ZZ \times \ZZ_p$, where the first isomorphism is $x \mapsto (x \pmod{p}, \frac{x}{[x \pmod{p}]})$, where $[\cdot] : \FF_p \to \ZZ_p$ is the Teichm\"uller lift.

    If $p = 2$, then we can take $r = 2$. We have an isomorphism $\ZZ_2^\times \cong (\ZZ / 4 \ZZ)^\times \times (1 + 4 \ZZ_2) \cong \ZZ / 2 \ZZ \times \ZZ_2$, where the first isomorphism is $x \mapsto (x \pmod{4}, \frac{x}{\varepsilon(x)})$, and $\varepsilon$ is defined by
    \begin{equation*}
        \varepsilon(x) = \begin{cases}
            1 & \text{if } x \equiv 1 \pmod{4}\\
            -1 & \text{if } x \equiv -1 \pmod{4}
        \end{cases}
    \end{equation*}
    From this we can obtain another proof that
    \begin{equation*}
        \ZZ_p^\times / (\ZZ_p^\times)^2 \cong
        \begin{cases}
            \ZZ / 2 \ZZ & \text{if } p > 2\\
            (\ZZ / 2 \ZZ)^2 & \text{if } p = 2
        \end{cases}
    \end{equation*}
\end{example}

\subsection{Higher Ramification Groups}

Unless otherwise specified, let $L / K$ be a finite Galois extension of local fields. Let $v_L$ the normalised valuation on $L$, and $\pi_L \in \cO_L$ a uniformiser.

\begin{definition}
    For $s \in \RR_{\ge -1}$, the $s$\textsuperscript{th} ramification group is
    \begin{equation*}
        G_s(L / K) = \{\sigma \in \Gal(L/K) \mid \forall x \in \cO_L, v_L(\sigma(x) - x) \ge s + 1\}
    \end{equation*}
\end{definition}
In particular,
\begin{align*}
    G_{-1}(L/K) &= \Gal(L/K)\\
    G_0(L/K)
    &= \{\sigma \in \Gal(L/K) \mid \forall x \in \cO_L, \sigma(x) \equiv x \pmod{\pi_L}\}\\
    &= \ker(\Gal(L/K) \to \Gal(k_L/k))\\
    &= I_{L/K}
\end{align*}
When the extension is clear, we will simply write $G_s$ for $G_s(L/K)$.

\begin{remark}\phantom{}
    \begin{enumerate}
        \item For $s \in \ZZ_{\ge 0}$, $G_s = \ker(\Gal(L/K) \to \Aut(\cO_L / \pi_L^{s+1} \cO_L))$. Thus $G_s$ is a normal subgroup of $\Gal(L/K)$.
        \item We have a filtration $\Gal(L/K) = G_{-1} \supseteq G_0 \supseteq \ldots \supseteq G_{s-1} \supseteq G_s \supseteq \ldots$.
        \item $G_s$ only changes at the integers.
        \item $G_s$ for $s \in \RR_{\ge -1}$ is used to define upper numbering.
    \end{enumerate}
\end{remark}

\begin{theorem}\label{thm:14_2}\phantom{}
    \begin{enumerate}
        \item For $s \ge 0$, $G_s = \{\sigma \in G_0 \mid v_L(\sigma(\pi_L) - \pi_L) \ge s+1\}$.
        \item $\bigcap_{s=0}^\infty G_s = \{1\}$.
        \item Let $s \in \ZZ_{\ge 0}$. Then there exists an injective group homomorphism $G_s / G_{s+1} \hookrightarrow U_L^{(s)} / U_L^{(s+1)}$ induced by $\sigma \mapsto \frac{\sigma(\pi_L)}{\pi_L}$. This map is independent of the choice of $\pi_L$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    Let $K_0$ be the maximal unramified subextension of $K$ in $L$. Note that for $s \ge 0$, $G_0(L/K) = \Gal(L/K_0)$ (c.f. \autoref{cor:13_5}). Thus $G_s(L/K_0) = G_s(L/K) \cap \Gal(L/K_0) = G_s(L/K)$. Upon replacing $K$ by $K_0$, we may assume that $L / K$ is totally ramified.

    \begin{enumerate}
        \item \autoref{thm:13_8} implies that $\cO_L = \cO_K[\pi_L]$. Suppose that $v_L(\sigma(\pi_L) - \pi_L) \ge s+1$. Let $x \in \cO_L$, so $x = f(\pi_L)$ for some $f(X) \in \cO_K[X]$.
            \begin{align*}
                \sigma(x) - x
                &= \sigma(f(\pi_L)) - f(\pi_L)\\
                &= f(\sigma(\pi_L)) - f(\pi_L)\\
                &= (\sigma(\pi_L) - \pi_L) g(\pi_L)
            \end{align*}
            for some $g(X) \in \cO_K[X]$. Thus $v_L(\sigma(x) - x) = v_L(\sigma(\pi_L) - \pi_L) + v_L(g(\pi_L)) \ge s + 1$. Thus $\sigma \in G_s$ as required.

        \item Suppose that $\sigma \in \bigcap_{s=0}^\infty G_s$. Then for all $x \in \cO_L$, $v_L(\sigma(x) - x) = \infty$, so $\sigma(x) = x$. Thus $\sigma = 1$.

        \item Fix $s \in \ZZ_{\ge 0}$. For $\sigma \in G_s$, $\sigma(\pi_L) \in \pi_L + \pi_L^{s+1} \cO_L$, so $\frac{\sigma(\pi_L)}{\pi_L} \in 1 + \pi_L^s \cO_L = U_L^{(s)}$. Define $\varphi : G_s \to U_L^{(s)} / U_L^{(s+1)}$ by $\varphi(\sigma) = \frac{\sigma(\pi_L)}{\pi_L}$. We claim that this is a group homomorphism with kernel $G_{s+1}$. Let $\sigma, \tau \in G_s$. Write $\tau(\pi_L) = u \pi_L$ for some $u \in \cO_L^\times$. Then
            \begin{equation*}
                \frac{\sigma\tau(\pi_L)}{\pi_L} = \frac{\sigma\tau(\pi_L)}{\tau(\pi_L)} \frac{\tau(\pi_L)}{\pi_L} = \frac{\sigma(u)}{u} \frac{\sigma(\pi_L)}{\pi_L} \frac{\tau(\pi_L)}{\pi_L}
            \end{equation*}
            but $\sigma(u) \in u + \pi_L^{s+1} \cO_L$, so $\frac{\sigma(u)}{u} \in 1 + \pi_L^{s+1} \cO_L = U_L^{(s+1)}$. Thus
            \begin{equation*}
                \frac{\sigma\tau(\pi_L)}{\pi_L} \equiv \frac{\sigma(\pi_L)}{\pi_L} \frac{\tau(\pi_L)}{\pi_L} \pmod{U_L^{(s+1)}}
            \end{equation*}
            Thus $\varphi$ is a group homomorphism. Moreover, $\ker(\varphi) = \{\sigma \in G_s \mid \sigma(\pi_L) \equiv \pi_L \pmod{\pi_L^{s+2}}\} = G_{s+1}$ by (i).

            For independence on the choice of uniformiser, let $\pi_L' = u \pi_L$ be another uniformiser, where $u \in \cO_L^\times$. Then
            \begin{equation*}
                \frac{\sigma(\pi_L')}{\pi_L'} = \frac{\sigma(u)}{u} \frac{\sigma(\pi_L)}{\pi_L} \equiv \frac{\sigma(\pi_L)}{\pi_L} \pmod{U_L^{(s+1)}}
                \qedhere
            \end{equation*}
    \end{enumerate}
\end{proof}

\begin{corollary}\label{cor:14_3}
    $\Gal(L/K)$ is solvable.
\end{corollary}
\begin{proof}
    For $s \in \ZZ_{\ge 1}$, $G_s / G_{s+1}$ is isomorphic to a subgroup of
    \begin{equation*}
        \begin{cases}
            \Gal(k_L/k) & \text{if } s = -1\\
            (k_L^\times, \times) & \text{if } s = 0\\
            (k_L, +) & \text{if } s \ge 1
        \end{cases}
    \end{equation*}
    by \autoref{cor:13_5}, \autoref{prop:13_11}, and \autoref{thm:14_2}. Thus $G_s / G_{s+1}$ is solvable. The filtration is finite by \autoref{thm:14_2} (ii), so we are done.
\end{proof}

Let $p = \Char{k}$, then $\abs{G_0 / G_1}$ is coprime to $p$, and $\abs{G_1} = p^n$ by the above proof. Thus $G_1$ is the unique Sylow $p$-subgroup of $G_0 = I_{L/K}$, uniqueness follows since $G_1$ is normal in $G_0$.

\begin{definition}
    The group $G_1$ is called the \emph{wild inertia group}, and $G_0 / G_1$ the tame quotient.

    Let $L/K$ be a finite separable extension of local fields. Say $L/K$ is \emph{tamely ramified} if $p \nmid e_{L/K}$, where $p = \Char k$. Otherwise it is \emph{wildly ramified}.
\end{definition}

\begin{remark}
    If $L/K$ is Galois, then $L/K$ is tamely ramified iff $G_1 = \{1\}$. This is because $e_{L/K} = \abs{I_{L/K}} = \abs{G_0}$, and $p \mid \abs{G_0}$ iff $\abs{G_1} > 1$.
\end{remark}

\begin{theorem}\label{thm:14_5}
    Let $L/K/\QQ_p$ be finite extensions of local fields. Suppose $\cD_{L/K} = (\pi_L)^{\delta(L/K)}$. Then $\delta(L/K) \ge e_{L/K} - 1$ with equality iff $L/K$ is tamely ramified. In particular, $L/K$ is unramified iff $\cD_{L/K} = \cO_L$.
\end{theorem}
\begin{proof}
    It suffices to prove the claim for when $L/K$ is unramified or totally ramified. Suppose we have done so. Let $K_0$ be the maximal unramified subextension of $L/K$. An exercise on Example Sheet 3 implies that $\cD_{L/K} = \cD_{L/K_0} \cD_{K_0/K}$. Then $e_{L/K_0} = e_{L/K}$, and $\cD_{L/K} = \cD_{L / K_0}$ implies $\delta(L/K) = \delta(L/K_0)$. Note that $L/K_0$ is tamely ramified iff $L/K$ is tamely ramified. Thus the general result follows.

    Now we check the two cases:
    \begin{enumerate}
        \item $L/K$ unramified:
            \autoref{prop:6_12} implies that $\cO_L = \cO_K[\alpha]$ for some $\alpha \in \cO_L$. Then $k_L = k(\overline{\alpha})$. Let $g(X) \in \cO_K[X]$ be the minimal polynomial of $\alpha$. Then $[L : K] = [k_L : k]$ implies that $\overline{g}(X) \in k[X]$ is the minimal polynomial of $\overline{\alpha}$. Thus $\overline{g}(X)$ is separable and hence $g'(\alpha) \not\equiv 0 \pmod{\pi_L}$. By \autoref{thm:12_8}, $\cD_{L/K} = \langle g'(\alpha) \rangle = \cO_L$.

        \item $L/K$ is totally ramified:
            In this case $[L : K] = e$. By \autoref{thm:13_8}, $\cO_L = \cO_K[\pi_L]$, and the minimal polynomial $g(X) = X^e + \sum_{i=0}^{e-1} a_i X^i \in \cO_K[X]$ of $\pi_L$ is Eisenstein. Then
            \begin{equation*}
                g'(\pi_L) = \underbrace{e \pi_L^{e-1}}_{v_L(\cdot) \ge e - 1} + \underbrace{\sum_{i=1}^{e-1} i a_i \pi_L^{i-1}}_{v_L(\cdot) \ge e}
            \end{equation*}
            Thus $v_L(g'(\pi_L)) \ge e - 1$ with equality iff $e$ is a unit in $\cO_L$ iff $p \nmid e$. \qedhere
    \end{enumerate}
\end{proof}

\begin{corollary}\label{cor:14_6}
    Let $L/K$ be an extension of number fields. Suppose that $\cP \mid \fp$, where $\fp, \cP$ are primes of $K, L$ respectively. Then $e_{\cP / \fp} > 1$ iff $\cP \mid \cD_{L/K}$ (c.f. \autoref{cor:12_4}).
\end{corollary}
\begin{proof}
    Since $e_{\cP/\fp} = e_{L_\cP/K_\fp}$, we have
    \begin{alignat*}{3}
        e_{\cP/\fp} > 1
        &\iff L_\cP / K_\fp \text{ is ramified}\\
        &\iff \cP \mid \cD_{L_\cP / K_\fp} &\quad\text{(by \autoref{thm:14_5})}\\
        &\iff \cP \mid D_{L/K} &\quad\text{(by \autoref{thm:12_9})}
    \end{alignat*}
    as required.
\end{proof}

\begin{example}
    Let $K = \QQ_p$ and $L = \QQ_p(\zeta_{p^n})$, where $\zeta_{p^n}$ is a primitive $p^n$-th primitive root of unity. The \emph{$p^n$-th cyclotomic polynomial} is
    \begin{equation*}
        \Phi_{p^n}(X) = X^{p^{n-1}(p-1)} + X^{p^{n-1}(p-2)} + \ldots + 1 \in \ZZ_p[X]
    \end{equation*}
    An exercise on Example Sheet 3 shows that:
    \begin{itemize}
        \item $\Phi_{p^n}(X)$ is irreducible, hence $\Phi_{p^n}(X)$ is the minimal polynomial of $\zeta_{p^n}$;
        \item $L/\QQ_p$ is Galois, totally ramified, of degree $p^{n-1}(p-1)$;
        \item $\pi = \zeta_{p^n} - 1$ is a uniformiser of $\cO_L$, so that $\cO_L = \ZZ_p[\zeta_{p^n} - 1] = \ZZ_p[\zeta_{p^n}]$, by \autoref{thm:13_8}.
        \item $\Gal(L/\QQ_p) \cong (\ZZ / p^n \ZZ)^\times$, where $m \in (\ZZ / p^n \ZZ)^\times$ corresponds to $\sigma_m \in \Gal(L/\QQ_p)$ such that $\sigma_m(\zeta_{p^n}) = \zeta_{p^n}^m$.
    \end{itemize}
    We compute the higher ramification groups $G_s$: We have
    \begin{equation*}
        v_L(\sigma_m(\pi) - \pi) = v_L(\zeta_{p^n}^m - \zeta_{p^n}) = v_L(\zeta_{p^n}^{m-1} - 1)
    \end{equation*}
    Let $k = v_p(m-1)$, so that $\zeta_{p^n}^{m-1}$ is a primitive $p^{n-k}$-th root of unity, and hence (by the above facts) $\pi' = \zeta_{p^n}^{m-1} - 1$ is a uniformiser of $L' = \QQ_p(\zeta_{p^n}^{m-1})$. Continuing the calculation, we have
    \begin{equation*}
        v_L(\zeta_{p^n}^{m-1} - 1) = e_{L/L'} = \frac{e_{L/\QQ_p}}{e_{L'/\QQ_p}} = \frac{[L : \QQ_p]}{[L' : \QQ_p]} = \frac{p^{n-1}(p-1)}{p^{n-k-1}(p-1)} = p^k
    \end{equation*}
    Since $L/\QQ_p$ is totally ramified, $G_0 = \Gal(L/\QQ_p)$. \autoref{thm:14_2} implies that $\sigma_m \in G_s$ iff $p^k \ge s+1$. Thus
    \begin{equation*}
        G_s \cong
        \begin{cases}
            (\ZZ / p^n \ZZ)^\times & \text{if } s \le 0\\
            (1 + p^k\ZZ) / p^n \ZZ & \text{if } p^{k-1} - 1 < s \le p^k - 1 \text{ for } 1 \le k \le n-1\\
            \{1\} & \text{if } p^{n-1} - 1 < s
        \end{cases}
    \end{equation*}
\end{example}

\section{Local Class Field Theory}

\stepcounter{subsection} % Numbering issue

\subsection{Infinite Galois Theory}

Let $L/K$ be an algebraic extension of fields.

\begin{definition}\phantom{}
    \begin{enumerate}
        \item $L/K$ is \emph{separable} if for all $\alpha \in L$, its minimal polynomial $f_\alpha(X) \in K[X]$ is separable.
        \item $L/K$ is \emph{normal} if for all $\alpha \in L$, $f_\alpha(X)$ splits in $L$.
        \item $L/K$ is Galois if it is both separable and normal. In this case, we write $\Gal(L/K) = \Aut(L/K)$.
    \end{enumerate}
\end{definition}
If $L/K$ is finite, we have the Galois correspondence:
\begin{center}
\begin{tabular}{*{3}{>{$}c<{$}}}
    \{\text{subextensions } K \subseteq K' \subseteq L\} & \longleftrightarrow & \{\text{subgroups of } \Gal(L/K)\}\\
    K' & \longmapsto & \Gal(L/K')
\end{tabular}
\end{center}

Let $(I, \le)$ be a poset. We say $I$ is a directed set if for all $i, j \in I$, there exists a $k \in I$ such that $i \le k$ and $j \le k$.
\begin{example}\phantom{}
    \begin{itemize}
        \item Any total order (e.g $(\NN, \le)$));
        \item $N_{\ge 1}$ ordered by divisibility.
    \end{itemize}
\end{example}

\begin{definition}
    Let $(I, \le)$ be a directed set and $(G_i)_{i \in I}$ a collection of groups together with maps $\varphi_{ij} : G_j \to G_i$ whenever $i \le j$, such that
    \begin{gather*}
        \varphi_{ik} = \varphi_{ij} \circ \varphi_{jk} \text{ for } i \le j \le k\\
        \varphi_{ii} = \id
    \end{gather*}
    We call $((G_i)_{i \in I}, \varphi_{ij})$ an \emph{inverse system}. The \emph{inverse limit} of $((G_i)_{i \in I}, \varphi_{ij})$ is
    \begin{equation*}
        \varprojlim_{i \in I} G_i = \bigg\{(a_i)_i \in \prod_{i \in I} G_i \,\bigg\vert\, \forall i \le j, \varphi_{ij}(g_j) = g_i\bigg\}
    \end{equation*}
\end{definition}

\begin{remark}\phantom{}
    \begin{itemize}
        \item With the directed set $(\NN, \le)$, we recover the previous definition of inverse limit.
        \item There are projection maps $\psi_j : \varprojlim_{i \in I} G_i \to G_j$.
    \end{itemize}
\end{remark}

Assume that each $G_i$ is finite. The \emph{profinite topology} on $\varprojlim_{i \in I} G_i$ is the weakest topology such that $\psi_j$ is continuous for all $j \in I$, where $G_j$ is given the discrete topology.

\begin{proposition}\label{prop:16_3}
    Let $L/K$ be Galois, then
    \begin{enumerate}
        \item The set $I = \{K \subseteq F \subseteq L \mid F/K \text{ is finite Galois}\}$ is a directed set under $\subseteq$.
        \item For $F, F' \in I$ with $F \subseteq F'$, there is a restriction map $\res_{F,F'} : \Gal(F'/K) \to \Gal(F/K)$ and the natural map $\Gal(L/K) \to \varprojlim_{F \in I} \Gal(F/K)$ is an isomorphism.
    \end{enumerate}
\end{proposition}
\begin{proof}
    See Example Sheet 4.
\end{proof}

\end{document}
